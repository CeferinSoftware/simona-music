import{a2 as ae,q as u,r as P,x as be,B as te,z as Me,G as Te,ab as Ve,X as He,Y as Ze,K as U,u as G,$ as Ie,a3 as xt,ac as Ot,ad as jt,U as ct,h as Tt}from"./vue-BsfewpWM.js";import{g as Ye}from"./layout-CUzOT8aY.js";import{a as At}from"./leaflet-DkUWBo0d.js";import{r as Dt}from"./zxcvbn-Bgw4VUEj.js";function _t(e){return e?.constructor.name=="File"||e?.constructor.name=="FileList"}function De(e,t=!0){return e==null?!0:e instanceof Date?isNaN(e.getTime()):_t(e)?e.size<=0:Array.isArray(e)?t?e.length===0:!1:typeof e=="object"&&e!=null?Object.keys(e).length===0:!String(e).length}const Nt=Symbol("regle-rule");function Ct(e){if(typeof e.source.flags=="string")return e.source.flags;{let t=[];return e.global&&t.push("g"),e.ignoreCase&&t.push("i"),e.multiline&&t.push("m"),e.sticky&&t.push("y"),e.unicode&&t.push("u"),t.join("")}}function W(e){let t=e,a={}.toString.call(e).slice(8,-1);if(a=="Set"&&(t=new Set([...e].map(r=>W(r)))),a=="Map"&&(t=new Map([...e].map(r=>[W(r[0]),W(r[1])]))),a=="Date"&&(t=new Date(e.getTime())),a=="RegExp"&&(t=RegExp(e.source,Ct(e))),a=="Array"||a=="Object"){t=Array.isArray(e)?[]:{};for(let r in e)t[r]=W(e[r])}return t}function ie(e){return e&&(e instanceof Date||e.constructor.name=="File"||e.constructor.name=="FileList")?!1:typeof e=="object"&&e!==null&&!Array.isArray(e)}function Pt(e){const t={};for(const a in e){if(!Object.prototype.hasOwnProperty.call(e,a))continue;const r=e[a],l=a.split(".");let n=t;for(let s=0;s<l.length;s++){const o=l[s],$=s===l.length-1,v=o.match(/^\d+$/)?Number(o):null;if(v!==null){if(Array.isArray(n))if($)n[v]=r;else{if(typeof n[v]!="object"||n[v]===null){const c=l[s+1];n[v]=c&&c.match(/^\d+$/)?{$each:[],$self:[]}:{}}n="$each"in n[v]?n[v].$each:n[v]}}else if($)if(Array.isArray(n[o])){let c=n[o].slice();n[o]={},n[o].$self=c}else typeof n[o]=="object"&&n[o]!==null&&"$each"in n[o]?n[o].$self=r:n[o]=r;else{const c=l[s+1];if(Array.isArray(n[o])){let N=n[o].slice();n[o]={$each:[]},n[o].$self=N}(typeof n[o]!="object"||n[o]===null||Array.isArray(n[o])&&!c.match(/^\d+$/))&&(c&&c.match(/^\d+$/)?n[o]={$each:[],$self:[]}:n[o]={}),"$each"in n[o]?n=n[o].$each:n=n[o]}}}return t}function ft(e){const t=Object.prototype.toString.call(e);return e==null?new Date(NaN):e instanceof Date||typeof e=="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Vt(e,t,{immediate:a=!1,trackDebounceRef:r}={}){let l;const n=(...s)=>{r&&(r.value=!0);function o(){r&&(r.value=!1)}return new Promise($=>{function v(c){$(c),o()}clearTimeout(l),l=setTimeout(()=>{l=void 0,a||Promise.resolve(e.apply(this,[...s])).then(v).finally(o)},t),a&&!l&&Promise.resolve(e.apply(this,[...s])).then(v).finally(o)})};return n.cancel=()=>{clearTimeout(l),l=void 0,r&&(r.value=!1)},n}function Ge(e,t,a=!1,r=!0){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var l,n,s;if(Array.isArray(e)&&Array.isArray(t)){if(l=e.length,l!=t.length)return!1;if(r||!r&&a){for(n=l;n--!==0;)if(!Ge(e[n],t[n],a,!1))return!1}return!0}if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(s=Object.keys(e),l=s.length,l!==Object.keys(t).length)return!1;for(n=l;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[n]))return!1;for(n=l;n--!==0;){var o=s[n];if(ie(e)&&ie(t)&&o&&(r||!r&&a)&&!Ge(e[o],t[o],a,!1))return!1}return!0}return e!==e&&t!==t}const Xe={Inline:"__inline",Async:"__async"};function qt(e,t){return e.some(a=>t?a?.[t]:!1)}function zt(e,t){return t?e.reduce((a,r)=>{const l=r?.[t]||[];return a.concat(l)},[]):[]}function Oe(e){try{return e.map(t=>Ie(t))}catch{return[]}}function It(e){return e.map(t=>t instanceof Function?u(t):Me(t)?t:U(()=>t))}function Ft(e){const r=e.toString().replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").match(/^(?:async\s*)?(?:function\b.*?\(|\((.*?)\)|(\w+))\s*=>|\((.*?)\)\s*=>|function.*?\((.*?)\)|\((.*?)\)/);return r?(r[0]||r[1]||r[2]||r[3]||r[4]||"").split(",").map(s=>s.trim()).filter(s=>s.length>0).length:0}function vt(e,...t){const{validator:a,type:r,async:l}=e,n=l||r===Xe.Async||a.constructor.name==="AsyncFunction";return xt({...{validator($,...v){return e.validator($,...Oe(v.length?v:t))},message($){return typeof e.message=="function"?e.message({...$,$params:Oe($?.$params?.length?$.$params:t)}):e.message},active($){return typeof e.active=="function"?e.active({...$,$params:Oe($?.$params?.length?$.$params:t)}):e.active??!0},tooltip($){return typeof e.tooltip=="function"?e.tooltip({...$,$params:Oe($?.$params?.length?$.$params:t)}):e.tooltip??[]},exec($){const v=e.validator($,...Oe(t));let c;return v instanceof Promise?v.then(N=>(c=N,typeof c=="object"&&"$valid"in c?c.$valid:typeof c=="boolean"?c:!1)):(c=v,typeof c=="object"&&"$valid"in c?c.$valid:typeof c=="boolean"?c:!1)}},type:r,_validator:e.validator,_message:e.message,_active:e.active,_tooltip:e.tooltip,_type:e.type,_message_patched:!1,_tooltip_patched:!1,_async:n,_params:It(t),_brand:Nt})}function T(e){if(typeof e.validator=="function"){let t=[];const a=e.async??e.validator.constructor.name==="AsyncFunction",r=vt({...e,async:a},...t);if(Ft(e.validator)>1){const l=function(...n){return vt(e,...n)};return l.validator=r.validator,l.message=r.message,l.active=r.active,l.tooltip=r.tooltip,l.type=r.type,l.exec=r.exec,l._validator=r.validator,l._message=r.message,l._active=r.active,l._tooltip=r.tooltip,l._type=e.type,l._message_pacthed=!1,l._tooltip_pacthed=!1,l._async=a,l}else return r}throw new Error("[createRule] validator must be a function")}function Lt(){const e=Te(new Map),t=Te(new Map),a=Te(new Map),r=Te(new Map),l=Te(new Map),n=Te(new Map);function s(b){const i=t.value.get(b);if(i)return i;{const I=P({});return t.value.set(b,I),I}}function o(b){const i=a.value.get(b);if(i)return i;{const I=P([]);return a.value.set(b,I),I}}function $(b,i,I){n.value.set(`${b}-${i}`,I)}function v(b,i){return n.value.get(`${b}-${i}`)}function c(b,i){b&&i!=null&&n.value.delete(`${b}-${i}`)}function N(b,i){r.value.set(b,i)}function w(b){return r.value.get(b)??!1}function A(b,i){e.value.set(b,i)}function O(b,i){const I=e.value.get(b);return I?F(i,I)?{valid:!0}:{valid:!1}:void 0}function F(b,i){const I=Object.keys(i),_=Object.keys(b);return _.length!==I.length||!_.every(y=>I.includes(y))?!1:_.every(y=>{const m=b[y],d=i[y];return!d||!m||typeof m=="function"||typeof d=="function"||typeof m=="number"||typeof m=="boolean"?!1:m._params?m._params?.every((V,H)=>{if(typeof d=="number"||typeof d=="boolean")return!0;{const ne=Oe(d._params),Z=Oe(m._params);return ne?.[H]===Z?.[H]}}):!0})}function C(b){const i=l.value.get(b);if(i)return i;{const I=P(!1),_=P(!0),E=P({}),y=P(!1);return l.value.set(b,{$pending:I,$valid:_,$metadata:E,$validating:y}),{$pending:I,$valid:_,$metadata:E,$validating:y}}}return He()&&Ze(()=>{e.value.clear(),t.value.clear(),a.value.clear(),r.value.clear(),l.value.clear(),n.value.clear()}),{addRuleDeclEntry:A,setDirtyEntry:N,checkRuleDeclEntry:O,getDirtyState:w,trySetRuleStatusRef:C,getFieldsEntry:s,getCollectionsEntry:o,getArrayStatus:v,addArrayStatus:$,deleteArrayStatus:c,arrayStatusStorage:n}}function Je(e){return ie(e.value)}function $t(e,t,a){const r=ae();let l;return e instanceof Function?l=r.run(()=>e(t,a??0)):l=e,{scope:r,unwrapped:l}}const Ce={LessThan:-1,EqualTo:0,GreaterThan:1};function Mt(e,t){const a=String(e).split("."),r=String(t).split(".");for(let l=0;l<Math.min(a.length,r.length);l++){const n=Number(a[l]),s=Number(r[l]);if(n>s)return Ce.GreaterThan;if(s>n)return Ce.LessThan;if(!isNaN(n)&&isNaN(s))return Ce.GreaterThan;if(isNaN(n)&&!isNaN(s))return Ce.LessThan}return Ce.EqualTo}const ht=Mt(Ot,"3.5.0")!==-1;function Wt(){return Math.floor(Math.random()*Date.now()).toString()}function Qe(){return typeof window>"u"?Wt():window.crypto.getRandomValues(new Uint32Array(1))[0].toString(10)}function Ut(e){return He()?(Ze(e),!0):!1}function Gt(e){let t=!1,a;const r=ae(!0);return((...l)=>(t||(a=r.run(()=>e(...l)),t=!0),a))}function gt(e,t){return Je(e)||ie(t.value)&&!De(t.value)&&!Object.entries(t.value).some(([a,r])=>qe(r)||typeof r=="function")}function Bt(e,t,a=!1){return!!e.value&&ie(e.value)&&"$each"in e.value||a&&Array.isArray(t.value)&&t.value.some(ie)||Array.isArray(t.value)&&t.value.some(ie)}function bt(e){return!!e.value&&(ie(e.value)||Je(e.value))}function qe(e){return ie(e)&&"_validator"in e}function Le(e){return typeof e.value=="function"?"_validator"in e.value:!0}function Ht(e){return ie(e)&&"$fields"in e}function dt(e){return!!e&&"$rules"in e}function mt({field:e,silent:t=!1}){const l=Object.entries(e.$rules??{}).map(([o,$])=>{let v="";if(t&&!$.$valid)v=$.$message;else if(!$.$valid&&e.$error&&!$.$validating)v=$.$message;else return null;return{$message:v,$property:e.fieldName,$rule:o,$type:$.$type,...typeof $.$metadata=="object"?$.$metadata:{}}}).filter(o=>!!o).reduce((o,$)=>(typeof $.$message=="string"?o.push($):o.push(...$.$message.map(v=>({...$,$message:v}))),o),[]),n=e.$error&&e.$externalErrors?e.$externalErrors.map(o=>({$message:o,$property:e.fieldName,$rule:"external",$type:void 0})):[];let s=[];return e.$schemaErrors&&e.$error&&(!Array.isArray(e.$schemaErrors)&&"$self"in e.$schemaErrors?s=e.$schemaErrors.$self??[]:s=e.$schemaErrors??[]),[...l,...n,...s]}function Zt({field:e}){const t=[];for(const a of Object.values(e.$rules??{})){const r=a.$tooltip;r&&(typeof r=="string"?t.push(r):t.push(...r))}return t}function Yt({customMessages:e,rule:t,ruleKey:a,state:r,path:l,cachePath:n,storage:s,$debounce:o,modifiers:$}){let v=ae(),c={},N;const w=u(()=>qe(t.value)&&t.value._async),A=P(!1),{$pending:O,$valid:F,$metadata:C,$validating:b}=s.trySetRuleStatusRef(`${n}.${a}`);function i(){v=ae(),c=v.run(()=>{const d=P(!1),V=P(!1),H=P(!0),ne=P(!1),Z=P(!1),ce=u(()=>({$value:r.value,$error:V.value,$dirty:d.value,$pending:ne.value,$correct:Z.value,$invalid:H.value,$rule:{$valid:F.value,$invalid:!F.value,$pending:O.value},$params:j.value,...C.value})),me=u(()=>Le(t)?typeof t.value.active=="function"?t.value.active(ce.value):!!t.value.active:!0);function Ee(f){let g="";const R=e?e[a]?.[f]:void 0;if(R&&(typeof R=="function"?g=R(ce.value):g=R),Le(t)){const Y=`_${f}_patched`;R&&!t.value[Y]||(typeof t.value[f]=="function"?g=t.value[f](ce.value):g=t.value[f]??"")}return g}const M=u(()=>{let f=Ee("message");return De(f)&&(f="This field is not valid"),f}),Q=u(()=>Ee("tooltip")),we=u(()=>Le(t)&&t.value.type?t.value.type:a),ye=u(()=>Le(t)?t.value.validator:t.value),j=u(()=>typeof t.value=="function"?[]:Oe(t.value._params??[])),B=u(()=>`${l}.${we.value}`);return{$active:me,$message:M,$type:we,$validator:ye,$params:j,$path:B,$tooltip:Q,$fieldCorrect:Z,$fieldError:V,$fieldDirty:d,$fieldPending:ne,$fieldInvalid:H}}),N=te(c?.$params,()=>{(!$.$silent.value||$.$rewardEarly.value&&c.$fieldError.value)&&E()})}i();function I(){F.value=!0,c.$fieldDirty.value&&(O.value=!0)}async function _(){let d=!1;try{const V=c.$validator.value;if(typeof V!="function")return console.error(`${l}: Incorrect rule format, it needs to be either a function or created with "createRule".`),!1;const H=V(r.value,...c.$params.value);let ne=r.value;I();let Z;if(H instanceof Promise?Z=await H:Z=H,r.value!==ne)return!0;if(typeof Z=="boolean")d=Z;else{const{$valid:ce,...me}=Z;d=ce,C.value=me}}catch{d=!1}finally{O.value=!1}return d}async function E(){try{b.value=!0;let d=!1;if(A.value=!0,qe(t.value)&&t.value._async)d=await _();else{const V=c.$validator.value,H=V(r.value,...c.$params.value);if(H instanceof Promise)console.warn('You used a async validator function on a non-async rule, please use "async await" or the "withAsync" helper');else if(H!=null)if(typeof H=="boolean")d=H;else{const{$valid:ne,...Z}=H;d=ne,C.value=Z}}return F.value=d,d}catch{return!1}finally{b.value=!1,A.value=!1}}function y(){F.value=!0,C.value={},O.value=!1,b.value=!1,i()}function m(){N(),v.stop(),v=ae()}return be({...c,$pending:O,$valid:F,$metadata:C,$haveAsync:w,$maybePending:A,$validating:b,$parse:E,$unwatch:m,$watch:i,$reset:y})}function ke({state:e,rulesDef:t,customMessages:a,path:r,cachePath:l,fieldName:n,storage:s,options:o,externalErrors:$,schemaErrors:v,schemaMode:c,onUnwatch:N,$isArray:w,initialState:A,originalState:O,shortcuts:F,onValidate:C}){let b=ae(),i,I=[],_,E,y,m,d=()=>{};const V=P(!1);function H(){const h=t.value,X=s.checkRuleDeclEntry(l,h),J={};for(const se in h)se.startsWith("$")&&(J[se]=h[se]);Q.value=J,ce();const ue=t.value,Se=[];for(const se in ue){if(se.startsWith("$"))continue;const ve=ue[se];if(!ve)continue;const je=U(()=>ve);Se.push([se,Yt({modifiers:{$silent:i.$silent,$rewardEarly:i.$rewardEarly},customMessages:a,rule:je,ruleKey:se,state:e,path:r,cachePath:l,storage:s,$debounce:Q.value.$debounce})])}M.value=Object.fromEntries(Se),i.processShortcuts(),ne(),X?.valid!=null&&(i.$dirty.value=s.getDirtyState(l),(i.$dirty.value&&!i.$silent.value||i.$rewardEarly.value&&i.$error.value)&&d()),s.addRuleDeclEntry(l,h)}function ne(){i.$debounce.value||i.$haveAnyAsyncRule.value?d=Vt(Ee,i.$debounce.value??(i.$haveAnyAsyncRule?200:0),{trackDebounceRef:V}):d=Ee}function Z(){if(M.value)for(const h of Object.values(M.value))h.$unwatch();E(),m?.(),i.$dirty.value&&s.setDirtyEntry(l,i.$dirty.value),_?.(),b.stop(),b=ae();for(const h of I)h.stop();I=[],N?.(),y?.()}function ce(){if(M.value)for(const h of Object.values(M.value))h.$watch();i=b.run(()=>{const h=P(!1),X=P(!1),J=u(()=>h.value),ue=u(()=>Q.value.$debounce),Se=u(()=>Q.value.$deepCompare!=null?Q.value.$deepCompare:!1),se=u(()=>Q.value.$lazy!=null?Q.value.$lazy:G(o.lazy)!=null?G(o.lazy):!1),ve=u(()=>Q.value.$rewardEarly!=null?Q.value.$rewardEarly:G(o.rewardEarly)!=null?G(o.rewardEarly):!1),je=u(()=>Q.value.$clearExternalErrorsOnChange!=null?Q.value.$clearExternalErrorsOnChange:G(o.clearExternalErrorsOnChange)!=null?G(o.clearExternalErrorsOnChange):!Re.value),Re=u(()=>ve.value?!0:Q.value.$silent!=null?Q.value.$silent:G(o.silent)!=null?G(o.silent):!1),q=u(()=>Q.value.$autoDirty!=null?Q.value.$autoDirty:G(o.autoDirty)!=null?G(o.autoDirty):!0),S=u(()=>{for(const k of Object.values(M.value))if(k.$validating)return!0;return!1}),D=u({get:()=>e.value,set(k){_(),e.value=k,me()}}),z=u(()=>V.value?Ne.value&&h.value:Ne.value&&!_e.value&&h.value),$e=u(()=>mt({field:{$rules:M.value,$error:z.value,$externalErrors:$?.value,$schemaErrors:v?.value,fieldName:n}})),Ke=u(()=>mt({field:{$rules:M.value,$error:z.value,$externalErrors:$?.value,$schemaErrors:v?.value,fieldName:n},silent:!0})),et=u(()=>$e.value.map(k=>k.$message)),tt=u(()=>Ke.value.map(k=>k.$message)),Ue=u(()=>h.value?A.value instanceof Date&&e.value instanceof Date?ft(A.value).getDate()!==ft(e.value).getDate():A.value==null?!!e.value:Array.isArray(e.value)&&Array.isArray(A.value)?!Ge(e.value,A.value,Q.value.$deepCompare):A.value!==e.value:!1),rt=u(()=>Ue.value),at=u(()=>Zt({field:{$rules:M.value}})),nt=u(()=>(Re.value||J.value)&&!(Ne.value||_e.value)),_e=u(()=>X.value||!ve.value?Object.entries(M.value).some(([k,xe])=>xe.$pending):!1),Ne=u(()=>v?.value&&!Array.isArray(v?.value)&&"$self"in v?.value?v?.value.$self?.length>0:$?.value?.length||v?.value?.length?!0:Fe.value?!1:Object.values(M.value).some(k=>!k.$valid||k.$maybePending)),lt=u(()=>n),Fe=u(()=>!c&&!Object.keys(t.value).some(k=>!k.startsWith("$"))),ut=u(()=>{if($?.value?.length)return!1;if(Fe.value)return!1;if(V.value)return!1;if(h.value&&!De(e.value)&&!S.value&&!_e.value){if(c)return!v?.value?.length;{const k=Object.values(M.value);for(const xe of k)if(xe.$active&&!xe.$valid)return!1;return k.some(xe=>xe.$active)}}return!1}),St=u(()=>Object.values(M.value).some(k=>k.$haveAsync));function Rt(){F?.fields&&Object.entries(F.fields).forEach(([k,xe])=>{const it=ae();st[k]=it.run(()=>{const ot=P();return Ve(()=>{ot.value=xe(be({$dirty:h,$externalErrors:$?.value??[],$value:e,$silentValue:D,$rules:M,$error:z,$pending:_e,$invalid:Ne,$correct:ut,$errors:et,$ready:nt,$silentErrors:tt,$anyDirty:J,$tooltips:at,$name:lt,$inactive:Fe,$edited:Ue,$anyEdited:rt}))}),ot}),I.push(it)})}const st={};return{$error:z,$pending:_e,$invalid:Ne,$correct:ut,$debounce:ue,$deepCompare:Se,$lazy:se,$ready:nt,$issues:$e,$silentIssues:Ke,$errors:et,$silentErrors:tt,$rewardEarly:ve,$autoDirty:q,$silent:Re,$clearExternalErrorsOnChange:je,$anyDirty:J,$edited:Ue,$anyEdited:rt,$name:lt,$haveAnyAsyncRule:St,$shortcuts:st,$validating:S,$tooltips:at,$dirty:h,processShortcuts:Rt,$silentValue:D,$inactive:Fe}}),me(),E=te(i.$dirty,h=>{s.setDirtyEntry(l,h),Object.values(M.value).forEach(X=>{X.$fieldDirty=h})}),m=te([i.$error,i.$correct,i.$invalid,i.$pending],()=>{Object.values(M.value).forEach(h=>{h.$fieldError=i.$error.value,h.$fieldInvalid=i.$invalid.value,h.$fieldPending=i.$pending.value,h.$fieldCorrect=i.$correct.value})}),y=te(i.$haveAnyAsyncRule,ne)}function me(){_=te(e,()=>{i.$autoDirty.value&&!i.$silent.value&&(i.$dirty.value||(i.$dirty.value=!0)),t.value instanceof Function&&H(),(!i.$silent.value||i.$rewardEarly.value&&i.$error.value)&&d(),i.$clearExternalErrorsOnChange.value&&f()},{deep:w?!0:ht?1:!0})}function Ee(){Object.values(M.value).forEach(h=>{h.$parse()})}const M=P({}),Q=P({});H();function we(h,X){if(f(),i.$dirty.value=!1,s.setDirtyEntry(l,!1),!X)if(h?.toOriginalState)e.value=W(O),A.value=W(O);else if(h?.toInitialState)e.value=W(A.value);else if(h?.toState){let J;typeof h?.toState=="function"?J=h?.toState():J=h?.toState,A.value=W(J),e.value=W(J)}else A.value=ie(e.value)?W(e.value):Array.isArray(e.value)?[...e.value]:e.value;if(h?.clearExternalErrors&&f(),!X)for(const J of Object.values(M.value))J.$reset();if(!i.$lazy.value&&!i.$silent.value&&!X)for(const J of Object.values(M.value))J.$parse()}function ye(h=!0,X=!1){i.$dirty.value||(i.$dirty.value=!0),X&&h?(!i.$silent.value||i.$rewardEarly.value&&i.$error.value)&&d():h&&d()}async function j(){try{if(c)return C?(ye(!1),C()):{valid:!1,data:e.value};const h=e.value;if(!i.$dirty.value)i.$dirty.value=!0;else if(!i.$silent.value&&i.$dirty.value&&!i.$pending.value)return{valid:!i.$error.value,data:h};return c?{valid:!v?.value?.length,data:h}:De(M.value)?{valid:!0,data:h}:{valid:(await Promise.allSettled(Object.values(M.value).map(ue=>ue.$parse()))).every(ue=>ue.status==="fulfilled"&&ue.value===!0),data:h}}catch{return{valid:!1,data:e.value}}}function B(h=!0){return i.$dirty.value?e.value:h?{_null:!0}:null}function f(){$?.value?.length&&($.value=[])}!i.$lazy.value&&!i.$dirty.value&&!i.$silent.value&&d();const{$shortcuts:g,$validating:R,$autoDirty:Y,$rewardEarly:p,$clearExternalErrorsOnChange:L,$haveAnyAsyncRule:K,$debounce:ee,$lazy:re,...fe}=i;return be({...fe,$externalErrors:$,$value:e,$initialValue:A,$originalValue:O,$rules:M,...g,$path:r,$isDebouncing:V,$reset:we,$touch:ye,$validate:j,$unwatch:Z,$watch:ce,$extractDirtyFields:B,$clearExternalErrors:f})}function yt({$id:e,path:t,cachePath:a,index:r,options:l,storage:n,stateValue:s,customMessages:o,rules:$,externalErrors:v,schemaErrors:c,initialState:N,originalState:w,shortcuts:A,fieldName:O,schemaMode:F}){const C=s.value?.$id??$.$key??Qe();let b=`${a}.${String(C)}`,i=`${t}.${r}`;typeof s.value=="object"&&s.value!=null&&(s.value.$id||Object.defineProperties(s.value,{$id:{value:C,enumerable:!1,configurable:!1,writable:!1}}));const I=U(v?.value??[],r),_=u(()=>c?.value?.[r]),E=Pe({index:r,state:s,rulesDef:U(()=>$),customMessages:o,path:i,cachePath:b,storage:n,options:l,externalErrors:I,schemaErrors:_,initialState:N,originalState:w,shortcuts:A,fieldName:O,schemaMode:F});if(E){const y=s.value?.$id;E.$id=y??String(C),n.addArrayStatus(e,E.$id,E)}return E}function Xt({state:e,rulesDef:t,customMessages:a,path:r,storage:l,options:n,externalErrors:s,schemaErrors:o,schemaMode:$,initialState:v,originalState:c,shortcuts:N,fieldName:w}){let A=ae(),O,F=ae(),C,b=[];if(!Array.isArray(e.value)&&!t.value.$each)return;const i=P(),I=P(e.value),_=P({});let E,y;const m=P({}),d=l.getCollectionsEntry(r);C=F.run(()=>({isPrimitiveArray:u(()=>e.value?.length?Array.isArray(e.value)&&e.value.length?e.value.every(g=>typeof g!="object"):t.value.$each&&!(t.value.$each instanceof Function)?Object.values(t.value.$each).every(g=>qe(g)||typeof g=="function"):!1:!1)})),V(),ce();function V(){_.value=Object.fromEntries(Object.entries(t.value).filter(([f])=>f.startsWith("$"))),typeof e.value=="object"&&(e.value!=null&&!e.value?.$id&&e.value!==null?(i.value=Qe(),Object.defineProperties(e.value,{$id:{value:i.value,enumerable:!1,configurable:!1,writable:!1}})):e.value?.$id&&(i.value=e.value.$id)),I.value=m.value.$value,Array.isArray(e.value)&&!C.isPrimitiveArray.value?d.value=e.value.filter(f=>typeof f=="object").map((f,g)=>{const{scope:R,unwrapped:Y}=$t(t.value.$each,U(()=>f),g);R&&b.push(R);const p=U(v.value??[],g),L=U(s?.value??{},"$each"),K=u(()=>o?.value?.$each),ee=yt({$id:i.value,path:r,cachePath:r,customMessages:a,rules:Y??{},stateValue:U(()=>f),index:g,options:n,storage:l,externalErrors:L,schemaErrors:K,initialState:p,originalState:c,shortcuts:N,fieldName:w,schemaMode:$});return ee||null}).filter(f=>!!f):d.value=[],m.value=ke({state:e,rulesDef:t,customMessages:a,path:r,cachePath:r,storage:l,options:n,externalErrors:U(s?.value??{},"$self"),schemaErrors:u(()=>o?.value?.$self),$isArray:!0,initialState:v,originalState:c,shortcuts:N,fieldName:w,schemaMode:$})}function H(){if(Array.isArray(e.value)&&!C.isPrimitiveArray.value){const f=W(d.value);d.value=e.value.filter(g=>typeof g=="object").map((g,R)=>{const Y=U(()=>g);if(g.$id&&d.value.find(p=>p.$id===g.$id)){const p=l.getArrayStatus(i.value,g.$id);return p?(p.$value=Y,p):null}else{const{scope:p,unwrapped:L}=$t(t.value.$each,Y,R);p&&b.push(p);const K=U(s?.value??{},"$each"),ee=u(()=>o?.value?.$each??[]),re=yt({$id:i.value,path:r,cachePath:r,customMessages:a,rules:L??{},stateValue:Y,index:R,options:n,storage:l,externalErrors:K,schemaErrors:ee,initialState:U(v.value??[],R),originalState:c,shortcuts:N,fieldName:w,schemaMode:$});return re||null}}).filter(g=>!!g),f.filter(g=>!e.value?.find(R=>g.$id===R.$id)).forEach((g,R)=>{l.deleteArrayStatus(i.value,R.toString())})}else d.value=[]}function ne(){E=te(e,()=>{y?.(),e.value!=null&&!Object.hasOwn(e.value,"$id")&&!i.value?V():H(),Z()},{deep:ht?1:!0,flush:"pre"}),Z()}function Z(){y=te(e,()=>{O.$autoDirty.value&&!O.$silent.value&&m.value.$touch(!1,!0)},{flush:"post"})}function ce(){ne(),A=ae(),O=A.run(()=>{const f=u({get:()=>e.value,set(q){E?.(),y?.(),e.value=q,ne()}}),g=u(()=>m.value.$dirty&&(!d.value.length||d.value.every(q=>q.$dirty))),R=u(()=>m.value.$anyDirty||d.value.some(q=>q.$anyDirty)),Y=u(()=>m.value.$invalid||d.value.some(q=>q.$invalid)),p=u(()=>(De(m.value.$rules)?!0:m.value.$correct)&&(!d.value.length||d.value.every(q=>q.$correct||q.$anyDirty&&!q.$invalid))),L=u(()=>m.value.$error||d.value.some(q=>q.$error)),K=u(()=>!(Y.value||ee.value)),ee=u(()=>m.value.$pending||d.value.some(q=>q.$pending)),re=u(()=>!!d.value.length&&d.value.every(q=>q.$edited)),fe=u(()=>m.value.$anyEdited||d.value.some(q=>q.$anyEdited)),h=u(()=>({$self:m.value.$issues,$each:d.value.map(q=>q.$issues)})),X=u(()=>({$self:m.value.$errors,$each:d.value.map(q=>q.$errors)})),J=u(()=>({$self:m.value.$silentErrors,$each:d.value.map(q=>q.$silentErrors)})),ue=u(()=>_.value.$rewardEarly!=null?_.value.$rewardEarly:G(n.rewardEarly)!=null?G(n.rewardEarly):!1),Se=u(()=>ue.value?!0:_.value.$silent!=null?_.value.$silent:G(n.silent)!=null?G(n.silent):!1),se=u(()=>_.value.$autoDirty!=null?_.value.$autoDirty:G(n.autoDirty)!=null?G(n.autoDirty):!0),ve=u(()=>w);function je(){N?.collections&&Object.entries(N?.collections).forEach(([q,S])=>{const D=ae();Re[q]=D.run(()=>{const z=P();return Ve(()=>{z.value=S(be({$dirty:g,$error:L,$path:r,$silentValue:f,$pending:ee,$invalid:Y,$correct:p,$errors:X,$silentErrors:J,$initialValue:v,$originalValue:c,$ready:K,$anyDirty:R,$name:ve,$each:d,$self:m,$value:e,$edited:re,$anyEdited:fe,$issues:h}))}),z}),b.push(D)})}const Re={};return je(),{$dirty:g,$anyDirty:R,$invalid:Y,$correct:p,$error:L,$pending:ee,$errors:X,$silentErrors:J,$ready:K,$name:ve,$shortcuts:Re,$silentValue:f,$edited:re,$anyEdited:fe,$rewardEarly:ue,$silent:Se,$autoDirty:se,$issues:h}}),C.isPrimitiveArray.value&&t.value.$each&&console.warn(`${r} is a Array of primitives. Tracking can be lost when reassigning the Array. We advise to use an Array of objects instead`)}function me(){E?.(),m.value&&m.value.$unwatch(),d.value&&d.value.forEach(f=>{"$dirty"in f&&f.$unwatch()}),A.stop(),A=ae(),F.stop(),F=ae(!0),b.forEach(f=>f.stop()),b=[]}function Ee(f=!0,g=!1){m.value.$touch(f,g),d.value.forEach(R=>{R.$touch(f,g)})}function M(f,g){if(me(),!g)if(f?.toOriginalState)e.value=W(c),v.value=W(c);else if(f?.toInitialState)e.value=W(v.value);else if(f?.toState){let R;typeof f?.toState=="function"?R=f?.toState():R=f?.toState,v.value=W(R),e.value=W(R)}else v.value=W(e.value);f?.clearExternalErrors&&we(),m.value.$reset(f,g),d.value.forEach(R=>{R.$reset(f,!0)}),g||V()}async function Q(){const f=e.value;try{return{valid:(await Promise.allSettled([m.value.$validate(),...d.value.map(Y=>Y.$validate())])).every(Y=>Y.status==="fulfilled"?Y.value.valid===!0:!1),data:f}}catch{return{valid:!1,data:f}}}function we(){m.value.$clearExternalErrors(),d.value.forEach(f=>{f.$clearExternalErrors()})}function ye(f=!0){let g=d.value.map(R=>{if(Ht(R))return R.$extractDirtyFields(f)});return f&&g.every(R=>De(R))&&(g=[]),g}const{$shortcuts:j,...B}=O;return be({$self:m,...B,...j,$path:r,$each:d,$value:e,$initialValue:v,$originalValue:c,$validate:Q,$unwatch:me,$watch:ce,$touch:Ee,$reset:M,$extractDirtyFields:ye,$clearExternalErrors:we})}function Be({rulesDef:e,state:t,path:a="",cachePath:r,rootRules:l,externalErrors:n,schemaErrors:s,rootSchemaErrors:o,validationGroups:$,initialState:v,originalState:c,fieldName:N,...w}){let A=ae(),O,F=[],C=null,b=null,i=null,I=null;async function _(j=!0){const B=Object.entries(e.value),f=Object.fromEntries(B.reduce((p,[L,K])=>{if(!K)return p;const ee=U(t.value??{},L),re=U(()=>K),fe=U(n?.value??{},L),h=u(()=>s?.value?.[L]),X=U(v?.value??{},L);return p.push([L,Pe({state:ee,rulesDef:re,path:a?`${a}.${L}`:L,cachePath:r?`${r}.${L}`:L,externalErrors:fe,schemaErrors:h,initialState:X,originalState:c?.[L],fieldName:L,...w})]),p},[])),g=Object.fromEntries(Object.entries(G(n)??{}).filter(([p,L])=>!(p in e.value)&&!!L).map(([p])=>{const L=U(t.value??{},p),K=U(n?.value??{},p),ee=u(()=>s?.value?.[p]),re=U(v?.value??{},p),fe=a?`${a}.${p}`:p,h=r?`${r}.${p}`:p;return[p,Pe({state:L,rulesDef:u(()=>({})),path:fe,cachePath:h,externalErrors:K,schemaErrors:ee,initialState:re,originalState:c?.[p],fieldName:p,...w})]})),R=Object.fromEntries(Object.entries(G(s)??{}).map(([p])=>{const L=a?`${a}.${p}`:p,K=r?`${r}.${p}`:p,ee=U(t.value??{},p),re=U(n?.value??{},p),fe=u(()=>s?.value?.[p]),h=U(v?.value??{},p),X=u(()=>({}));return[p,Pe({state:ee,rulesDef:X,path:L,cachePath:K,externalErrors:re,schemaErrors:fe,initialState:h,originalState:c?.[p],fieldName:p,...w})]})),Y=Object.fromEntries(Object.entries(t.value??{}).filter(([p])=>!(p in e.value)&&!(p in(g??{}))&&!(p in(R??{}))).map(([p])=>{const L=U(t.value??{},p),K=U(n?.value??{},p),ee=u(()=>s?.value?.[p]),re=U(v?.value??{},p);return[p,Pe({state:L,rulesDef:u(()=>({})),path:a?`${a}.${p}`:p,cachePath:r?`${r}.${p}`:p,externalErrors:K,schemaErrors:ee,initialState:re,originalState:c?.[p],fieldName:p,...w})]}));E.value={...f,...g,...R,...Y},j&&d()}const E=w.storage.getFieldsEntry(r);_();function y(){n&&(i=te(n,()=>{V(),_()},{deep:!0}))}function m(){I=te(t,()=>{V(),_(),O.$autoDirty.value&&!O.$silent.value&&Z(!1,!0)},{flush:"post"})}function d(){l&&(C?.(),C=te(l,()=>{V(),_()},{deep:!0,flush:"pre"}),y()),o&&(b?.(),b=te(o,()=>{V(),_()},{deep:!0,flush:"post"})),m(),O=A.run(()=>{const j=u({get:()=>t.value,set(S){V(),t.value=S,_(),O.$autoDirty.value&&!O.$silent.value&&Z(!1,!0)}}),B=u({get:()=>t.value,set(S){V(),t.value=S,_()}}),f=u(()=>{const S=E.value,D=Object.keys(S);if(!D.length)return!1;for(const z of D)if(!S[z]?.$dirty)return!1;return!0}),g=u(()=>{const S=E.value;for(const D in S)if(S[D]?.$anyDirty)return!0;return!1}),R=u(()=>{const S=E.value,D=Object.entries(S);if(!D.length)return!1;for(const[z,$e]of D)if($e?.$invalid)return!0;return!1}),Y=u(()=>{const S=Object.entries(E.value).reduce((D,[z,$e])=>((!dt($e)||!$e.$inactive)&&D.push([z,$e]),D),[]);return S.length?w.schemaMode?S.every(([D,z])=>z.$correct):S.every(([D,z])=>dt(z)?"required"in z.$rules&&z.$rules.required.$active?z.$correct:!z.$invalid&&!z.$pending&&!z.$isDebouncing:z?.$correct):!1}),p=u(()=>{const S=E.value;if(!Object.keys(S).length)return!1;for(const D in S)if(S[D]?.$error)return!0;return!1}),L=u(()=>G(w.options.rewardEarly)!=null?G(w.options.rewardEarly):!1),K=u(()=>G(w.options.silent)!=null?G(w.options.silent):!!L.value),ee=u(()=>G(w.options.autoDirty)!=null?G(w.options.autoDirty):!0),re=u(()=>(K.value||g.value)&&!(R.value||h.value)),fe=P(!1),h=u(()=>{if(fe.value)return!0;const S=E.value;for(const D in S)if(S[D]?.$pending)return!0;return!1}),X=u(()=>{const S={};for(const D in E.value)S[D]=E.value[D]?.$issues;return S}),J=u(()=>{const S={};for(const D in E.value)S[D]=E.value[D]?.$errors;return S}),ue=u(()=>{const S={};for(const D in E.value)S[D]=E.value[D]?.$silentErrors;return S}),Se=u(()=>{if(!Object.keys(E.value).length)return!1;for(const S in E.value)if(!E.value[S]?.$edited)return!1;return!0}),se=u(()=>{for(const S in E.value)if(E.value[S]?.$anyEdited)return!0;return!1}),ve=u(()=>N);function je(){w.shortcuts?.nested&&Object.entries(w.shortcuts.nested).forEach(([S,D])=>{const z=ae();q[S]=z.run(()=>{const $e=P();return Ve(()=>{$e.value=D(be({$dirty:f,$path:a,$value:t,$silentValue:B,$error:p,$originalValue:c,$pending:h,$invalid:R,$correct:Y,$ready:re,$anyDirty:g,$name:ve,$silentErrors:ue,$initialValue:v,$errors:J,$fields:E,$edited:Se,$anyEdited:se,$issues:X}))}),$e}),F.push(z)})}const Re=u({get:()=>$?Object.fromEntries(Object.entries($?.(E.value)??{}).map(([S,D])=>D.length?[S,{...Object.fromEntries(["$invalid","$error","$pending","$dirty","$correct"].map(z=>[z,qt(D,z)])),...Object.fromEntries(["$errors","$silentErrors"].map(z=>[z,zt(D,z)]))}]:[])):{},set(){}}),q={};return je(),{$dirty:f,$anyDirty:g,$invalid:R,$correct:Y,$error:p,$pending:h,$issues:X,$errors:J,$silentErrors:ue,$ready:re,$name:ve,$shortcuts:q,$groups:Re,$silentValue:B,$edited:Se,$anyEdited:se,$localPending:fe,$autoDirty:ee,$silent:K,$value:j}})}function V(){if(C?.(),i?.(),I?.(),b?.(),F=[],O={},E.value)for(const j of Object.values(E.value))j?.$unwatch()}function H(){const j=E.value;for(const B of Object.values(j))B.$clearExternalErrors()}function ne(j,B){if(i?.(),V(),!B)if(j?.toOriginalState)t.value=W({...c}),v.value=W({...c});else if(j?.toInitialState)t.value=W({...v.value??{}});else if(j?.toState){let f;typeof j?.toState=="function"?f=j?.toState():f=j?.toState,v.value=W(f),t.value=W(f)}else v.value=W(t.value);for(const f of Object.values(E.value))f?.$reset(j,!0);j?.clearExternalErrors&&H(),y(),B||_()}function Z(j=!0,B=!1){for(const f of Object.values(E.value))f?.$touch(j,B)}function ce(j){return j.filter(([B,f])=>ie(f)?!(f&&typeof f=="object"&&"_null"in f)&&!De(f):Array.isArray(f)?f.length:!0)}function me(j=!0){let B=Object.entries(E.value).map(([f,g])=>[f,g.$extractDirtyFields(j)]);return j&&(B=ce(B)),Object.fromEntries(B)}async function Ee(){try{if(w.schemaMode)return w.onValidate?(Z(!1),O.$localPending.value=!0,w.onValidate()):{valid:!1,data:t.value};{const j=t.value;return{valid:(await Promise.allSettled(Object.values(E.value).map(g=>g.$validate()))).every(g=>g.status==="fulfilled"&&g?.value.valid===!0),data:j}}}catch{return{valid:!1,data:t.value}}finally{O.$localPending.value=!1}}const{$shortcuts:M,$localPending:Q,...we}=O,ye=be({...we,...M,$path:a,$initialValue:v,$originalValue:c,$fields:E,$reset:ne,$touch:Z,$validate:Ee,$unwatch:V,$watch:d,$clearExternalErrors:H,$extractDirtyFields:me});return Ve(()=>{for(const j of Object.keys(ye).filter(B=>!B.startsWith("$")))delete ye[j];for(const j of Object.values(E.value))j?.$name&&Object.assign(ye,{[j.$name]:j})}),ye}function Pe({rulesDef:e,...t}){if(Bt(e,t.state,t.schemaMode))return Xt({rulesDef:e,...t});if(gt(t.state,e)){if(Je(t.state))return Be({rulesDef:e,...t});{const r=ae().run(()=>{const s=U(t.state.value?t.state:P({}));return te(()=>t.state.value,o=>{s.value=o},{deep:!0}),te(s,o=>{t.state.value=o},{deep:!0}),{fakeState:s}}),{state:l,...n}=t;return Be({rulesDef:e,...n,state:r.fakeState})}}else if(bt(e))return ke({rulesDef:Me(e.value)?e.value:e,...t})}function Jt({initialState:e,originalState:t,options:a,scopeRules:r,state:l,customRules:n,shortcuts:s,schemaErrors:o,schemaMode:$=!1,onValidate:v}){const c=Lt(),N=P(),w=P();let A,O;function F(){A=te(()=>a.externalErrors?.value,()=>{O?.(),a.externalErrors?.value&&Object.keys(a.externalErrors.value).some(b=>b.includes("."))?w.value=Pt(a.externalErrors.value):w.value=a.externalErrors?.value,C()},{immediate:!0,deep:!0})}function C(){O=te(()=>w.value,()=>{A?.(),a.externalErrors?.value&&(a.externalErrors.value=w.value),F()},{deep:!0})}return F(),gt(l,r)?N.value=Be({rootRules:r,rulesDef:r,state:l,customMessages:n?.(),storage:c,options:a,externalErrors:w,validationGroups:a.validationGroups,initialState:e,originalState:t,shortcuts:s,fieldName:"root",path:"",cachePath:"",schemaErrors:o,rootSchemaErrors:o,schemaMode:$,onValidate:v}):bt(r)&&(N.value=ke({rulesDef:r,state:l,customMessages:n?.(),storage:c,options:a,externalErrors:w,initialState:e,originalState:t,shortcuts:s,fieldName:"root",path:"",cachePath:"",schemaMode:$,schemaErrors:o,onValidate:v})),He()&&Ze(()=>{N.value?.$unwatch()}),be({regle:N})}function Et(e,t,a){const r={autoDirty:t?.autoDirty,lazy:t?.lazy,rewardEarly:t?.rewardEarly,silent:t?.silent,clearExternalErrorsOnChange:t?.clearExternalErrorsOnChange};function l(n,s,o){const $=Me(s)?s:typeof s=="function"?void 0:u(()=>s),v={...r,...o},c=Me(n)?n:P(n),N=Te($??{});typeof s=="function"&&Ve(()=>{N.value=s(c),jt(N)});const w=P(ie(c.value)?{...W(c.value)}:W(c.value)),A=ie(c.value)?{...W(c.value)}:W(c.value);return{r$:Jt({scopeRules:N,state:c,options:v,initialState:w,originalState:A,customRules:e,shortcuts:a}).regle}}return l}const Qt=Et();function kt(){function e(t,a){return a}return e}function Kt({rules:e,modifiers:t,shortcuts:a}){const r=Et(e,t,a);r.__config={rules:e,modifiers:t,shortcuts:a};const l=kt();return{useRegle:r,inferRules:l}}function pt(e,t){const a=t??!1,r=u({get:()=>a?Object.values(e).map(y=>y.$value):Object.fromEntries(Object.entries(e).map(([y,m])=>[y,m.$value])),set:y=>{a||typeof y=="object"&&Object.entries(y).forEach(([m,d])=>e[m].$value=d)}}),l=u({get:()=>Object.fromEntries(Object.entries(e).map(([y,m])=>[y,m.$silentValue])),set:y=>{typeof y=="object"&&Object.entries(y).forEach(([m,d])=>e[m].$silentValue=d)}}),n=u(()=>{const y=Object.entries(e);return!!y.length&&y.every(([m,d])=>d?.$dirty)}),s=u(()=>Object.entries(e).some(([y,m])=>m?.$anyDirty)),o=u(()=>Object.entries(e).some(([y,m])=>m?.$invalid)),$=u(()=>{const y=Object.entries(e);return!!y.length&&y.every(([m,d])=>d?.$correct||d.$anyDirty&&!d.$invalid)}),v=u(()=>Object.entries(e).some(([y,m])=>m?.$error)),c=u(()=>{const y=Object.entries(e);return!!y.length&&y.every(([m,d])=>d?.$ready)}),N=u(()=>Object.entries(e).some(([y,m])=>m?.$pending)),w=u(()=>a?Object.entries(e).map(([y,m])=>m.$errors):Object.fromEntries(Object.entries(e).map(([y,m])=>[y,m.$errors]))),A=u(()=>a?Object.entries(e).map(([y,m])=>m.$silentErrors):Object.fromEntries(Object.entries(e).map(([y,m])=>[y,m.$silentErrors]))),O=u(()=>{const y=Object.entries(e);return!!y.length&&y.every(([m,d])=>d?.$edited)}),F=u(()=>Object.entries(e).some(([y,m])=>m?.$anyEdited)),C=u(()=>a?Object.values(e):e);function b(y){Object.values(e).forEach(m=>{m.$reset(y)})}function i(){Object.values(e).forEach(y=>{y.$touch()})}function I(y=!0){return Object.values(e).map(m=>m.$extractDirtyFields(y))}function _(){Object.values(e).forEach(y=>{y.$clearExternalErrors()})}async function E(){try{const y=r.value;return{valid:(await Promise.allSettled(Object.values(e).map(V=>V.$validate()))).every(V=>V.status==="fulfilled"?V.value.valid===!0:!1),data:y}}catch{return{valid:!1,data:r.value}}}return be({...!a&&{$silentValue:l},$errors:w,$silentErrors:A,$instances:C,$value:r,$dirty:n,$anyDirty:s,$invalid:o,$correct:$,$error:v,$pending:N,$ready:c,$edited:O,$anyEdited:F,$reset:b,$touch:i,$validate:E,$extractDirtyFields:I,$clearExternalErrors:_})}function er(e,t){function a(r){const l=u(()=>Ie(r));o();const n=P($(e.value)),s=be({r$:n});function o(){l.value&&!e.value[l.value]&&(e.value[l.value]={})}te(l,o),te(e,v=>{n.value=$(v)},{deep:!0});function $(v){if(l.value){const c=v[l.value]??{};return pt(c,!t.asRecord)}else return pt(v["~~global"]??{},!t.asRecord)}return{r$:s.r$}}return{useCollectScope:a}}function tr(e,t){const a=t??Qt;return{useScopedRegle:((l,n,s)=>{const{namespace:o,scopeKey:$,...v}=s??{};a.__config??={};const c=u(()=>Ie(o)),N=P(`${Object.keys(e.value).length+1}-${Qe()}`),w=u(()=>s?.scopeKey??`instance-${N.value}`),{r$:A}=a(l,n,v);F(),Ut(O),te(c,(C,b)=>{O(b),F()}),ct()&&Tt(()=>{const C=ct();typeof window<"u"&&C?.proxy?.$el?.parentElement&&document.documentElement&&!document.documentElement.contains(C?.proxy?.$el?.parentElement)&&O()});function O(C){const b=C??c.value;b?e.value[b]&&delete e.value[b][w.value]:e.value["~~global"][w.value]&&delete e.value["~~global"][w.value]}function F(){c.value?(e.value[c.value]||(e.value[c.value]={}),e.value[c.value][w.value]=A):(e.value["~~global"]||(e.value["~~global"]={}),e.value["~~global"][w.value]=A)}return{r$:A,dispose:O,register:F}})}}function wt(e){const a=(e?.customStore?()=>(e.customStore&&(e.customStore?.value["~~global"]?e.customStore?.value&&(e.customStore.value={"~~global":{}}):e.customStore.value["~~global"]={}),e.customStore):Gt(()=>P({"~~global":{}})))(),{useScopedRegle:r}=tr(a,e?.customUseRegle),{useCollectScope:l}=er(a,{asRecord:e?.asRecord});return{useScopedRegle:r,useCollectScope:l}}wt();function zr(e,t,a){const r=u(()=>Ie(e)[t]);return u(()=>{const n=a.find(s=>{if(s[t]&&"literal"in s[t]){const o=s[t].literal;if(qe(o))return G(o._params?.[0])===r.value}});if(n)return n;{const s=a.find(o=>ie(o[t])&&!Object.keys(o[t]).some($=>$==="literal"));return s||{}}})}function de(e,t){let a,r,l,n;typeof e=="function"&&!("_validator"in e)?(a=Xe.Inline,r=e):{_type:a,validator:r,_active:l,_params:n}=e;const s=T({type:a,validator:r,active:l,message:t}),o=[...n??[]];if(s._params=o,s._message_patched=!0,typeof s=="function"){if(n!=null){const $=s(...o);return $._message_patched=!0,$}return s}else return s}function rr(e,t){let a,r,l=[],n="";typeof e=="function"?(r=(o,...$)=>e(o,...$),l=[t]):({_type:a,validator:r,_message:n}=e,l=l=e._params?.concat(t));const s=T({type:Xe.Inline,validator:r,message:n});return s._params=s._params?.concat(l),s(...t)}function ar(e){return e?.constructor.name=="File"||e?.constructor.name=="FileList"}function oe(e,t=!0){return e==null?!0:e instanceof Date?isNaN(e.getTime()):ar(e)?e.size<=0:Array.isArray(e)?t?e.length===0:!1:typeof e=="object"&&e!=null?Object.keys(e).length===0:!String(e).length}function Ae(e){if(oe(e))return!1;try{let t=null;if(e instanceof Date)t=e;else if(typeof e=="string"){const a=new Date(e);if(a.toString()==="Invalid Date")return!1;t=a}return!!t}catch{return!1}}function le(e){const t=Object.prototype.toString.call(e);return e==null?new Date(NaN):e instanceof Date||typeof e=="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function x(e,t=!0){return!oe(typeof e=="string"?e.trim():e,t)}function ge(e){return e==null||typeof e!="number"?!1:!isNaN(e)}function he(e,...t){if(oe(e))return!0;const a=typeof e=="number"?e.toString():e;return t.every(r=>(r.lastIndex=0,r.test(a)))}function ze(e){const t=G(e);return Array.isArray(t)?t.length:typeof t=="object"?Object.keys(t).length:typeof t=="number"?isNaN(t)?0:t:String(t).length}function pe(e){return typeof e=="number"?e:e!=null?typeof e=="string"?e.trim()!==e?NaN:+e:NaN:NaN}const nr=/^[a-zA-Z]*$/,lr=/^[\w.]+$/,ur=T({type:"alpha",validator(e,t){return oe(e)?!0:t?.allowSymbols?he(e,lr):he(e,nr)},message:"The value is not alphabetical"}),sr=/^[a-zA-Z0-9]*$/,ir=/^[a-zA-Z0-9_]*$/,or=T({type:"alphaNum",validator(e,t){return oe(e)?!0:t?.allowSymbols?he(e,ir):he(e,sr)},message:"The value must be alpha-numeric"}),cr=T({type:"between",validator:(e,t,a,r)=>{const{allowEqual:l=!0}=r??{};if(x(e)&&x(t)&&x(a)){const n=pe(e),s=pe(t),o=pe(a);return ge(n)&&ge(s)&&ge(o)?l?n>=s&&n<=o:n>s&&n<o:(console.warn(`[between] Value or parameters aren't numbers, got value: ${e}, min: ${t}, max: ${a}`),!1)}return!0},message:({$params:[e,t]})=>`The value must be between ${e} and ${t}`});T({type:"boolean",validator:e=>x(e)?typeof e=="boolean":!0,message:"The value must be a native boolean"});T({type:"checked",validator:e=>x(e)?e===!0:!0,message:"The field must be checked"});T({type:"contains",validator(e,t){return x(e)&&x(t)?e.includes(t):!0},message({$params:[e]}){return`The value must contain ${e}`}});T({type:"date",validator:e=>x(e)?e instanceof Date:!0,message:"The value must be a native Date constructor"});function fr(){return navigator.languages!=null?navigator.languages[0]:navigator.language}function We(e){return e?new Intl.DateTimeFormat(fr(),{dateStyle:"short"}).format(new Date(e)):"?"}T({type:"dateAfter",validator:(e,t,a)=>{const{allowEqual:r=!0}=a??{};return x(e)&&x(t)?Ae(e)&&Ae(t)?(r?le(e).getTime()>=le(t).getTime():le(e).getTime()>le(t).getTime())?!0:{$valid:!1,error:"date-not-after"}:{$valid:!1,error:"value-or-parameter-not-a-date"}:!0},message:({$params:[e],error:t})=>t==="value-or-parameter-not-a-date"?"The values must be dates":`The date must be after ${We(e)}`});T({type:"dateBefore",validator:(e,t,a)=>{const{allowEqual:r=!0}=a??{};return x(e)&&x(t)?Ae(e)&&Ae(t)?(r?le(e).getTime()<=le(t).getTime():le(e).getTime()<le(t).getTime())?!0:{$valid:!1,error:"date-not-before"}:{$valid:!1,error:"value-or-parameter-not-a-date"}:!0},message:({$params:[e],error:t})=>t==="value-or-parameter-not-a-date"?"The values must be dates":`The date must be before ${We(e)}`});T({type:"dateBetween",validator:(e,t,a,r)=>{const{allowEqual:l=!0}=r??{};return Ae(e)&&Ae(t)&&Ae(a)?l?le(e).getTime()>=le(t).getTime()&&le(e).getTime()<=le(a).getTime():le(e).getTime()>le(t).getTime()&&le(e).getTime()<le(a).getTime():!0},message:({$params:[e,t]})=>`The date must be between ${We(e)} and ${We(t)}`});const vr=/^[-]?\d*(\.\d+)?$/,$r=T({type:"decimal",validator(e){return oe(e)?!0:he(e,vr)},message:"The value must be decimal"}),dr=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i,mr=T({type:"email",validator(e){return oe(e)?!0:he(e,dr)},message:"The value must be an valid email address"});T({type:"endsWith",validator(e,t){return x(e)&&x(t)?e.endsWith(t):!0},message({$params:[e]}){return`The value must end with ${e}`}});T({type:"exactLength",validator:(e,t)=>x(e,!1)&&x(t)?ge(t)?ze(e)===t:(console.warn(`[minLength] Parameter isn't a number, got parameter: ${t}`),!1):!0,message:({$params:[e]})=>`The value should be exactly ${e} characters long`});T({type:"exactValue",validator:(e,t)=>x(e)&&x(t)?ge(t)&&!isNaN(pe(e))?pe(e)===t:(console.warn(`[exactValue] Value or parameter isn't a number, got value: ${e}, parameter: ${t}`),!0):!0,message:({$params:[e]})=>`The value must be equal to ${e}`});const yr=/^[a-fA-F0-9]*$/;T({type:"hexadecimal",validator(e){return oe(e)?!0:he(e,yr)},message:"The value must be hexadecimal"});const pr=/(^[0-9]*$)|(^-[0-9]+$)/,hr=T({type:"integer",validator(e){return oe(e)?!0:he(e,pr)},message:"The value must be an integer"});function gr(e){if(e.length>3||e.length===0||e[0]==="0"&&e!=="0"||!e.match(/^\d+$/))return!1;const t=+e|0;return t>=0&&t<=255}T({type:"ipv4Address",validator(e){if(oe(e))return!0;if(typeof e!="string")return!1;const t=e.split(".");return t.length===4&&t.every(gr)},message:"The value is not a valid IPv4 address"});function Ir(e){const t=u(()=>Ie(e));return de(rr((r,l)=>x(r)&&x(l)?l===r:!0,[t]),({$params:[r]})=>`Value should be ${r}.`)}T({type:"macAddress",validator(e,t=":"){if(oe(e))return!0;if(typeof e!="string")return!1;const a=typeof t=="string"&&t!==""?e.split(t):e.length===12||e.length===16?e.match(/.{2}/g):null;return a!==null&&(a.length===6||a.length===8)&&a.every(br)},message:"The value is not a valid MAC Address"});const br=e=>e.toLowerCase().match(/^[0-9a-f]{2}$/),Er=T({type:"maxLength",validator:(e,t,a)=>{const{allowEqual:r=!0}=a??{};return x(e,!1)&&x(t)?ge(t)?r?ze(e)<=t:ze(e)<t:(console.warn(`[maxLength] Value or parameter isn't a number, got value: ${e}, parameter: ${t}`),!1):!0},message:({$value:e,$params:[t]})=>Array.isArray(e)?`This list should have maximum ${t} items`:`The value length should not exceed ${t}`});T({type:"maxValue",validator:(e,t,a)=>{const{allowEqual:r=!0}=a??{};return x(e)&&x(t)?ge(t)&&!isNaN(pe(e))?r?pe(e)<=t:pe(e)<t:(console.warn(`[maxValue] Value or parameter isn't a number, got value: ${e}, parameter: ${t}`),!0):!0},message:({$params:[e,t]})=>{const{allowEqual:a=!0}=t??{};return a?`The value must be less than or equal to ${e}`:`The value must be less than ${e}`}});const wr=T({type:"minLength",validator:(e,t,a)=>{const{allowEqual:r=!0}=a??{};return x(e,!1)&&x(t)?ge(t)?r?ze(e)>=t:ze(e)>t:(console.warn(`[minLength] Parameter isn't a number, got parameter: ${t}`),!1):!0},message:({$value:e,$params:[t]})=>Array.isArray(e)?`The list should have at least ${t} items`:`The value length should be at least ${t}`});T({type:"minValue",validator:(e,t,a)=>{const{allowEqual:r=!0}=a??{};return x(e)&&x(t)?ge(t)&&!isNaN(pe(e))?r?pe(e)>=t:pe(e)>t:(console.warn(`[minValue] Value or parameter isn't a number, got value: ${e}, parameter: ${t}`),!0):!0},message:({$params:[e,t]})=>{const{allowEqual:a=!0}=t??{};return a?`The value must be greater than or equal to ${e}`:`The value must be greater than ${e}`}});T({type:"number",validator:e=>x(e)?ge(e):!0,message:"The value must be a native number"});const Sr=/^\d*(\.\d+)?$/,Rr=T({type:"numeric",validator(e){return oe(e)?!0:he(e,Sr)},message:"The value must be numeric"});T({type:"oneOf",validator(e,t){return x(e)&&x(t,!1)?t.includes(e):!0},message:({$params:[e]})=>`The value should be one of those options: ${e.join(", ")}.`});T({type:"regex",validator(e,t){if(x(e)){const a=Array.isArray(t)?t:[t];return he(e,...a)}return!0},message:"The value does not match the required pattern"});const xr=T({type:"required",validator:e=>x(e),message:"This field is required"}),Fr=T({type:"required",validator(e,t){return t?x(e):!0},message:"This field is required",active({$params:[e]}){return e}});T({type:"required",validator(e,t){return t?!0:x(e)},message:"This field is required",active({$params:[e]}){return!e}});T({type:"sameAs",validator(e,t,a){return oe(e)?!0:e===t},message({$params:[e,t="other"]}){return`The value must be equal to the ${t} value`}});T({type:"startsWith",validator(e,t){return x(e)&&x(t)?e.startsWith(t):!0},message({$params:[e]}){return`The value must end with ${e}`}});T({type:"string",validator:e=>x(e)?typeof e=="string":!0,message:"The value must be a string"});const Or=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i,jr=T({type:"url",validator(e){return oe(e)?!0:he(e,Or)},message:"The value is not a valid URL address"});var Tr=Dt();const Ar=At(Tr),Dr=T({validator:e=>x(e)?Ar(e).score>2:!0,message:()=>{const{$gettext:e}=Ye();return e("This password is too common or insecure.")}}),_r=T({validator:e=>!x(e)||/^#?[0-9A-F]{6}$/i.test(e),message:()=>{const{$gettext:e}=Ye();return e("This field must be a valid, non-transparent 6-character hex color.")}}),{useRegle:Nr}=Kt({rules:()=>{const{$gettext:e}=Ye();return{required:de(xr,e("This field is required.")),minLength:de(wr,({$params:[t]})=>e("This field must have at least %{min} letters.",{min:String(t)})),maxLength:de(Er,({$params:[t]})=>e("This field must have at most %{max} letters.",{max:String(t)})),between:de(cr,({$params:[t,a]})=>e("This field must be between %{min} and %{max}.",{min:String(t),max:String(a)})),alpha:de(ur,e("This field must only contain alphabetic characters.")),alphaNum:de(or,e("This field must only contain alphanumeric characters.")),numeric:de(Rr,e("This field must only contain numeric characters.")),integer:de(hr,e("This field must be a valid integer.")),decimal:de($r,e("This field must be a valid decimal number.")),email:de(mr,e("This field must be a valid e-mail address.")),url:de(jr,e("This field must be a valid URL.")),isValidPassword:Dr,isValidHexColor:_r}},modifiers:{autoDirty:!1}}),{useScopedRegle:Lr,useCollectScope:Mr}=wt({customUseRegle:Nr});export{jr as a,Fr as b,zr as c,Lr as d,mr as e,Mr as f,_r as g,Dr as i,Ir as l,wr as m,Rr as n,xr as r,Nr as u,de as w};
