import{D}from"./DataTable-BhAO7RbG.js";import{u as T,$ as q}from"./layout-CUzOT8aY.js";import{a as x,b as F}from"./useStationQuery-ClAZEJp_.js";import{G as Q,r as E,q as s,$ as d}from"./vue-BsfewpWM.js";function B(l,o,m,c,O){const e=Q({...D,paginated:!0,perPage:10}),u=E(!1),w=r=>{e.value=r},i=o;i.push(e);const{axios:y}=T(),f=async({signal:r})=>{const v=d(l);if(v===null)return{total:0,rows:[]};const t={internal:!0};e.value.paginated?(t.rowCount=e.value.perPage,t.current=e.value.perPage!==0?e.value.currentPage:1):t.rowCount=0,u.value&&(t.flushCache=!0,u.value=!1),e.value.searchPhrase!==""&&(t.searchPhrase=e.value.searchPhrase),e.value.sortField!==null&&(t.sort=e.value.sortField,t.sortOrder=e.value.sortOrder==="desc"?"DESC":"ASC");let n={params:t,signal:r};typeof c=="function"&&(n=c(n));const{data:h}=await y.get(v,n);let A=h.rows??[];return{total:h.total,rows:A}},a=x({queryKey:i,queryFn:f,staleTime:30*1e3,placeholderData:q,enabled:s(()=>d(l)!==null),...m}),P=s(()=>a.data.value?a.data.value.rows:[]),C=s(()=>a.data.value?a.data.value.total:0),g=s(()=>a.isFetching.value),p=F();return{query:a,rows:P,total:C,loading:g,setContext:w,refresh:async r=>{r&&(u.value=!0),await p.invalidateQueries({queryKey:o})},prefetch:async()=>{await p.prefetchQuery({queryKey:o,queryFn:f})}}}export{B as u};
