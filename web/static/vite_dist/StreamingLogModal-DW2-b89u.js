import{d as k,r as d,B as V,K as x,m as c,o as l,e as _,a as v,b as h,u as m,g as w,c as B,i as U,F as L,t as b,l as M}from"./vue-BsfewpWM.js";import{_ as T}from"./StreamingLogView-DMGIufU5.js";import{s as F,u as N,X as R}from"./layout-CUzOT8aY.js";import{u as S,_ as z}from"./useHasModal-Bq3QxExQ.js";import{_ as D}from"./Loading-CQdAiB8R.js";import{s as E}from"./index.es-DJGkFkUi.js";import{u as H}from"./theme-BQjAlSn5.js";const q={style:{height:"300px",resize:"vertical",overflow:"auto !important"}},A=k({__name:"FixedLogView",props:{logUrl:{}},setup(y,{expose:f}){const e=y,a=d(!1),o=d(""),{isDark:p}=F(H()),{axios:n}=N();return V(x(e,"logUrl"),i=>{a.value=!0,o.value="",i!==null&&(async()=>{try{const{data:t}=await n.request({method:"GET",url:e.logUrl});t.contents!==""&&(o.value=t.contents)}finally{a.value=!1}})()},{immediate:!0}),f({getContents:()=>o.value}),(i,t)=>(l(),c(D,{loading:a.value},{default:_(()=>[v("div",q,[h(m(E),{id:"log-view-contents",modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=g=>o.value=g),readonly:"",basic:"",dark:m(p)},null,8,["modelValue","dark"])])]),_:1},8,["loading"]))}}),P=k({__name:"StreamingLogModal",setup(y,{expose:f}){const e=d(""),a=d(!0),o=w("$modal"),{show:p,hide:n}=S(o),r=w("$logView"),i=(s,u=!0)=>{e.value=s,a.value=u,p()},t=R(),g=()=>{t.copy(r.value?.getContents()??"")},C=()=>{e.value=""};return f({show:i}),(s,u)=>(l(),c(z,{id:"logs_modal",ref_key:"$modal",ref:o,size:"xl",title:s.$gettext("Log Viewer"),"no-enforce-focus":"",onHidden:C},{"modal-footer":_(()=>[v("button",{class:"btn btn-secondary",type:"button",onClick:u[0]||(u[0]=(...$)=>m(n)&&m(n)(...$))},b(s.$gettext("Close")),1),v("button",{class:"btn btn-primary btn_copy",type:"button",onClick:M(g,["prevent"])},b(s.$gettext("Copy to Clipboard")),1)]),default:_(()=>[e.value?(l(),B(L,{key:0},[a.value?(l(),c(T,{key:0,ref_key:"$logView",ref:r,"log-url":e.value},null,8,["log-url"])):(l(),c(A,{key:1,ref_key:"$logView",ref:r,"log-url":e.value},null,8,["log-url"]))],64)):U("",!0)]),_:1},8,["title"]))}});export{P as _};
