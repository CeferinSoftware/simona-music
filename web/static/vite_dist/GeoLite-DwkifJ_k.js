import{d as x,r as f,q as w,h as M,m as G,o as d,e as c,a as e,b as h,t as o,u as s,f as u,c as y,l as L}from"./vue-BsfewpWM.js";import{_ as I}from"./FormGroupField-K9S4Sadl.js";import{g as V,u as C,a5 as D}from"./layout-CUzOT8aY.js";import{_ as P}from"./Loading-CQdAiB8R.js";import{_ as U}from"./CardPage-Cth3uewv.js";import{g as B}from"./useStationQuery-ClAZEJp_.js";import{u as R}from"./useResettableRef-BwkDrsai.js";import"./FormGroup-DXDHSoyc.js";import"./ValidationError-DsAp6Fjg.js";import"./leaflet-DkUWBo0d.js";import"./estoolkit-DCzBkaPJ.js";import"./hlsjs-BVyhFw5s.js";import"./bootstrap.esm-30QIU_ZL.js";import"./InfoCard-D5Q671bF.js";import"./icons-BAjd3tML.js";import"./vue-router-Cafqdr3I.js";const S={class:"card-body"},A={class:"row g-3"},K={class:"col-md-7"},N={class:"card-text"},T={class:"card-text"},$={href:"https://www.maxmind.com/en/geolite2/signup",target:"_blank"},q={class:"col-md-5"},F={class:"mb-3"},z={key:0,class:"text-success card-text"},E={key:1,class:"text-danger card-text"},Y={class:"buttons mt-3"},j={type:"submit",class:"btn btn-primary"},ue=x({__name:"GeoLite",setup(H){const m=B("/admin/geolite"),i=f(!0),l=f(null),{record:n}=R({key:null}),{$gettext:t}=V(),v=w(()=>t('GeoLite version "%{version}" is currently installed.',{version:l.value??"N/A"})),{axios:p}=C();M(async()=>{i.value=!0;const{data:a}=await p.get(m.value);n.value.key=a.key,l.value=a.version,i.value=!1});const _=async()=>{i.value=!0;try{const{data:a}=await p.post(m.value,{geolite_license_key:n.value.key});l.value=a.version}finally{i.value=!1}},{confirmDelete:g}=D(),b=async()=>{const{value:a}=await g({title:t("Remove GeoLite license key?"),confirmButtonText:t("Remove Key")});a&&(n.value.key=null,await _())};return(a,r)=>(d(),G(U,{"header-id":"hdr_install_geolite",title:s(t)("Install GeoLite IP Database")},{info:c(()=>[u(o(s(t)("IP Geolocation is used to guess the approximate location of your listeners based on the IP address they connect with. Use the free built-in IP Geolocation library or enter a license key on this page to use MaxMind GeoLite.")),1)]),default:c(()=>[e("div",S,[h(P,{loading:i.value},{default:c(()=>[e("div",A,[e("div",K,[e("fieldset",null,[e("legend",null,o(s(t)("Instructions")),1),e("p",N,o(s(t)("AzuraCast ships with a built-in free IP geolocation database. You may prefer to use the MaxMind GeoLite service instead to achieve more accurate results. Using MaxMind GeoLite requires a license key, but once the key is provided, we will automatically keep the database updated.")),1),e("p",T,o(s(t)("To download the GeoLite database:")),1),e("ul",null,[e("li",null,[u(o(s(t)("Create an account on the MaxMind developer site."))+" ",1),r[1]||(r[1]=e("br",null,null,-1)),e("a",$,o(s(t)("MaxMind Developer Site")),1)]),e("li",null,o(s(t)('Visit the "My License Key" page under the "Services" section.')),1),e("li",null,o(s(t)('Click "Generate new license key".')),1),e("li",null,o(s(t)("Paste the generated license key into the field on this page.")),1)])])]),e("div",q,[e("fieldset",F,[e("legend",null,o(s(t)("Current Installed Version")),1),l.value?(d(),y("p",z,o(v.value),1)):(d(),y("p",E,o(s(t)("GeoLite is not currently installed on this installation.")),1))]),e("form",{onSubmit:L(_,["prevent"])},[e("fieldset",null,[h(I,{id:"edit_form_key",modelValue:s(n).key,"onUpdate:modelValue":r[0]||(r[0]=k=>s(n).key=k)},{label:c(()=>[u(o(s(t)("MaxMind License Key")),1)]),_:1},8,["modelValue"])]),e("div",Y,[e("button",j,o(s(t)("Save Changes")),1),e("button",{type:"button",class:"btn btn-danger",onClick:b},o(s(t)("Remove Key")),1)])],32)])])]),_:1},8,["loading"])])]),_:1},8,["title"]))}});export{ue as default};
