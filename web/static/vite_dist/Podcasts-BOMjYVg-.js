import{_ as Z}from"./DataTable-BhAO7RbG.js";import{_ as $}from"./FormGroupField-K9S4Sadl.js";import{_ as I}from"./FormGroupSelect-Cp69W3Gu.js";import{_ as N,a as ee}from"./Tabs-DMTPhsiO.js";import{_ as G}from"./FormGroupCheckbox-ZsJmXmB6.js";import{d as te,s as U,g as H,u as J,a8 as se}from"./layout-CUzOT8aY.js";import{u as K}from"./useFormTabClass-DgI07GN4.js";import{u as oe,r as k}from"./regle-hGsoY2W9.js";import{u as j}from"./useResettableRef-BwkDrsai.js";import{d as x,q,m as S,o as _,u as e,e as d,a as r,b as s,r as ae,G as ie,h as le,w as re,v as ne,t as c,f as L,g as F,K as de,j as ce,c as O,i as E}from"./vue-BsfewpWM.js";import{_ as pe}from"./FormGroupMultiCheck-z3kTFzdV.js";import{e as w,a as ue,q as Q,Q as W}from"./useStationQuery-ClAZEJp_.js";import{_ as X}from"./Loading-CQdAiB8R.js";import{_ as me}from"./CodemirrorTextarea-gPAxNt7r.js";import{_ as _e}from"./Artwork-B93hLgPN.js";import{m as z}from"./mergeExisting-B6FvxI3v.js";import{u as fe}from"./useBaseEditModal-D4NDXa4y.js";import{_ as ge}from"./ModalForm-D0z4l5nm.js";import{A as be}from"./AlbumArt-CcCTgtsV.js";import{_ as he}from"./Quota-6Uls-2Ar.js";import{u as ye,_ as $e}from"./AddButton-DLx8r-7e.js";import{_ as ve}from"./CardPage-Cth3uewv.js";import{u as Pe}from"./useConfirmAndDelete-CuQodV6V.js";import{u as ke}from"./useApiItemProvider-DAIhDonu.js";import"./icons-BAjd3tML.js";import"./FormMultiCheck-RiRcopXY.js";import"./map-Caxea7Kw.js";import"./estoolkit-DCzBkaPJ.js";import"./isArrayLike-DknTMkCU.js";import"./iteratee-DJRL6CbS.js";import"./FormCheckbox-Cc7beVle.js";import"./isTypedArray-By1PpNM0.js";import"./some-B0KiPFWm.js";import"./forEach-BFcv9GyE.js";import"./FormGroup-DXDHSoyc.js";import"./ValidationError-DsAp6Fjg.js";import"./leaflet-DkUWBo0d.js";import"./hlsjs-BVyhFw5s.js";import"./bootstrap.esm-30QIU_ZL.js";import"./zxcvbn-Bgw4VUEj.js";import"./useSlotsExcept-Dp0PSXNw.js";import"./vue-router-Cafqdr3I.js";import"./index.es-DJGkFkUi.js";import"./theme-BQjAlSn5.js";import"./FormFile-B5B3WV6y.js";import"./InvisibleSubmitButton-NGv_v7G8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useHasModal-Bq3QxExQ.js";import"./lightbox-B9nVyWr-.js";import"./InfoCard-D5Q671bF.js";const M=te("form-stations-podcasts",()=>{const{record:g,reset:a}=j({has_custom_art:!1,art:"",links:{art:""}}),{record:p,reset:t}=j({title:"",link:"",description:"",language:"en",author:"",email:"",categories:[],is_enabled:!0,branding_config:{public_custom_html:"",enable_op3_prefix:!1},source:"manual",playlist_id:null,playlist_auto_publish:!0,artwork_file:null}),{r$:n}=oe(p,{title:{required:k},description:{required:k},language:{required:k},categories:{required:k,$each:{}},source:{required:k}},{validationGroups:o=>({basicInfoTab:[o.title,o.link,o.description,o.language,o.author,o.email,o.categories,o.is_enabled],brandingTab:[o.branding_config.public_custom_html,o.branding_config.enable_op3_prefix],sourceTab:[o.source,o.playlist_id,o.playlist_auto_publish]})});return{record:g,form:p,r$:n,$reset:()=>{t(),a(),n.$reset()}}}),we={class:"row g-3"},xe=x({__name:"BasicInfo",props:{languageOptions:{},categoriesOptions:{}},setup(g){const{r$:a}=U(M()),p=K(q(()=>a.value.$groups.basicInfoTab));return(t,n)=>(_(),S(N,{label:t.$gettext("Basic Information"),"item-header-class":e(p)},{default:d(()=>[r("div",we,[s($,{id:"form_edit_title",class:"col-md-6",field:e(a).title,label:t.$gettext("Podcast Title")},null,8,["field","label"]),s($,{id:"form_edit_link",class:"col-md-6",field:e(a).link,label:t.$gettext("Website"),description:t.$gettext("Typically the home page of a podcast.")},null,8,["field","label","description"]),s($,{id:"form_edit_description",class:"col-md-12",field:e(a).description,"input-type":"textarea",label:t.$gettext("Description"),description:t.$gettext("The description of your podcast. The typical maximum amount of text allowed for this is 4000 characters.")},null,8,["field","label","description"]),s(I,{id:"form_edit_language",class:"col-md-12",field:e(a).language,options:t.languageOptions,label:t.$gettext("Language"),description:t.$gettext("The language spoken on the podcast.")},null,8,["field","options","label","description"]),s($,{id:"form_edit_author",class:"col-md-6",field:e(a).author,label:t.$gettext("Author"),description:t.$gettext("The contact person of the podcast. May be required in order to list the podcast on services like Apple Podcasts, Spotify, Google Podcasts, etc.")},null,8,["field","label","description"]),s($,{id:"form_edit_email",class:"col-md-6",field:e(a).email,"input-type":"email",label:t.$gettext("E-Mail"),description:t.$gettext("The email of the podcast contact. May be required in order to list the podcast on services like Apple Podcasts, Spotify, Google Podcasts, etc.")},null,8,["field","label","description"]),s(I,{id:"form_edit_categories",class:"col-md-12",field:e(a).categories,options:t.categoriesOptions,multiple:"",label:t.$gettext("Categories"),description:t.$gettext("Select the category/categories that best reflects the content of your podcast.")},null,8,["field","options","label","description"]),s(G,{id:"edit_form_is_enabled",class:"col-md-12",field:e(a).is_enabled,label:t.$gettext("Enable on Public Pages"),description:t.$gettext("If disabled, the station will not be visible on public-facing pages or APIs.")},null,8,["field","label","description"])])]),_:1},8,["label","item-header-class"]))}}),Se={class:"row g-3"},Ae={class:"card mb-3",role:"region"},Te={class:"card-header text-bg-primary"},Ce={class:"card-title"},Oe={class:"card-body"},Ee={class:"row g-3 mb-3"},Ue=x({__name:"Source",setup(g){const{r$:a,form:p}=U(M()),t=K(q(()=>a.value.$groups.sourceTab)),{$gettext:n}=H(),m=[{value:"manual",text:n("Manually Add Episodes"),description:n("Create podcast episodes independent of your station's media collection.")},{value:"playlist",text:n("Synchronize with Playlist"),description:n("Automatically create new podcast episodes when media is added to a specified playlist.")}],o=ae(!0),u=ie([]),{axios:l}=J(),f=w("/podcasts/playlists");return le(async()=>{try{const{data:h}=await l.get(f.value);u.value=h}finally{o.value=!1}}),(h,P)=>(_(),S(N,{label:e(n)("Source"),"item-header-class":e(t)},{default:d(()=>[r("div",Se,[s(pe,{id:"edit_form_source",class:"col-md-12",field:e(a).source,options:m,stacked:"",radio:"",label:e(n)("Source")},null,8,["field","label"])]),re(r("section",Ae,[r("div",Te,[r("h2",Ce,c(e(n)("Playlist-Based Podcast")),1)]),r("div",Oe,[r("p",null,c(e(n)("Playlist-based podcasts will automatically sync with the contents of a playlist, creating new podcast episodes for any media added to the playlist.")),1),s(X,{loading:o.value},{default:d(()=>[r("div",Ee,[s(I,{id:"form_edit_playlist_id",class:"col-md-12",field:e(a).playlist_id,options:u.value,label:e(n)("Select Playlist")},null,8,["field","options","label"]),s(G,{id:"form_edit_playlist_auto_publish",class:"col-md-12",field:e(a).playlist_auto_publish,label:e(n)("Automatically Publish New Episodes"),description:e(n)("Whether new episodes should be marked as published or held for review as unpublished.")},null,8,["field","label","description"])])]),_:1},8,["loading"])])],512),[[ne,e(p).source==="playlist"]])]),_:1},8,["label","item-header-class"]))}}),qe={class:"row g-3"},Me={href:"https://op3.dev/",target:"_blank"},Re=x({__name:"Branding",setup(g){const{r$:a}=U(M()),p=K(q(()=>a.value.$groups.brandingTab));return(t,n)=>(_(),S(N,{label:t.$gettext("Branding"),"item-header-class":e(p)},{default:d(()=>[r("div",qe,[s(G,{id:"edit_form_enable_op3_prefix",class:"col-md-12",field:e(a).branding_config.enable_op3_prefix,label:t.$gettext("Enable Open Podcast Prefix Project (OP3) Analytics Support")},{description:d(()=>[L(c(t.$gettext("Enable to prefix all podcast episode URLs with the OP3 analytics URL, allowing you to view statistics about your podcast audience via the OP3 service."))+" ",1),r("a",Me,c(t.$gettext("Open Podcast Prefix Project (OP3)")),1)]),_:1},8,["field","label"]),s($,{id:"edit_form_public_custom_html",class:"col-md-12",field:e(a).branding_config.public_custom_html,label:t.$gettext("Custom HTML for Public Pages")},{default:d(({id:m,model:o})=>[s(me,{id:m,modelValue:o.$model,"onUpdate:modelValue":u=>o.$model=u,mode:"html"},null,8,["id","modelValue","onUpdate:modelValue"])]),_:1},8,["field","label"])])]),_:1},8,["label","item-header-class"]))}}),Be=x({__name:"PodcastEditModal",props:{languageOptions:{},categoriesOptions:{},newArtUrl:{},createUrl:{}},emits:["relist"],setup(g,{expose:a,emit:p}){const t=g,n=p,m=F("$modal"),o=M(),{form:u,record:l,r$:f}=U(o),{$reset:v}=o,{loading:h,error:P,isEditMode:A,clearContents:T,create:R,edit:B,doSubmit:V,close:C}=fe(de(t,"createUrl"),n,m,v,i=>{l.value=z(l.value,i),f.value.$reset({toState:z(f.value.$value,{...i,categories:i.categories?.map(y=>y.category)??[]})})},async()=>{const{valid:i}=await f.value.$validate();return{valid:i,data:u.value}}),{$gettext:b}=H(),D=q(()=>A.value?b("Edit Podcast"):b("Add Podcast"));return a({create:R,edit:B,close:C}),(i,y)=>(_(),S(ge,{ref_key:"$modal",ref:m,loading:e(h),title:D.value,error:e(P),"disable-save-button":e(f).$invalid,onSubmit:e(V),onHidden:e(T)},{default:d(()=>[s(ee,null,{default:d(()=>[s(xe,{"categories-options":i.categoriesOptions,"language-options":i.languageOptions},null,8,["categories-options","language-options"]),s(Ue),s(_e,{modelValue:e(u).artwork_file,"onUpdate:modelValue":y[0]||(y[0]=Y=>e(u).artwork_file=Y),"artwork-src":e(l).links.art,"new-art-url":i.newArtUrl},null,8,["modelValue","artwork-src","new-art-url"]),s(Re)]),_:1})]),_:1},8,["loading","title","error","disable-save-button","onSubmit","onHidden"]))}}),Ve={class:"row align-items-center"},De={class:"col-md-7"},Ie={class:"card-title"},Le={class:"col-md-5 text-end"},Fe={class:"m-0"},Ne={key:0},Ge=["href"],He=["href"],Ke={class:"badges"},je={key:0,class:"badge text-bg-info"},Qe={key:1,class:"badge text-bg-info"},We={key:2,class:"badge text-bg-danger"},ze={class:"btn-group btn-group-sm"},Je=["onClick"],Xe=["onClick"],Wt=x({__name:"Podcasts",setup(g){const a=w(`/quota/${se.StationPodcasts}`),p=w("/podcasts"),t=w("/podcasts/art"),n=w("/vue/podcasts"),{axios:m}=J(),{data:o,isLoading:u}=ue({queryKey:Q([W.StationPodcasts,"props"]),queryFn:async({signal:C})=>{const{data:b}=await m.get(n.value,{signal:C});return b}}),{$gettext:l}=H(),f=[{key:"art",label:l("Art"),sortable:!1,class:"shrink pe-0"},{key:"title",label:l("Podcast"),sortable:!1},{key:"episodes",label:l("# Episodes"),sortable:!1},{key:"actions",label:l("Actions"),sortable:!1,class:"shrink"}],v=ke(p,Q([W.StationPodcasts,"data"])),{refresh:h}=v,P=F("$quota"),A=()=>{P.value?.update(),h()},T=F("$editPodcastModal"),{doCreate:R,doEdit:B}=ye(T),{doDelete:V}=Pe(l("Delete Podcast?"),()=>A());return(C,b)=>{const D=ce("router-link");return _(),S(X,{loading:e(u),lazy:""},{default:d(()=>[s(ve,null,{header:d(()=>[r("div",Ve,[r("div",De,[r("h2",Ie,c(e(l)("Podcasts")),1)]),r("div",Le,[s(he,{ref_key:"$quota",ref:P,"quota-url":e(a)},null,8,["quota-url"])])])]),actions:d(()=>[s($e,{text:e(l)("Add Podcast"),onClick:e(R)},null,8,["text","onClick"])]),default:d(()=>[s(Z,{id:"station_podcasts",ref:"$dataTable",paginated:"",fields:f,provider:e(v)},{"cell(art)":d(({item:i})=>[s(be,{src:i.art},null,8,["src"])]),"cell(title)":d(({item:i})=>[r("h5",Fe,c(i.title),1),i.is_published&&i.is_enabled?(_(),O("div",Ne,[r("a",{href:i.links.public_episodes,target:"_blank"},c(e(l)("Public Page")),9,Ge),b[0]||(b[0]=L(" • ",-1)),r("a",{href:i.links.public_feed,target:"_blank"},c(e(l)("RSS Feed")),9,He)])):E("",!0),r("div",Ke,[i.source==="playlist"?(_(),O("span",je,c(e(l)("Playlist-Based")),1)):E("",!0),i.is_published?E("",!0):(_(),O("span",Qe,c(e(l)("Unpublished")),1)),i.is_enabled?E("",!0):(_(),O("span",We,c(e(l)("Disabled")),1))])]),"cell(actions)":d(({item:i})=>[r("div",ze,[r("button",{type:"button",class:"btn btn-primary",onClick:y=>e(B)(i.links.self)},c(e(l)("Edit")),9,Je),r("button",{type:"button",class:"btn btn-danger",onClick:y=>e(V)(i.links.self)},c(e(l)("Delete")),9,Xe),s(D,{class:"btn btn-secondary",to:{name:"stations:podcast:episodes",params:{podcast_id:i.id}}},{default:d(()=>[L(c(e(l)("Episodes")),1)]),_:1},8,["to"])])]),_:1},8,["provider"])]),_:1}),s(Be,{ref_key:"$editPodcastModal",ref:T,"create-url":e(p),"new-art-url":e(t),"language-options":e(o).languageOptions,"categories-options":e(o).categoriesOptions,onRelist:A},null,8,["create-url","new-art-url","language-options","categories-options"])]),_:1},8,["loading"])}}});export{Wt as default};
