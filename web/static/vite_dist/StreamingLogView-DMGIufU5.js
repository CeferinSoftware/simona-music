import{u as g,Y as _}from"./layout-CUzOT8aY.js";import{_ as x}from"./Loading-CQdAiB8R.js";import{_ as y}from"./FormGroupCheckbox-ZsJmXmB6.js";import{d as w,r as a,g as B,B as V,K as $,m as h,o as k,e as T,b,a as C,n as L}from"./vue-BsfewpWM.js";const S=["value"],q=w({__name:"StreamingLogView",props:{logUrl:{}},setup(v,{expose:d}){const u=v,l=a(!1),t=a(""),s=a(null),n=a(!0),{axiosSilent:f}=g(),o=B("$textarea");let r=null;const i=()=>{r&&clearInterval(r)};_(i);const c=async()=>{try{const{data:e}=await f.request({method:"GET",url:u.logUrl,params:{position:s.value}});e.contents!==""&&(t.value=t.value+e.contents+`
`,n.value&&o.value&&L(()=>{o.value.scrollTop=o.value?.scrollHeight??0})),s.value=e.position,e.eof&&i()}finally{l.value=!1}};return V($(u,"logUrl"),e=>{l.value=!0,t.value="",s.value=0,i(),e!==""&&(r=setInterval(()=>void c(),2500),c())},{immediate:!0}),d({getContents:()=>t.value}),(e,m)=>(k(),h(x,{loading:l.value},{default:T(()=>[b(y,{id:"modal_scroll_to_bottom",modelValue:n.value,"onUpdate:modelValue":m[0]||(m[0]=p=>n.value=p),label:e.$gettext("Automatically Scroll to Bottom")},null,8,["modelValue","label"]),C("textarea",{id:"log-view-contents",ref_key:"$textarea",ref:o,class:"form-control log-viewer",spellcheck:"false",readonly:"",value:t.value},null,8,S)]),_:1},8,["loading"]))}});export{q as _};
