import{_ as R}from"./DataTable-BhAO7RbG.js";import{A as B}from"./AlbumArt-CcCTgtsV.js";import{g as N,f as w,u as C}from"./layout-CUzOT8aY.js";import{u as L}from"./useApiItemProvider-DAIhDonu.js";import{Q as P}from"./useStationQuery-ClAZEJp_.js";import{f as T}from"./forEach-BFcv9GyE.js";import{d as p,q as $,m as f,o as c,e as b,a as r,t as u,u as d,i as V,f as E,c as F,b as S,L as U,M as D}from"./vue-BsfewpWM.js";const I={class:"d-flex align-items-center"},Q={class:"flex-fill"},z=["onClick"],G=p({__name:"RequestsDataTable",props:{requestListUri:{},showAlbumArt:{type:Boolean},customFields:{}},emits:["submitted"],setup(o,{emit:i}){const n=o,m=i,{$gettext:l}=N(),_=$(()=>{const t=[{key:"name",isRowHeader:!0,label:l("Name"),sortable:!1,selectable:!0},{key:"title",label:l("Title"),sortable:!0,selectable:!0,visible:!1,formatter:(e,s,a)=>a.song.title},{key:"artist",label:l("Artist"),sortable:!0,selectable:!0,visible:!1,formatter:(e,s,a)=>a.song.artist},{key:"album",label:l("Album"),sortable:!0,selectable:!0,visible:!1,formatter:(e,s,a)=>a.song.album},{key:"genre",label:l("Genre"),sortable:!0,selectable:!0,visible:!1,formatter:(e,s,a)=>a.song.genre}];return T({...n.customFields},e=>{t.push({key:"custom_field_"+e.id,label:e.name,sortable:!1,selectable:!0,visible:!1,formatter:(s,a,x)=>x.song.custom_fields[e.short_name]})}),t.push({key:"actions",label:l("Actions"),class:"shrink",sortable:!1}),t}),y=L(n.requestListUri,[P.PublicRequests],{staleTime:60*1e3}),v=[10,25],{notifySuccess:g,notifyError:k}=w(),{axios:h}=C(),A=async t=>{try{const{data:e}=await h.post(t);e.success?g(e.message):k(e.message)}finally{m("submitted")}},q=t=>void A(t);return(t,e)=>(c(),f(R,{id:"public_requests",paginated:"","select-fields":"","page-options":v,fields:_.value,provider:d(y)},{"cell(name)":b(s=>[r("div",I,[t.showAlbumArt?(c(),f(B,{key:0,src:s.item.song.art,width:40,class:"flex-shrink-1 pe-3"},null,8,["src"])):V("",!0),r("div",Q,[E(u(s.item.song.title),1),e[0]||(e[0]=r("br",null,null,-1)),r("small",null,u(s.item.song.artist),1)])])]),"cell(actions)":b(s=>[r("button",{type:"button",class:"btn btn-sm btn-primary",onClick:a=>q(s.item.request_url)},u(d(l)("Request")),9,z)]),_:1},8,["fields","provider"]))}}),H={class:"container-fluid"},Y=p({inheritAttrs:!1,__name:"Requests",props:{requestListUri:{},showAlbumArt:{type:Boolean,default:!0},customFields:{default:()=>[]}},setup(o){const i=o;return(n,m)=>(c(),F("div",H,[S(G,U(D(i)),null,16)]))}});export{Y as _};
