import{c as C}from"./estoolkit-DCzBkaPJ.js";function N(){let s=null;const u=e=>{if(s){const t=new Error(e);t.name="AbortError",s.abort(t)}return s=new AbortController,s.signal},b=()=>{if(s){const e=new Error("Operation cancelled.");e.name="AbortError",s.abort(e)}},d=e=>{const t="=?BINARY?B?";if(typeof e=="object")for(const r in e)if(typeof e[r]=="string"){let n=e[r];if(n.substring(0,t.length)===t&&n.substring(n.length-2)==="?="){n=n.substring(t.length,n.length-2);const i=window.atob(n),l=i.length,p=new Uint8Array(l);for(let c=0;c<l;c++)p[c]=i.charCodeAt(c);e[r]=p.buffer}}else d(e[r])},a=e=>{let t="";const o=new Uint8Array(e),r=o.byteLength;for(let n=0;n<r;n++)t+=String.fromCharCode(o[n]);return window.btoa(t)},f=window?.PublicKeyCredential!==void 0&&typeof window.PublicKeyCredential=="function",w=async()=>!f||!window.PublicKeyCredential||!PublicKeyCredential.isConditionalMediationAvailable?!1:await PublicKeyCredential.isConditionalMediationAvailable(),g=e=>{const t=C(e);return d(t),t},y=e=>{const t=e.response;return{transports:t.getTransports?t.getTransports():null,clientDataJSON:t.clientDataJSON?a(t.clientDataJSON):null,attestationObject:t.attestationObject?a(t.attestationObject):null}},A=async e=>{const t=g(e),o=u("New registration started."),r={...t,signal:o},n=await navigator.credentials.create(r);return y(n)},h=e=>{const t=e.response;return{id:e.rawId?a(e.rawId):null,clientDataJSON:t.clientDataJSON?a(t.clientDataJSON):null,authenticatorData:t.authenticatorData?a(t.authenticatorData):null,signature:t.signature?a(t.signature):null,userHandle:t.userHandle?a(t.userHandle):null}};return{isSupported:f,isConditionalSupported:w,doValidate:async(e,t=!1)=>{const o=g(e),r=t?{mediation:"conditional"}:{},n=u("New validation started."),i={...o,...r,signal:n},l=await navigator.credentials.get(i);return h(l)},doRegister:A,cancel:b}}export{N as u};
