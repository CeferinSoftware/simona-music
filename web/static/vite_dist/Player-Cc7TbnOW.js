import{d as $,K as C,q as v,r as L,n as R,h as U,B as z,c as n,o as i,a as t,i as c,u as e,b as h,f as x,t as r,E as F,F as q,D as I,w as K,y as O,z as j}from"./vue-BsfewpWM.js";import{_ as G}from"./PlayButton-Dbj4ENWk.js";import{m as J,s as Q,g as W,n as X,o as Y}from"./layout-CUzOT8aY.js";import{u as Z}from"./useNowPlaying-M_Wycmtp.js";import{_ as tt}from"./MuteButton-DdyYYuLG.js";import{A as et}from"./AlbumArt-CcCTgtsV.js";const st={class:"radio-player-widget"},ot={class:"now-playing-details"},lt={key:0,class:"now-playing-art"},at={class:"now-playing-main"},nt={key:0,class:"now-playing-live"},it={class:"badge text-bg-primary me-2"},rt={key:1},ut={class:"now-playing-title text-muted"},ct={key:2},dt={class:"now-playing-title"},pt={class:"now-playing-artist"},mt={key:3},_t={class:"now-playing-title"},yt={key:4,class:"time-display"},vt={class:"time-display-played text-secondary"},ht={class:"time-display-progress"},gt={class:"progress h-5"},ft={class:"time-display-total text-secondary"},wt={class:"radio-controls"},bt={class:"radio-control-select-stream"},kt={key:0,class:"dropdown"},xt={id:"btn-select-stream",class:"btn btn-sm btn-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},St={class:"dropdown-menu","aria-labelledby":"btn-select-stream"},Pt=["onClick"],Tt={key:0,class:"radio-control-volume d-flex align-items-center"},Et={class:"flex-shrink-0 mx-2"},At={class:"flex-fill radio-control-volume-slider"},Vt=["title"],Lt=$({inheritAttrs:!1,__name:"Player",props:{nowPlayingProps:{},offlineText:{},showHls:{type:Boolean,default:!0},showAlbumArt:{type:Boolean,default:!0},autoplay:{type:Boolean,default:!0}},emits:["np_updated"],setup(S,{emit:P}){const m=S,T=P,{np:l,currentTrackPercent:E,currentTrackDurationDisplay:A,currentTrackElapsedDisplay:g}=Z(C(m,"nowPlayingProps")),f=J(),{volume:d,showVolume:V,isMuted:D}=Q(f),{setVolume:N,toggleMute:B,toggle:w}=f,b=v(()=>m.showHls&&l.value?.station?.hls_enabled),H=v(()=>b.value&&l.value?.station?.hls_is_default),{$gettext:p}=W(),u=L(Y),_=v(()=>{const o=[];return b.value&&o.push({title:p("HLS"),url:l.value?.station?.hls_url,isStream:!0,isHls:!0}),l.value?.station?.mounts?.forEach(function(s){o.push({title:s.name??s.url,url:s.url,isStream:!0,isHls:!1})}),l.value?.station?.remotes?.forEach(function(s){o.push({title:s.name??s.url,url:s.url,isStream:!0,isHls:!1})}),o}),M=o=>{u.value=o,w(o)},k=new URL(document.location.href).searchParams.get("volume");if(k!==null&&N(Number(k)),m.autoplay){const o=X(document,"now-playing",()=>{R(()=>{w(u.value),o()})})}return U(()=>{document.dispatchEvent(new CustomEvent("player-ready"))}),z(l,o=>{T("np_updated",o);const s=_.value;let a=u.value;a.url===null&&s.length>0&&(H.value?u.value=s[0]:(a=null,o.station?.listen_url&&s.forEach(function(y){y.url===o.station?.listen_url&&(a=y)}),a===null&&(a=s[0]),u.value=a))},{immediate:!0}),(o,s)=>(i(),n("div",st,[t("div",ot,[o.showAlbumArt&&e(l).now_playing?.song?.art?(i(),n("div",lt,[h(et,{src:e(l).now_playing.song.art},null,8,["src"])])):c("",!0),t("div",at,[e(l).live?.is_live?(i(),n("h6",nt,[t("span",it,r(e(p)("Live")),1),x(" "+r(e(l).live.streamer_name),1)])):c("",!0),e(l).is_online?e(l).now_playing?.song?.title?(i(),n("div",ct,[t("h4",dt,r(e(l).now_playing.song.title),1),t("h5",pt,r(e(l).now_playing.song.artist),1)])):(i(),n("div",mt,[t("h4",_t,r(e(l).now_playing?.song?.text),1)])):(i(),n("div",rt,[t("h4",ut,r(o.offlineText??e(p)("Station Offline")),1)])),e(g)!=null?(i(),n("div",yt,[t("div",vt,r(e(g)),1),t("div",ht,[t("div",gt,[t("div",{class:"progress-bar bg-secondary",role:"progressbar",style:F({width:e(E)+"%"})},null,4)])]),t("div",ft,r(e(A)),1)])):c("",!0)])]),s[2]||(s[2]=t("hr",{class:"my-2"},null,-1)),t("div",wt,[h(G,{class:"radio-control-play-button btn-xl",stream:u.value},null,8,["stream"]),t("div",bt,[_.value.length>1?(i(),n("div",kt,[t("button",xt,[x(r(u.value.title)+" ",1),s[1]||(s[1]=t("span",{class:"caret"},null,-1))]),t("ul",St,[(i(!0),n(q,null,I(_.value,a=>(i(),n("li",{key:a.url??a.title??"Stream"},[t("button",{type:"button",class:"dropdown-item",onClick:y=>M(a)},r(a.title),9,Pt)]))),128))])])):c("",!0)]),e(V)?(i(),n("div",Tt,[t("div",Et,[h(tt,{class:"p-0 text-secondary",volume:e(d),"is-muted":e(D),onToggleMute:e(B)},null,8,["volume","is-muted","onToggleMute"])]),t("div",At,[K(t("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>j(d)?d.value=a:null),type:"range",title:e(p)("Volume"),class:"form-range",min:"0",max:"100",step:"1"},null,8,Vt),[[O,e(d),void 0,{number:!0}]])])])):c("",!0)])]))}});export{Lt as _};
