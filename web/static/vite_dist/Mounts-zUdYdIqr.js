import{_ as ot}from"./DataTable-BhAO7RbG.js";import{_ as g}from"./FormGroupField-K9S4Sadl.js";import{_ as C}from"./FormGroupCheckbox-ZsJmXmB6.js";import{_ as D,a as at}from"./Tabs-DMTPhsiO.js";import{d as st,N as M,s as F,L as R,ab as H,u as it,f as nt,g as J}from"./layout-CUzOT8aY.js";import{u as E}from"./useFormTabClass-DgI07GN4.js";import{u as lt,r as B}from"./regle-hGsoY2W9.js";import{u as rt}from"./useResettableRef-BwkDrsai.js";import{r as dt,d as U,q as y,m as w,o as u,u as t,e as l,a as c,b as i,i as A,f as I,t as d,c as $,s as ut,af as mt,A as ct,K as Y,g as q,F as P}from"./vue-BsfewpWM.js";import{_ as pt}from"./FormGroupMultiCheck-z3kTFzdV.js";import{_ as _t}from"./BitrateOptions-CGWdTyiI.js";import{c as z,e as O,q as ft,Q as bt}from"./useStationQuery-ClAZEJp_.js";import{_ as ht}from"./FlowUpload-BbQl79KV.js";import{_ as gt}from"./FormGroup-DXDHSoyc.js";import{_ as $t}from"./FormMarkup-DqBjuQjX.js";import{m as G}from"./mergeExisting-B6FvxI3v.js";import{u as yt}from"./useBaseEditModal-D4NDXa4y.js";import{_ as vt}from"./ModalForm-D0z4l5nm.js";import{u as kt}from"./useMayNeedRestart-CTqbUxcB.js";import{s as wt}from"./showFormatAndBitrate-A6eyA-Ye.js";import{u as It,_ as xt}from"./AddButton-DLx8r-7e.js";import{u as Mt}from"./useConfirmAndDelete-CuQodV6V.js";import{_ as At}from"./CardPage-Cth3uewv.js";import{u as St}from"./useApiItemProvider-DAIhDonu.js";import"./icons-BAjd3tML.js";import"./FormMultiCheck-RiRcopXY.js";import"./map-Caxea7Kw.js";import"./estoolkit-DCzBkaPJ.js";import"./isArrayLike-DknTMkCU.js";import"./iteratee-DJRL6CbS.js";import"./FormCheckbox-Cc7beVle.js";import"./isTypedArray-By1PpNM0.js";import"./some-B0KiPFWm.js";import"./forEach-BFcv9GyE.js";import"./ValidationError-DsAp6Fjg.js";import"./leaflet-DkUWBo0d.js";import"./hlsjs-BVyhFw5s.js";import"./bootstrap.esm-30QIU_ZL.js";import"./zxcvbn-Bgw4VUEj.js";import"./useSlotsExcept-Dp0PSXNw.js";import"./RadioWithCustomNumber-B3JRVqX_.js";import"./find-B-AZI_Kz.js";import"./vue-router-Cafqdr3I.js";import"./formatFileSize--9DaIXge.js";import"./defaultsDeep-B9v54JJt.js";import"./InvisibleSubmitButton-NGv_v7G8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useHasModal-Bq3QxExQ.js";import"./Loading-CQdAiB8R.js";import"./InfoCard-D5Q671bF.js";const T=st("form-stations-mounts",()=>{const{record:p,reset:n}=rt({intro_path:null,links:{intro:""}}),s=dt({name:"",display_name:"",is_visible_on_public_pages:!0,is_default:!1,relay_url:null,is_public:!0,max_listener_duration:0,authhash:null,fallback_mount:"/error.mp3",intro_file:null,enable_autodj:!0,autodj_format:M.Mp3,autodj_bitrate:128,custom_listen_url:null,frontend_config:null}),{r$:e}=lt(s,{name:{required:B},max_listener_duration:{required:B}},{validationGroups:a=>({basicInfoTab:[a.name,a.display_name,a.is_visible_on_public_pages,a.is_default,a.relay_url,a.is_public,a.max_listener_duration,a.authhash,a.fallback_mount],autoDjTab:[a.enable_autodj,a.autodj_format,a.autodj_bitrate],advancedTab:[a.custom_listen_url,a.frontend_config]})});return{form:s,record:p,r$:e,$reset:()=>{n(),e.$reset({toOriginalState:!0})}}}),Ut={class:"row g-3 mb-3"},Ct={href:"https://radiomanager.shoutcast.com/",target:"_blank"},Dt=U({__name:"BasicInfo",props:{stationFrontendType:{}},setup(p){const n=p,{r$:s}=F(T()),e=E(y(()=>s.value.$groups.basicInfoTab)),m=y(()=>R.Icecast===n.stationFrontendType),a=y(()=>R.Shoutcast===n.stationFrontendType);return(o,_)=>(u(),w(D,{label:o.$gettext("Basic Info"),"item-header-class":t(e)},{default:l(()=>[c("div",Ut,[i(g,{id:"edit_form_name",class:"col-md-6",field:t(s).name,label:o.$gettext("Mount Point URL"),description:o.$gettext("This name should always begin with a slash (/), and must be a valid URL, such as /autodj.mp3")},null,8,["field","label","description"]),i(g,{id:"edit_form_display_name",class:"col-md-6",field:t(s).display_name,label:o.$gettext("Display Name"),description:o.$gettext("The display name assigned to this mount point when viewing it on administrative or public pages. Leave blank to automatically generate one.")},null,8,["field","label","description"]),i(C,{id:"edit_form_is_visible_on_public_pages",class:"col-md-6",field:t(s).is_visible_on_public_pages,label:o.$gettext("Show on Public Pages"),description:o.$gettext("Enable to allow listeners to select and play from this mount point on this station's public pages, including embedded widgets.")},null,8,["field","label","description"]),i(C,{id:"edit_form_is_default",class:"col-md-6",field:t(s).is_default,label:o.$gettext("Set as Default Mount Point"),description:o.$gettext("If this mount is the default, it will be played on the radio preview and the public radio page in this system.")},null,8,["field","label","description"]),i(g,{id:"edit_form_relay_url",class:"col-md-6",field:t(s).relay_url,label:o.$gettext("Relay Stream URL"),description:o.$gettext("Enter the full URL of another stream to relay its broadcast through this mount point.")},null,8,["field","label","description"]),i(C,{id:"edit_form_is_public",class:"col-md-6",field:t(s).is_public},{label:l(()=>[I(d(o.$gettext('Publish to "Yellow Pages" Directories')),1)]),description:l(()=>[I(d(o.$gettext('Enable to advertise this mount point on "Yellow Pages" public radio directories.')),1)]),_:1},8,["field"]),i(g,{id:"edit_form_max_listener_duration",class:"col-md-6",field:t(s).max_listener_duration,"input-type":"number","input-attrs":{min:"0",max:"2147483647"},label:o.$gettext("Max Listener Duration"),description:o.$gettext("Set the length of time (seconds) a listener will stay connected to the stream. If set to 0, listeners can stay connected infinitely.")},null,8,["field","label","description"]),a.value?(u(),w(g,{key:0,id:"edit_form_authhash",class:"col-md-6",field:t(s).authhash,label:o.$gettext("YP Directory Authorization Hash")},{description:l(()=>[I(d(o.$gettext("If your stream is set to advertise to YP directories above, you must specify an authorization hash. You can manage these on the Shoutcast web site."))+" ",1),_[0]||(_[0]=c("br",null,null,-1)),c("a",Ct,d(o.$gettext("Shoutcast Radio Manager")),1)]),_:1},8,["field","label"])):A("",!0),m.value?(u(),w(g,{key:1,id:"edit_form_fallback_mount",class:"col-md-6",field:t(s).fallback_mount,label:o.$gettext("Fallback Mount"),description:o.$gettext("If this mount point is not playing audio, listeners will automatically be redirected to this mount point. The default is /error.mp3, a repeating error message.")},null,8,["field","label","description"])):A("",!0)])]),_:1},8,["label","item-header-class"]))}}),Ft={class:"row g-3 mb-3"},Tt={key:0,class:"row g-3"},jt=U({__name:"AutoDj",props:{stationFrontendType:{}},setup(p){const n=z(),{maxBitrate:s}=H(n),{r$:e,form:m}=F(T()),a=E(y(()=>e.value.$groups.autoDjTab)),o=[{value:M.Mp3,text:"MP3"},{value:M.Ogg,text:"OGG Vorbis"},{value:M.Opus,text:"OGG Opus"},{value:M.Aac,text:"AAC+ (MPEG4 HE-AAC v2)"},{value:M.Flac,text:"FLAC (OGG FLAC)"}],_=y(()=>m.value.autodj_format!==M.Flac);return(r,b)=>(u(),w(D,{label:r.$gettext("AutoDJ"),"item-header-class":t(a)},{default:l(()=>[c("div",Ft,[i(C,{id:"edit_form_enable_autodj",class:"col-md-12",field:t(e).enable_autodj,label:r.$gettext("Enable AutoDJ"),description:r.$gettext("If enabled, the AutoDJ will automatically play music to this mount point.")},null,8,["field","label","description"])]),t(m).enable_autodj?(u(),$("div",Tt,[i(pt,{id:"edit_form_autodj_format",class:"col-md-6",field:t(e).autodj_format,options:o,stacked:"",radio:"",label:r.$gettext("AutoDJ Format")},null,8,["field","label"]),_.value?(u(),w(g,{key:0,id:"edit_form_autodj_bitrate",class:"col-md-6",label:r.$gettext("AutoDJ Bitrate (kbps)"),field:t(e).autodj_bitrate},{default:l(({id:v,model:h,fieldClass:x})=>[i(_t,{id:v,modelValue:h.$model,"onUpdate:modelValue":k=>h.$model=k,class:ut(x),"max-bitrate":t(s)},null,8,["id","modelValue","onUpdate:modelValue","class","max-bitrate"])]),_:1},8,["label","field"])):A("",!0)])):A("",!0)]),_:1},8,["label","item-header-class"]))}}),Pt={class:"row g-3 mb-3"},Rt={key:0,class:"row g-3"},Et=U({__name:"Advanced",props:{stationFrontendType:{}},setup(p){const n=p,s=y(()=>R.Icecast===n.stationFrontendType),{r$:e}=F(T()),m=E(y(()=>e.value.$groups.advancedTab));return(a,o)=>(u(),w(D,{label:a.$gettext("Advanced"),"item-header-class":t(m)},{default:l(()=>[c("div",Pt,[i(g,{id:"edit_form_custom_listen_url",class:"col-md-12",field:t(e).custom_listen_url,advanced:"",label:a.$gettext("Mount Point URL"),description:a.$gettext("You can set a custom URL for this stream that AzuraCast will use when referring to it on the web interface and in the Now Playing API return data. Leave empty to use the default value.")},null,8,["field","label","description"])]),s.value?(u(),$("div",Rt,[i(g,{id:"edit_form_frontend_config",class:"col-md-12",field:t(e).frontend_config,"input-type":"textarea",advanced:"","input-attrs":{class:"text-preformatted",spellcheck:"false","max-rows":25,rows:5},label:a.$gettext("Custom Frontend Configuration"),description:a.$gettext("You can include any special mount point settings here, in either JSON { key: 'value' } format or XML <key>value</key>")},null,8,["field","label","description"])])):A("",!0)]),_:1},8,["label","item-header-class"]))}}),Vt={class:"row g-3"},Lt={key:0},Nt={class:"block-buttons pt-3"},Bt=["href"],Ot={key:1},Gt=U({__name:"Intro",props:mt({recordHasIntro:{type:Boolean},editIntroUrl:{},newIntroUrl:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(p){const n=p,s=ct(p,"modelValue"),e=Y(n,"recordHasIntro"),m=y(()=>n.editIntroUrl?n.editIntroUrl:n.newIntroUrl),a=(r,b)=>{e.value=!0,!n.editIntroUrl&&b&&(s.value=b)},{axios:o}=it(),_=async()=>{n.editIntroUrl?(await o.delete(n.editIntroUrl),e.value=!1):(e.value=!1,s.value=null)};return(r,b)=>(u(),w(D,{label:r.$gettext("Intro")},{default:l(()=>[c("div",Vt,[i(gt,{id:"intro_file",class:"col-md-6"},{label:l(()=>[I(d(r.$gettext("Select Intro File")),1)]),description:l(()=>[I(d(r.$gettext("This introduction file should exactly match the bitrate and format of the mount point itself.")),1)]),default:l(()=>[i(ht,{"target-url":m.value,"valid-mime-types":["audio/*"],onSuccess:a},null,8,["target-url"])]),_:1}),i($t,{id:"current_intro_file",class:"col-md-6"},{label:l(()=>[I(d(r.$gettext("Current Intro File")),1)]),default:l(()=>[e.value?(u(),$("div",Lt,[c("div",Nt,[r.editIntroUrl?(u(),$("a",{key:0,class:"btn btn-block btn-dark",href:r.editIntroUrl,target:"_blank"},d(r.$gettext("Download")),9,Bt)):A("",!0),c("button",{type:"button",class:"btn btn-block btn-danger",onClick:_},d(r.$gettext("Clear File")),1)])])):(u(),$("div",Ot,d(r.$gettext("There is no existing intro file associated with this mount point.")),1))]),_:1})])]),_:1},8,["label"]))}}),Ht=U({__name:"EditModal",props:{createUrl:{},newIntroUrl:{}},emits:["relist","needs-restart"],setup(p,{expose:n,emit:s}){const e=p,m=s,a=z(),{frontendType:o}=H(a),_=q("$modal"),{notifySuccess:r}=nt(),b=T(),{form:v,record:h,r$:x}=F(b),{$reset:k}=b,{loading:f,error:j,isEditMode:K,clearContents:Q,create:W,edit:X,doSubmit:Z,close:V}=yt(Y(e,"createUrl"),m,_,k,S=>{h.value=G(h.value,S),x.value.$reset({toState:G(x.value.$value,S)})},async()=>{const{valid:S}=await x.value.$validate();return{valid:S,data:v.value}},{onSubmitSuccess:()=>{r(),m("relist"),m("needs-restart"),V()}}),{$gettext:L}=J(),tt=y(()=>K.value?L("Edit Mount Point"):L("Add Mount Point"));return n({create:W,edit:X,close:V}),(S,N)=>(u(),w(vt,{ref_key:"$modal",ref:_,loading:t(f),title:tt.value,error:t(j),"disable-save-button":t(x).$invalid,onSubmit:t(Z),onHidden:t(Q)},{default:l(()=>[i(at,null,{default:l(()=>[i(Dt,{"station-frontend-type":t(o)},null,8,["station-frontend-type"]),i(jt,{"station-frontend-type":t(o)},null,8,["station-frontend-type"]),i(Gt,{modelValue:t(v).intro_file,"onUpdate:modelValue":N[0]||(N[0]=et=>t(v).intro_file=et),"record-has-intro":t(h).intro_path!==null,"new-intro-url":S.newIntroUrl,"edit-intro-url":t(h).links.intro},null,8,["modelValue","record-has-intro","new-intro-url","edit-intro-url"]),i(Et,{"station-frontend-type":t(o)},null,8,["station-frontend-type"])]),_:1})]),_:1},8,["loading","title","error","disable-save-button","onSubmit","onHidden"]))}}),Jt={class:"card-text"},Yt={class:"m-0"},qt=["href"],zt={key:0},Kt={class:"badge text-bg-success"},Qt={class:"btn-group btn-group-sm"},Wt=["onClick"],Xt=["onClick"],Ke=U({__name:"Mounts",setup(p){const n=O("/mounts"),s=O("/mounts/intro"),{$gettext:e}=J(),m=[{key:"display_name",isRowHeader:!0,label:e("Name"),sortable:!0},{key:"enable_autodj",label:e("AutoDJ"),sortable:!0},{key:"actions",label:e("Actions"),sortable:!1,class:"shrink"}],a=St(n,ft([bt.StationMounts])),o=()=>{a.refresh()},_=q("$editModal"),{doCreate:r,doEdit:b}=It(_),{mayNeedRestart:v}=kt(),{doDelete:h}=Mt(e("Delete Mount Point?"),()=>{v(),o()});return(x,k)=>(u(),$(P,null,[i(At,{title:t(e)("Mount Points")},{info:l(()=>[c("p",Jt,d(t(e)("Mount points are how listeners connect and listen to your station. Each mount point can be a different audio format or quality. Using mount points, you can set up a high-quality stream for broadband listeners and a mobile stream for phone users.")),1)]),actions:l(()=>[i(xt,{text:t(e)("Add Mount Point"),onClick:t(r)},null,8,["text","onClick"])]),default:l(()=>[i(ot,{id:"station_mounts",fields:m,provider:t(a),paginated:""},{"cell(display_name)":l(f=>[c("h5",Yt,[c("a",{href:f.item.links.listen},d(f.item.display_name),9,qt)]),f.item.is_default?(u(),$("div",zt,[c("span",Kt,d(t(e)("Default Mount")),1)])):A("",!0)]),"cell(enable_autodj)":l(f=>[f.item.enable_autodj?(u(),$(P,{key:0},[I(d(t(e)("Enabled"))+" - "+d(t(wt)(f.item.autodj_format,f.item.autodj_bitrate)),1)],64)):(u(),$(P,{key:1},[I(d(t(e)("Disabled")),1)],64))]),"cell(actions)":l(f=>[c("div",Qt,[c("button",{type:"button",class:"btn btn-primary",onClick:j=>t(b)(f.item.links.self)},d(t(e)("Edit")),9,Wt),c("button",{type:"button",class:"btn btn-danger",onClick:j=>t(h)(f.item.links.self)},d(t(e)("Delete")),9,Xt)])]),_:1},8,["provider"])]),_:1},8,["title"]),i(Ht,{ref_key:"$editModal",ref:_,"create-url":t(n),"new-intro-url":t(s),onRelist:k[0]||(k[0]=()=>o()),onNeedsRestart:k[1]||(k[1]=()=>t(v)())},null,8,["create-url","new-intro-url"])],64))}});export{Ke as default};
