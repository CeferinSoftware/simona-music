import{_ as H}from"./DataTable-BhAO7RbG.js";import{u as D}from"./useBaseEditModal-D4NDXa4y.js";import{g as M,u as N}from"./layout-CUzOT8aY.js";import{_ as R}from"./ModalForm-D0z4l5nm.js";import{_ as U}from"./FormGroupField-K9S4Sadl.js";import{u as V,b as L,r as Q}from"./regle-hGsoY2W9.js";import{m as O}from"./mergeExisting-B6FvxI3v.js";import{d as I,g as B,r as P,K as z,B as W,q as Y,m as j,o as h,e as r,a as s,b as n,u as e,f as d,t as o,a6 as G,c as x,i as E}from"./vue-BsfewpWM.js";import{u as J,_ as X}from"./AddButton-DLx8r-7e.js";import{u as Z}from"./useConfirmAndDelete-CuQodV6V.js";import{_ as T}from"./CardPage-Cth3uewv.js";import{e as q,a as ee,q as A,Q as K}from"./useStationQuery-ClAZEJp_.js";import{u as te}from"./useApiItemProvider-DAIhDonu.js";import{_ as se}from"./Loading-CQdAiB8R.js";import"./icons-BAjd3tML.js";import"./FormMultiCheck-RiRcopXY.js";import"./map-Caxea7Kw.js";import"./estoolkit-DCzBkaPJ.js";import"./isArrayLike-DknTMkCU.js";import"./iteratee-DJRL6CbS.js";import"./FormCheckbox-Cc7beVle.js";import"./isTypedArray-By1PpNM0.js";import"./some-B0KiPFWm.js";import"./forEach-BFcv9GyE.js";import"./leaflet-DkUWBo0d.js";import"./hlsjs-BVyhFw5s.js";import"./bootstrap.esm-30QIU_ZL.js";import"./InvisibleSubmitButton-NGv_v7G8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useSlotsExcept-Dp0PSXNw.js";import"./useHasModal-Bq3QxExQ.js";import"./FormGroup-DXDHSoyc.js";import"./ValidationError-DsAp6Fjg.js";import"./zxcvbn-Bgw4VUEj.js";import"./InfoCard-D5Q671bF.js";import"./vue-router-Cafqdr3I.js";const oe={class:"row g-3"},re=I({__name:"EditModal",props:{createUrl:{}},emits:["relist"],setup(C,{expose:k,emit:S}){const l=C,$=S,u=B("$modal"),t=P({username:"",password:"",publicKeys:null}),_=P(!1),{r$:a}=V(t,{username:{required:Q},password:{required:L(()=>!_.value)}},{}),{loading:f,error:y,isEditMode:c,clearContents:g,create:w,edit:b,doSubmit:m,close:v}=D(z(l,"createUrl"),$,u,()=>{a.$reset({toOriginalState:!0})},p=>{a.$reset({toState:O(a.$value,p)})},async()=>{const{valid:p}=await a.$validate();return{valid:p,data:t.value}});W(c,p=>{_.value=p});const{$gettext:i}=M(),F=Y(()=>c.value?i("Edit SFTP User"):i("Add SFTP User"));return k({create:w,edit:b,close:v}),(p,ye)=>(h(),j(R,{ref_key:"$modal",ref:u,loading:e(f),title:F.value,error:e(y),"disable-save-button":e(a).$invalid,onSubmit:e(m),onHidden:e(g)},{default:r(()=>[s("div",oe,[n(U,{id:"edit_form_username",class:"col-md-6",field:e(a).username},{label:r(()=>[d(o(e(i)("Username")),1)]),_:1},8,["field"]),n(U,{id:"edit_form_password",class:"col-md-6",field:e(a).password,"input-type":"password"},G({_:2},[e(c)?{name:"label",fn:r(()=>[d(o(e(i)("New Password")),1)]),key:"0"}:{name:"label",fn:r(()=>[d(o(e(i)("Password")),1)]),key:"1"},e(c)?{name:"description",fn:r(()=>[d(o(e(i)("Leave blank to use the current password.")),1)]),key:"2"}:void 0]),1032,["field"]),n(U,{id:"edit_form_publicKeys",class:"col-md-12",field:e(a).publicKeys,"input-type":"textarea"},{label:r(()=>[d(o(e(i)("SSH Public Keys")),1)]),description:r(()=>[d(o(e(i)("Optionally supply SSH public keys this user can use to connect instead of a password. Enter one key per line.")),1)]),_:1},8,["field"])])]),_:1},8,["loading","title","error","disable-save-button","onSubmit","onHidden"]))}}),ae={class:"row"},ie={class:"col-md-8"},ne={class:"btn-group btn-group-sm"},le=["onClick"],de=["onClick"],ce={class:"col-md-4"},me={class:"card-body"},pe={key:0},ue={class:"mb-1"},_e={key:0},fe={class:"mb-1"},Ze=I({__name:"SftpUsers",setup(C){const k=q("/vue/sftp_users"),{axios:S}=N(),{data:l,isLoading:$}=ee({queryKey:A([K.StationSftpUsers,"props"]),queryFn:async({signal:b})=>{const{data:m}=await S.get(k.value,{signal:b});return m}}),u=q("/sftp-users"),{$gettext:t}=M(),_=[{key:"username",isRowHeader:!0,label:t("Username"),sortable:!1},{key:"actions",label:t("Actions"),sortable:!1,class:"shrink"}],a=te(u,A([K.StationSftpUsers,"data"])),f=()=>{a.refresh()},y=B("$editModal"),{doCreate:c,doEdit:g}=J(y),{doDelete:w}=Z(t("Delete SFTP User?"),()=>f());return(b,m)=>(h(),x("div",ae,[s("div",ie,[n(T,{"header-id":"hdr_sftp_users",title:e(t)("SFTP Users")},{actions:r(()=>[n(X,{text:e(t)("Add SFTP User"),onClick:e(c)},null,8,["text","onClick"])]),default:r(()=>[n(H,{id:"station_sftp_users","show-toolbar":!1,fields:_,provider:e(a)},{"cell(actions)":r(v=>[s("div",ne,[s("button",{type:"button",class:"btn btn-primary",onClick:i=>e(g)(v.item.links.self)},o(e(t)("Edit")),9,le),s("button",{type:"button",class:"btn btn-danger",onClick:i=>e(w)(v.item.links.self)},o(e(t)("Delete")),9,de)])]),_:1},8,["provider"])]),_:1},8,["title"])]),s("div",ce,[n(T,{"header-id":"hdr_connection_info",title:e(t)("Connection Information")},{default:r(()=>[s("div",me,[n(se,{loading:e($),lazy:""},{default:r(()=>[e(l)?(h(),x("dl",pe,[s("dt",ue,o(e(t)("Server:")),1),s("dd",null,[s("code",null,o(e(l).connectionUrl),1)]),e(l).connectionIp?(h(),x("dd",_e,[d(o(e(t)("You may need to connect directly to your IP address:"))+" ",1),s("code",null,o(e(l).connectionIp),1)])):E("",!0),s("dt",fe,o(e(t)("Port:")),1),s("dd",null,[s("code",null,o(e(l).connectionPort),1)])])):E("",!0)]),_:1},8,["loading"])])]),_:1},8,["title"])]),n(re,{ref_key:"$editModal",ref:y,"create-url":e(u),onRelist:m[0]||(m[0]=()=>f())},null,8,["create-url"])]))}});export{Ze as default};
