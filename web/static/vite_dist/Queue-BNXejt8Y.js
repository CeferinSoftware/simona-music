import{d as S,r as U,g as T,m as V,o as i,e as m,a,u as s,t as o,l as $,c as r,b as f,i as C,f as h,F as B}from"./vue-BsfewpWM.js";import{_ as I}from"./DataTable-BhAO7RbG.js";import{X as N,g as R,a5 as j,f as P,u as F}from"./layout-CUzOT8aY.js";import{u as E,_ as H}from"./useHasModal-Bq3QxExQ.js";import{_ as K,V as w}from"./icons-BAjd3tML.js";import{u as z}from"./useConfirmAndDelete-CuQodV6V.js";import{_ as W}from"./CardPage-Cth3uewv.js";import{e as x,q as X,Q as G}from"./useStationQuery-ClAZEJp_.js";import{u as J}from"./useStationDateTimeFormatter-CkmvkIuo.js";import{u as O}from"./useApiItemProvider-DAIhDonu.js";import"./FormMultiCheck-RiRcopXY.js";import"./map-Caxea7Kw.js";import"./estoolkit-DCzBkaPJ.js";import"./isArrayLike-DknTMkCU.js";import"./iteratee-DJRL6CbS.js";import"./FormCheckbox-Cc7beVle.js";import"./isTypedArray-By1PpNM0.js";import"./some-B0KiPFWm.js";import"./forEach-BFcv9GyE.js";import"./leaflet-DkUWBo0d.js";import"./hlsjs-BVyhFw5s.js";import"./bootstrap.esm-30QIU_ZL.js";import"./Loading-CQdAiB8R.js";import"./InfoCard-D5Q671bF.js";import"./vue-router-Cafqdr3I.js";import"./luxon-m3VuE4xT.js";import"./luxon-F75Z0klY.js";const Y=["value"],Z=S({__name:"LogsModal",setup(D,{expose:g}){const u=U("Loading..."),t=T("$modal"),{show:y,hide:c}=E(t),p=l=>{u.value=l.slice().join(""),y()},b=N(),v=()=>{b.copy(u.value)};return g({show:p}),(l,d)=>(i(),V(H,{id:"logs_modal",ref_key:"$modal",ref:t,size:"xl",title:l.$gettext("Log Viewer")},{"modal-footer":m(()=>[a("button",{class:"btn btn-secondary",type:"button",onClick:d[0]||(d[0]=(...k)=>s(c)&&s(c)(...k))},o(l.$gettext("Close")),1),a("button",{class:"btn btn-primary",type:"button",onClick:$(v,["prevent"])},o(l.$gettext("Copy to Clipboard")),1)]),default:m(()=>[a("textarea",{class:"form-control log-viewer",spellcheck:"false",readonly:"",value:u.value},null,8,Y)]),_:1},8,["title"]))}}),ee={class:"btn-group btn-group-sm"},te=["onClick"],oe=["onClick"],se={key:0},ae={key:1},ie={key:2},le={key:0},ne={key:1},Be=S({__name:"Queue",setup(D){const g=x("/queue"),u=x("/queue/clear"),{$gettext:t}=R(),y=[{key:"actions",label:t("Actions"),sortable:!1},{key:"song_title",isRowHeader:!0,label:t("Song Title"),sortable:!1},{key:"played_at",label:t("Expected to Play at"),sortable:!1},{key:"source",label:t("Source"),sortable:!1}],c=O(g,X([G.StationQueue]),{refetchInterval:3e4}),p=()=>{c.refresh()},{formatTimestampAsTime:b,formatTimestampAsRelative:v}=J(),l=T("$logsModal"),d=_=>{l.value?.show(_)},{doDelete:k}=z(t("Delete Queue Item?"),()=>p()),{confirmDelete:Q}=j(),{notifySuccess:q}=P(),{axios:A}=F(),M=async()=>{const{value:_}=await Q({title:t("Clear Upcoming Song Queue?"),confirmButtonText:t("Clear")});if(_){const{data:n}=await A.post(u.value);q(n.message),p()}};return(_,n)=>(i(),r(B,null,[f(W,{title:s(t)("Upcoming Song Queue")},{actions:m(()=>[a("button",{type:"button",class:"btn btn-danger",onClick:n[0]||(n[0]=e=>M())},[f(K,{icon:s(w)},null,8,["icon"]),a("span",null,o(s(t)("Clear Upcoming Song Queue")),1)])]),default:m(()=>[f(I,{id:"station_queue",fields:y,provider:s(c),"hide-on-loading":!1},{"cell(actions)":m(e=>[a("div",ee,[e.item.log?(i(),r("button",{key:0,type:"button",class:"btn btn-primary",onClick:$(L=>d(e.item.log),["prevent"])},o(s(t)("Logs")),9,te)):C("",!0),e.item.sent_to_autodj?C("",!0):(i(),r("button",{key:1,type:"button",class:"btn btn-danger",onClick:$(L=>s(k)(e.item.links.self),["prevent"])},o(s(t)("Delete")),9,oe))])]),"cell(song_title)":m(e=>[e.item.autodj_custom_uri?(i(),r("div",se,o(e.item.autodj_custom_uri),1)):e.item.song.title?(i(),r("div",ae,[a("b",null,o(e.item.song.title),1),n[1]||(n[1]=a("br",null,null,-1)),h(" "+o(e.item.song.artist),1)])):(i(),r("div",ie,o(e.item.song.text),1))]),"cell(played_at)":m(e=>[h(o(s(b)(e.item.played_at)),1),n[2]||(n[2]=a("br",null,null,-1)),a("small",null,o(s(v)(e.item.played_at)),1)]),"cell(source)":m(e=>[e.item.is_request?(i(),r("div",le,o(s(t)("Listener Request")),1)):e.item.playlist?(i(),r("div",ne,o(s(t)("Playlist"))+": "+o(e.item.playlist),1)):C("",!0)]),_:1},8,["provider"])]),_:1},8,["title"]),f(Z,{ref_key:"$logsModal",ref:l},null,512)],64))}});export{Be as default};
