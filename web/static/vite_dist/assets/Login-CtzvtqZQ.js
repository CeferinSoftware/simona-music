import{u as $,i as k}from"../layout-CUzOT8aY.js";import{a as A,_ as h,I as S}from"../icons-BAjd3tML.js";import{u as x}from"../useWebAuthn-Dxtp442E.js";import{d as N,g as P,r as b,h as I,c as n,o as i,a as t,i as g,t as o,b as _,u as r,f as C,n as V}from"../vue-BsfewpWM.js";import"../leaflet-DkUWBo0d.js";import"../estoolkit-DCzBkaPJ.js";import"../hlsjs-BVyhFw5s.js";import"../bootstrap.esm-30QIU_ZL.js";const U={class:"public-page"},R={class:"card p-2"},B={class:"card-body"},E={class:"row mb-4"},F={class:"col-sm"},W={key:0,class:"card-title text-center"},D={key:1,class:"card-title text-center"},M={key:2,class:"card-subtitle text-center text-muted"},T={id:"login-form",action:"",method:"post"},q={class:"form-group"},J={for:"username",class:"mb-2 d-flex align-items-center gap-2"},K=["placeholder","aria-label"],L={class:"form-group mt-3"},O={for:"password",class:"mb-2 d-flex align-items-center gap-2"},j=["placeholder","aria-label"],z={class:"form-group mt-4"},G={class:"custom-control custom-checkbox"},H={for:"frm_remember_me",class:"custom-control-label"},Q={class:"block-buttons mt-3 mb-3"},X=["title"],Y=["action"],Z=["value"],ee={class:"block-buttons mb-3"},te=["title"],oe={class:"text-center m-0"},se=["href"],ae=N({__name:"Login",props:{hideProductName:{type:Boolean},instanceName:{},forgotPasswordUrl:{},webAuthnUrl:{}},setup(f){const l=f,{isSupported:w,isConditionalSupported:y,doValidate:c}=x(),{axios:d}=$(),u=P("$webAuthnForm"),a=b(null),m=b(null),p=async e=>{m.value=JSON.stringify(e),await V(),u.value?.submit()},v=async()=>{a.value===null&&(a.value=(await d.get(l.webAuthnUrl)).data);try{const e=await c(a.value,!1);await p(e)}catch(e){console.error(e)}};return I(async()=>{if(await y()){a.value=(await d.get(l.webAuthnUrl)).data;try{const s=await c(a.value,!0);await p(s)}catch(s){console.error(s)}}}),(e,s)=>(i(),n("div",U,[t("div",R,[t("div",B,[t("div",E,[t("div",F,[e.hideProductName?(i(),n("h2",W,o(e.$gettext("Welcome!")),1)):(i(),n("h2",D,o(e.$gettext("Welcome to Simona Music!")),1)),e.instanceName?(i(),n("h3",M,o(e.instanceName),1)):g("",!0)])]),t("form",T,[t("div",q,[t("label",J,[_(h,{icon:r(A)},null,8,["icon"]),t("strong",null,o(e.$gettext("E-mail Address")),1)]),t("input",{id:"username",type:"email",name:"username",class:"form-control",autocomplete:"username webauthn",placeholder:e.$gettext("name@example.com"),"aria-label":e.$gettext("E-mail Address"),required:"",autofocus:""},null,8,K)]),t("div",L,[t("label",O,[_(h,{icon:r(S)},null,8,["icon"]),t("strong",null,o(e.$gettext("Password")),1)]),t("input",{id:"password",type:"password",name:"password",class:"form-control",autocomplete:"current-password",placeholder:e.$gettext("Enter your password"),"aria-label":e.$gettext("Password"),required:""},null,8,j)]),t("div",z,[t("div",G,[s[0]||(s[0]=t("input",{id:"frm_remember_me",type:"checkbox",name:"remember",value:"1",class:"toggle-switch custom-control-input"},null,-1)),t("label",H,o(e.$gettext("Remember me")),1)])]),t("div",Q,[t("button",{type:"submit",role:"button",title:e.$gettext("Sign In"),class:"btn btn-login btn-primary"},o(e.$gettext("Sign In")),9,X)])]),r(w)?(i(),n("form",{key:0,id:"webauthn-form",ref_key:"$webAuthnForm",ref:u,action:e.webAuthnUrl,method:"post"},[t("input",{type:"hidden",name:"validateData",value:m.value},null,8,Z),t("div",ee,[t("button",{type:"button",role:"button",title:e.$gettext("Sign In with Passkey"),class:"btn btn-sm btn-secondary",onClick:v},o(e.$gettext("Sign In with Passkey")),9,te)])],8,Y)):g("",!0),t("p",oe,[C(o(e.$gettext("Please log in to continue."))+" ",1),t("a",{href:e.forgotPasswordUrl},o(e.$gettext("Forgot your password?")),9,se)])])])]))}});k(ae);
