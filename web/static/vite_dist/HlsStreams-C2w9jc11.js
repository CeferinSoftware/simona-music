import{_ as I}from"./DataTable-BhAO7RbG.js";import{_ as P}from"./FormGroupField-K9S4Sadl.js";import{_ as L}from"./FormGroupMultiCheck-z3kTFzdV.js";import{_ as U,a as q}from"./Tabs-DMTPhsiO.js";import{d as O,af as v,s as R,ab as K,f as Q,g as T}from"./layout-CUzOT8aY.js";import{u as j}from"./useFormTabClass-DgI07GN4.js";import{u as G,r as A}from"./regle-hGsoY2W9.js";import{r as W,d as H,q as k,m as N,o as x,u as t,e as r,a as p,b as l,f as C,t as u,g as w,K as z,c as J,F as X}from"./vue-BsfewpWM.js";import{c as Y,e as Z,q as tt,Q as et}from"./useStationQuery-ClAZEJp_.js";import{u as at}from"./useBaseEditModal-D4NDXa4y.js";import{_ as ot}from"./ModalForm-D0z4l5nm.js";import{m as st}from"./mergeExisting-B6FvxI3v.js";import{u as rt}from"./useMayNeedRestart-CTqbUxcB.js";import{u as it,_ as nt}from"./AddButton-DLx8r-7e.js";import{u as lt}from"./useConfirmAndDelete-CuQodV6V.js";import{_ as mt}from"./CardPage-Cth3uewv.js";import{u as ct}from"./useApiItemProvider-DAIhDonu.js";import"./icons-BAjd3tML.js";import"./FormMultiCheck-RiRcopXY.js";import"./map-Caxea7Kw.js";import"./estoolkit-DCzBkaPJ.js";import"./isArrayLike-DknTMkCU.js";import"./iteratee-DJRL6CbS.js";import"./FormCheckbox-Cc7beVle.js";import"./isTypedArray-By1PpNM0.js";import"./some-B0KiPFWm.js";import"./forEach-BFcv9GyE.js";import"./FormGroup-DXDHSoyc.js";import"./ValidationError-DsAp6Fjg.js";import"./useSlotsExcept-Dp0PSXNw.js";import"./leaflet-DkUWBo0d.js";import"./hlsjs-BVyhFw5s.js";import"./bootstrap.esm-30QIU_ZL.js";import"./zxcvbn-Bgw4VUEj.js";import"./vue-router-Cafqdr3I.js";import"./InvisibleSubmitButton-NGv_v7G8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useHasModal-Bq3QxExQ.js";import"./Loading-CQdAiB8R.js";import"./InfoCard-D5Q671bF.js";const D=O("form-stations-hls-streams",()=>{const f=W({name:"",format:v.AacLowComplexity,bitrate:128}),{r$:o}=G(f,{name:{required:A},format:{required:A},bitrate:{required:A}},{validationGroups:i=>({basicInfoTab:[i.name,i.format,i.bitrate]})});return{form:f,r$:o,$reset:()=>{o.$reset({toOriginalState:!0})}}}),dt={class:"row g-3 mb-3"},ut=H({__name:"BasicInfo",setup(f){const{r$:o}=R(D()),a=j(k(()=>o.value.$groups.basicInfoTab)),i=[{value:v.AacLowComplexity,text:"AAC Low Complexity (Default)"},{value:v.AacHighEfficiencyV1,text:"AAC High Efficiency V1 (HE-AAC)"},{value:v.AacHighEfficiencyV2,text:"AAC High Efficiency V2 (HE-AACv2)"}],m=Y(),{maxBitrate:c}=K(m),_=[32,48,64,96,128,192,256,320],d=k(()=>_.filter(e=>c.value===0||e<=c.value).map(e=>({value:e,text:String(e)})));return(e,b)=>(x(),N(U,{label:e.$gettext("Basic Info"),"item-header-class":t(a)},{default:r(()=>[p("div",dt,[l(P,{id:"edit_form_name",class:"col-md-12",field:t(o).name,label:e.$gettext("Programmatic Name")},{description:r(()=>[C(u(e.$gettext('A name for this stream that will be used internally in code. Should only contain letters, numbers, and underscores (i.e. "stream_lofi").')),1)]),_:1},8,["field","label"]),l(L,{id:"edit_form_format",class:"col-md-6",field:t(o).format,options:i,stacked:"",radio:"",label:e.$gettext("Audio Format")},null,8,["field","label"]),l(L,{id:"edit_form_bitrate",class:"col-md-6",field:t(o).bitrate,options:d.value,stacked:"",radio:"",label:e.$gettext("Audio Bitrate (kbps)")},null,8,["field","options","label"])])]),_:1},8,["label","item-header-class"]))}}),ft=H({__name:"EditModal",props:{createUrl:{}},emits:["relist","needs-restart"],setup(f,{expose:o,emit:a}){const i=f,m=a,c=w("$modal"),{notifySuccess:_}=Q(),d=D(),{r$:e,form:b}=R(d),{$reset:$}=d,{loading:y,error:g,isEditMode:n,clearContents:s,create:h,edit:F,doSubmit:M,close:E}=at(z(i,"createUrl"),m,c,$,S=>{e.value.$reset({toState:st(e.value.$value,S)})},async()=>{const{valid:S}=await e.value.$validate();return{valid:S,data:b.value}},{onSubmitSuccess:()=>{_(),m("relist"),m("needs-restart"),E()}}),{$gettext:B}=T(),V=k(()=>n.value?B("Edit HLS Stream"):B("Add HLS Stream"));return o({create:h,edit:F,close:E}),(S,St)=>(x(),N(ot,{ref_key:"$modal",ref:c,loading:t(y),title:V.value,error:t(g),"disable-save-button":t(e).$invalid,onSubmit:t(M),onHidden:t(s)},{default:r(()=>[l(q,{"content-class":"mt-3"},{default:r(()=>[l(ut)]),_:1})]),_:1},8,["loading","title","error","disable-save-button","onSubmit","onHidden"]))}}),pt={class:"card-text"},_t={class:"m-0"},bt={class:"btn-group btn-group-sm"},$t=["onClick"],gt=["onClick"],ie=H({__name:"HlsStreams",setup(f){const o=Z("/hls_streams"),{$gettext:a}=T(),i=[{key:"name",isRowHeader:!0,label:a("Name"),sortable:!0},{key:"format",label:a("Format"),sortable:!0},{key:"bitrate",label:a("Bitrate"),sortable:!0},{key:"actions",label:a("Actions"),sortable:!1,class:"shrink"}],m=ct(o,tt([et.StationHlsStreams])),c=()=>{m.refresh()},_=g=>{const n=[];return g.split(" ").forEach(s=>{n.push(s.toUpperCase())}),n.join(" ")},d=w("$editModal"),{doCreate:e,doEdit:b}=it(d),{mayNeedRestart:$}=rt(),{doDelete:y}=lt(a("Delete HLS Stream?"),()=>{$(),c()});return(g,n)=>(x(),J(X,null,[l(mt,{title:t(a)("HLS Streams")},{info:r(()=>[p("p",pt,u(t(a)("HTTP Live Streaming (HLS) is a new adaptive-bitrate streaming technology. From this page, you can configure the individual bitrates and formats that are included in the combined HLS stream.")),1)]),actions:r(()=>[l(nt,{text:t(a)("Add HLS Stream"),onClick:t(e)},null,8,["text","onClick"])]),default:r(()=>[l(I,{id:"station_hls_streams",fields:i,provider:t(m),paginated:""},{"cell(name)":r(s=>[p("h5",_t,u(s.item.name),1)]),"cell(format)":r(s=>[C(u(_(s.item.format)),1)]),"cell(bitrate)":r(s=>[C(u(s.item.bitrate)+"kbps ",1)]),"cell(actions)":r(s=>[p("div",bt,[p("button",{type:"button",class:"btn btn-primary",onClick:h=>t(b)(s.item.links.self)},u(t(a)("Edit")),9,$t),p("button",{type:"button",class:"btn btn-danger",onClick:h=>t(y)(s.item.links.self)},u(t(a)("Delete")),9,gt)])]),_:1},8,["provider"])]),_:1},8,["title"]),l(ft,{ref_key:"$editModal",ref:d,"create-url":t(o),onRelist:n[0]||(n[0]=()=>c()),onNeedsRestart:n[1]||(n[1]=()=>t($)())},null,8,["create-url"])],64))}});export{ie as default};
