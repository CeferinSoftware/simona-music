import{_ as ge}from"./DataTable-BhAO7RbG.js";import{d as k,c as C,o as g,a as c,t as p,F as B,D as me,i as G,l as pe,b as l,u as t,af as R,A as T,q as O,m as h,e as _,f as q,R as _e,r as be,S as he,g as se,K as ye,z as le,a7 as $e,n as ke,s as ve}from"./vue-BsfewpWM.js";import{ao as J,ap as s,g as W,aq as $,f as we,u as Me}from"./layout-CUzOT8aY.js";import{_ as m}from"./FormGroupField-K9S4Sadl.js";import{_ as ne}from"./FormGroupMultiCheck-z3kTFzdV.js";import{_ as S,a as Te}from"./Tabs-DMTPhsiO.js";import{_ as Ae}from"./FormGroupSelect-Cp69W3Gu.js";import{u as D}from"./useFormTabClass-DgI07GN4.js";import{d as A,r as b,g as Ce,f as Re}from"./regle-hGsoY2W9.js";import{a as re,h as ce,g as j,j as Se}from"./iteratee-DJRL6CbS.js";import{s as De}from"./set-DDmyyuD3.js";import{i as xe}from"./isArrayLike-DknTMkCU.js";import{m as Ie}from"./map-Caxea7Kw.js";import{_ as ae}from"./FormMarkup-DqBjuQjX.js";import{_ as Pe}from"./FormGroupCheckbox-ZsJmXmB6.js";import{i as Le}from"./useSlotsExcept-Dp0PSXNw.js";import{u as Ge}from"./useBaseEditModal-D4NDXa4y.js";import{_ as Ue}from"./ModalForm-D0z4l5nm.js";import{m as Be}from"./mergeExisting-B6FvxI3v.js";import{u as Oe}from"./useResettableRef-BwkDrsai.js";import{F as qe,x as We,d as He,A as de,y as Ee,f as Ne,G as Ve}from"./estoolkit-DCzBkaPJ.js";import{i as je}from"./isTypedArray-By1PpNM0.js";import{_ as Fe}from"./StreamingLogModal-DW2-b89u.js";import{u as ze,_ as Ke}from"./AddButton-DLx8r-7e.js";import{u as Je}from"./useConfirmAndDelete-CuQodV6V.js";import{_ as Qe}from"./CardPage-Cth3uewv.js";import{e as Ye,u as Xe,g as Ze,q as et,Q as tt}from"./useStationQuery-ClAZEJp_.js";import{u as ot}from"./useApiItemProvider-DAIhDonu.js";import"./icons-BAjd3tML.js";import"./FormMultiCheck-RiRcopXY.js";import"./FormCheckbox-Cc7beVle.js";import"./some-B0KiPFWm.js";import"./forEach-BFcv9GyE.js";import"./leaflet-DkUWBo0d.js";import"./hlsjs-BVyhFw5s.js";import"./bootstrap.esm-30QIU_ZL.js";import"./FormGroup-DXDHSoyc.js";import"./ValidationError-DsAp6Fjg.js";import"./zxcvbn-Bgw4VUEj.js";import"./InvisibleSubmitButton-NGv_v7G8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useHasModal-Bq3QxExQ.js";import"./Loading-CQdAiB8R.js";import"./StreamingLogView-DMGIufU5.js";import"./index.es-DJGkFkUi.js";import"./theme-BQjAlSn5.js";import"./InfoCard-D5Q671bF.js";import"./vue-router-Cafqdr3I.js";function it(o){return o==null}function st(o,...n){const i=n.slice(0,-1),a=n[n.length-1];let e=o;for(let d=0;d<i.length;d++){const f=i[d];e=Y(e,f,a,new Map)}return e}function Y(o,n,i,a){if(Ne(o)&&(o=Object(o)),n==null||typeof n!="object")return o;if(a.has(n))return qe(a.get(n));if(a.set(n,o),Array.isArray(n)){n=n.slice();for(let d=0;d<n.length;d++)n[d]=n[d]??void 0}const e=[...Object.keys(n),...We(n)];for(let d=0;d<e.length;d++){const f=e[d];if(He(f))continue;let r=n[f],u=o[f];if(re(r)&&(r={...r}),re(u)&&(u={...u}),typeof Buffer<"u"&&Buffer.isBuffer(r)&&(r=ce(r)),Array.isArray(r))if(typeof u=="object"&&u!=null){const w=[],I=Reflect.ownKeys(u);for(let P=0;P<I.length;P++){const U=I[P];w[U]=u[U]}u=w}else u=[];const x=i(u,r,f,o,n,a);x!==void 0?o[f]=x:Array.isArray(r)||de(u)&&de(r)?o[f]=Y(u,r,i,a):u==null&&Ee(r)?o[f]=Y({},r,i,a):u==null&&je(r)?o[f]=ce(r):(u===void 0||r!==void 0)&&(o[f]=r)}return o}function nt(o,...n){return st(o,...n,Ve)}function at(o,...n){if(it(o))return{};const i={};for(let a=0;a<n.length;a++){let e=n[a];switch(typeof e){case"object":{Array.isArray(e)||(xe(e)?e=Array.from(e):e=[e]);break}case"string":case"symbol":case"number":{e=[e];break}}for(const d of e){const f=j(o,d);f===void 0&&!Se(o,d)||(typeof d=="string"&&Object.hasOwn(o,d)?i[d]=f:De(i,d,f))}}return i}const lt={class:"card mb-3"},rt={class:"card-header text-bg-primary"},ct={class:"card-subtitle"},dt={class:"list-group list-group-flush"},mt=["onClick"],ft={class:"font-weight-bold mb-0"},ut={class:"card-text small"},Q=k({__name:"TypeSelectSection",props:{title:{},types:{}},emits:["select"],setup(o,{emit:n}){const i=n,a=e=>{i("select",e)};return(e,d)=>(g(),C("section",lt,[c("div",rt,[c("h3",ct,p(e.title),1)]),c("div",dt,[(g(!0),C(B,null,me(e.types,(f,r)=>(g(),C(B,{key:r},[f?(g(),C("a",{key:0,class:"list-group-item list-group-item-action",href:"#",onClick:pe(u=>a(r),["prevent"])},[c("h6",ft,p(f.title),1),c("p",ut,p(f.description),1)],8,mt)):G("",!0)],64))),128))])]))}}),gt={class:"row g-3"},pt={class:"col-md-6"},_t={class:"col-md-6"},bt=k({__name:"TypeSelect",props:{typeDetails:{}},emits:["select"],setup(o,{emit:n}){const i=n,a=e=>{i("select",e)};return(e,d)=>(g(),C("div",gt,[c("div",pt,[l(Q,{title:e.$gettext("Generic Web Hooks"),types:t(J)(e.typeDetails,[t(s).Generic,t(s).Email]),onSelect:a},null,8,["title","types"]),l(Q,{title:e.$gettext("Social Media"),types:t(J)(e.typeDetails,[t(s).Discord,t(s).Telegram,t(s).GroupMe,t(s).Mastodon,t(s).Bluesky]),onSelect:a},null,8,["title","types"])]),c("div",_t,[l(Q,{title:e.$gettext("Station Directories"),types:t(J)(e.typeDetails,[t(s).TuneIn,t(s).RadioDe,t(s).RadioReg,t(s).GetMeRadio]),onSelect:a},null,8,["title","types"]),l(Q,{title:e.$gettext("Analytics"),types:t(J)(e.typeDetails,[t(s).GoogleAnalyticsV4,t(s).MatomoAnalytics]),onSelect:a},null,8,["title","types"])])]))}}),ht=[$.SongChanged,$.SongChangedLive,$.ListenerGained,$.ListenerLost,$.LiveConnect,$.LiveDisconnect,$.StationOffline,$.StationOnline],yt=[$.SongChanged,$.SongChangedLive,$.LiveConnect,$.LiveDisconnect,$.StationOffline,$.StationOnline];function $t(){const{$gettext:o}=W();return{[$.SongChanged]:{title:o("Song Change"),description:o("Any time the currently playing song changes")},[$.SongChangedLive]:{title:o("Song Change (Live Only)"),description:o("When the song changes and a live streamer/DJ is connected")},[$.ListenerGained]:{title:o("Listener Gained"),description:o("Any time the listener count increases")},[$.ListenerLost]:{title:o("Listener Lost"),description:o("Any time the listener count decreases")},[$.LiveConnect]:{title:o("Live Streamer/DJ Connected"),description:o("Any time a live streamer/DJ connects to the stream")},[$.LiveDisconnect]:{title:o("Live Streamer/DJ Disconnected"),description:o("Any time a live streamer/DJ disconnects from the stream")},[$.StationOffline]:{title:o("Station Goes Offline"),description:o("When the station broadcast goes offline")},[$.StationOnline]:{title:o("Station Goes Online"),description:o("When the station broadcast comes online")}}}function kt(){const{$gettext:o}=W();return{[s.Generic]:{title:o("Generic Web Hook"),description:o("Automatically send a message to any URL when your station data changes.")},[s.Email]:{title:o("Send E-mail"),description:o("Send an e-mail to specified address(es).")},[s.TuneIn]:{title:o("TuneIn AIR"),description:o("Send song metadata changes to %{service}.",{service:"TuneIn"})},[s.RadioDe]:{title:o("Radio.de"),description:o("Send song metadata changes to %{service}.",{service:"Radio.de"})},[s.RadioReg]:{title:o("RadioReg.net"),description:o("Send song metadata changes to %{service}.",{service:"RadioReg"})},[s.GetMeRadio]:{title:o("GetMeRadio"),description:o("Send song metadata changes to %{service}",{service:"GetMeRadio"})},[s.Discord]:{title:o("Discord Webhook"),description:o("Automatically send a customized message to your Discord server.")},[s.Telegram]:{title:o("Telegram Chat Message"),description:o("Use the Telegram Bot API to send a message to a channel.")},[s.GroupMe]:{title:o("GroupMe Chat Message"),description:o("Use the GroupMe Bot API to send a message to a channel.")},[s.Mastodon]:{title:o("Mastodon Post"),description:o("Automatically publish to a Mastodon instance.")},[s.Bluesky]:{title:o("Bluesky Post"),description:o("Automatically publish to Bluesky.")},[s.GoogleAnalyticsV4]:{title:o("Google Analytics V4 Integration"),description:o("Send stream listener details to Google Analytics.")},[s.MatomoAnalytics]:{title:o("Matomo Analytics Integration"),description:o("Send stream listener details to Matomo Analytics.")}}}function vt(o){switch(o){case s.TuneIn:case s.RadioDe:case s.RadioReg:case s.GetMeRadio:case s.GoogleAnalyticsV4:case s.MatomoAnalytics:return[];case s.Generic:case s.Email:return ht;case s.Discord:case s.Telegram:case s.GroupMe:case s.Mastodon:default:return yt}}const wt={class:"row g-3"},Mt={class:"row g-3"},Tt=k({__name:"BasicInfo",props:R({triggerDetails:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=o,i=T(o,"form"),{r$:a}=A(i,{name:{required:b}},{namespace:"station-webhooks"}),e=D(a),d=O(()=>i.value.type?vt(i.value.type):[]),f=O(()=>{const U=at(n.triggerDetails,...d.value);return Ie(U,(H,E)=>({value:E,text:H.title,description:H.description}))}),{$gettext:r,interpolate:u}=W(),x=r("%{seconds} seconds"),w=r("%{minutes} minutes"),I=r("%{hours} hours"),P=[{text:r("No Limit"),value:0},{text:u(x,{seconds:15}),value:15},{text:u(x,{seconds:30}),value:30},{text:u(x,{seconds:60}),value:60},{text:u(w,{minutes:2}),value:120},{text:u(w,{minutes:5}),value:300},{text:u(w,{minutes:10}),value:600},{text:u(w,{minutes:15}),value:900},{text:u(w,{minutes:30}),value:1800},{text:u(w,{minutes:60}),value:3600},{text:u(I,{hours:2}),value:7200},{text:u(I,{hours:3}),value:10800},{text:u(I,{hours:6}),value:21600},{text:u(I,{hours:12}),value:43200}];return(U,H)=>(g(),h(S,{label:t(r)("Basic Info"),"item-header-class":t(e)},{default:_(()=>[c("div",wt,[l(m,{id:"form_edit_name",class:"col-md-12",field:t(a).name,label:t(r)("Web Hook Name"),description:t(r)("Choose a name for this webhook that will help you distinguish it from others. This will only be shown on the administration page.")},null,8,["field","label","description"])]),c("div",Mt,[d.value.length>0?(g(),h(ne,{key:0,id:"edit_form_triggers",class:"col-md-7",field:t(a).triggers,options:f.value,stacked:"",label:t(r)("Web Hook Triggers"),description:t(r)("Select the event(s) that will trigger this webhook. If no events are selected, the webhook will run for all applicable events.")},null,8,["field","options","label","description"])):G("",!0),l(Ae,{id:"form_config_rate_limit",class:"col-md-5",field:t(a).config.rate_limit,options:P,label:t(r)("Only Trigger Once Every..."),description:t(r)("Use this setting to limit the rate of web hooks sent by the system. This can be useful to avoid rate limits on third party services.")},null,8,["field","label","description"])])]),_:1},8,["label","item-header-class"]))}}),At={class:"card-text"},Ct={class:"card-text"},Rt={href:"/api",target:"_blank"},St={class:"card-text"},Dt={class:"row g-3"},ie=k({__name:"Generic",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{webhook_url:{required:b}}},{namespace:"station-webhooks"}),a=D(i);return(e,d)=>(g(),h(S,{label:e.title,"item-header-class":t(a)},{default:_(()=>[l(ae,{id:"webhook_details"},{label:_(()=>[q(p(e.$gettext("Web Hook Details")),1)]),default:_(()=>[c("p",At,p(e.$gettext("Web hooks automatically send a HTTP POST request to the URL you specify to notify it any time one of the triggers you specify occurs on your station.")),1),c("p",Ct,p(e.$gettext("The body of the POST message is the exact same as the NowPlaying API response for your station.")),1),c("ul",null,[c("li",null,[c("a",Rt,p(e.$gettext("NowPlaying API Response")),1)])]),c("p",St,p(e.$gettext("In order to process quickly, web hooks have a short timeout, so the responding service should be optimized to handle the request in under 2 seconds.")),1)]),_:1}),c("div",Dt,[l(m,{id:"form_config_webhook_url",class:"col-md-12",field:t(i).config.webhook_url,"input-type":"url",label:e.$gettext("Web Hook URL"),description:e.$gettext("The URL that will receive the POST messages any time an event is triggered.")},null,8,["field","label","description"]),l(m,{id:"form_config_basic_auth_username",class:"col-md-6",field:t(i).config.basic_auth_username,label:e.$gettext("Optional: HTTP Basic Authentication Username"),description:e.$gettext("If your web hook requires HTTP basic authentication, provide the username here.")},null,8,["field","label","description"]),l(m,{id:"form_config_basic_auth_password",class:"col-md-6",field:t(i).config.basic_auth_password,label:e.$gettext("Optional: HTTP Basic Authentication Password"),description:e.$gettext("If your web hook requires HTTP basic authentication, provide the password here.")},null,8,["field","label","description"]),l(m,{id:"form_config_timeout",class:"col-md-6",field:t(i).config.timeout,"input-type":"number","input-attrs":{min:"0.0",max:"600.0",step:"0.1"},label:e.$gettext("Optional: Request Timeout (Seconds)"),description:e.$gettext("The number of seconds to wait for a response from the remote server before cancelling the request.")},null,8,["field","label","description"])])]),_:1},8,["label","item-header-class"]))}}),xt={class:"card-text"},It={class:"card-text"},Pt=["href"],F=k({__name:"FormattingInfo",setup(o){const n=_e("nowPlayingUrl");return(i,a)=>(g(),h(ae,{id:"customization_tips"},{label:_(()=>[q(p(i.$gettext("Message Customization Tips")),1)]),default:_(()=>[c("p",xt,[q(p(i.$gettext("Variables are in the form of: "))+" ",1),a[0]||(a[0]=c("code",null,"{{ var.name }}",-1))]),c("p",It,[q(p(i.$gettext("All values in the NowPlaying API response are available for use. Any empty fields are ignored."))+" ",1),a[1]||(a[1]=c("br",null,null,-1)),c("a",{href:t(n),target:"_blank"},p(i.$gettext("NowPlaying API Response")),9,Pt)])]),_:1}))}}),Lt={class:"row g-3 mb-3"},Gt={class:"row g-3"},Ut=k({__name:"Email",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{to:{required:b},subject:{required:b},message:{required:b}}},{namespace:"station-webhooks"}),a=D(i);return(e,d)=>(g(),h(S,{label:e.title,"item-header-class":t(a)},{default:_(()=>[c("div",Lt,[l(m,{id:"form_config_to",class:"col-md-12",field:t(i).config.to,label:e.$gettext("Message Recipient(s)"),description:e.$gettext("E-mail addresses can be separated by commas.")},null,8,["field","label","description"])]),l(F),c("div",Gt,[l(m,{id:"form_config_subject",class:"col-md-12",field:t(i).config.subject,label:e.$gettext("Message Subject")},null,8,["field","label"]),l(m,{id:"form_config_message",class:"col-md-12",field:t(i).config.message,label:e.$gettext("Message Body"),"input-type":"textarea","input-attrs":{rows:4}},null,8,["field","label"])])]),_:1},8,["label","item-header-class"]))}}),Bt={class:"row g-3"},Ot=k({__name:"Tunein",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{station_id:{required:b},partner_id:{required:b},partner_key:{required:b}}},{namespace:"station-webhooks"}),a=D(i);return(e,d)=>(g(),h(S,{label:e.title,"item-header-class":t(a)},{default:_(()=>[c("div",Bt,[l(m,{id:"form_config_station_id",class:"col-md-6",field:t(i).config.station_id,label:e.$gettext("TuneIn Station ID"),description:e.$gettext("The station ID will be a numeric string that starts with the letter S.")},null,8,["field","label","description"]),l(m,{id:"form_config_partner_id",class:"col-md-6",field:t(i).config.partner_id,label:e.$gettext("TuneIn Partner ID")},null,8,["field","label"]),l(m,{id:"form_config_partner_key",class:"col-md-6",field:t(i).config.partner_key,label:e.$gettext("TuneIn Partner Key")},null,8,["field","label"])])]),_:1},8,["label","item-header-class"]))}}),qt={class:"row g-3 mb-3"},Wt={class:"row g-3"},Ht=k({__name:"Discord",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{webhook_url:{required:b},color:{isValidHexColor:Ce}}},{namespace:"station-webhooks"}),a=D(i);return(e,d)=>(g(),h(S,{label:e.title,"item-header-class":t(a)},{default:_(()=>[c("div",qt,[l(m,{id:"form_config_webhook_url",class:"col-md-12",field:t(i).config.webhook_url,"input-type":"url",label:e.$gettext("Discord Web Hook URL"),description:e.$gettext("This URL is provided within the Discord application.")},null,8,["field","label","description"])]),l(F),c("div",Wt,[l(m,{id:"form_config_content",class:"col-md-6",field:t(i).config.content,"input-type":"textarea",label:e.$gettext("Main Message Content")},null,8,["field","label"]),l(m,{id:"form_config_title",class:"col-md-6",field:t(i).config.title,label:e.$gettext("Title")},null,8,["field","label"]),l(m,{id:"form_config_description",class:"col-md-6",field:t(i).config.description,"input-type":"textarea",label:e.$gettext("Description")},null,8,["field","label"]),l(m,{id:"form_config_url",class:"col-md-6",field:t(i).config.url,"input-type":"url",label:e.$gettext("URL")},null,8,["field","label"]),l(m,{id:"form_config_author",class:"col-md-6",field:t(i).config.author,label:e.$gettext("Author")},null,8,["field","label"]),l(m,{id:"form_config_thumbnail",class:"col-md-6",field:t(i).config.thumbnail,"input-type":"url",label:e.$gettext("Thumbnail Image URL")},null,8,["field","label"]),l(m,{id:"form_config_footer",class:"col-md-6",field:t(i).config.footer,label:e.$gettext("Footer Text")},null,8,["field","label"]),l(m,{id:"form_config_color",class:"col-md-6",field:t(i).config.color,label:e.$gettext("Embed Color (Hex)")},null,8,["field","label"]),l(Pe,{id:"form_config_include_timestamp",class:"col-md-12",field:t(i).config.include_timestamp,label:e.$gettext("Include Timestamp"),description:e.$gettext("If set, the time sent will be included in the embed footer.")},null,8,["field","label","description"])])]),_:1},8,["label","item-header-class"]))}}),Et={class:"row g-3 mb-3"},Nt={href:"https://core.telegram.org/bots#botfather",target:"_blank"},Vt={class:"row g-3"},jt={href:"https://core.telegram.org/bots/api#sendmessage",target:"_blank"},Ft=k({__name:"Telegram",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{bot_token:{required:b},chat_id:{required:b},text:{required:b},parse_mode:{required:b}}},{namespace:"station-webhooks"}),a=D(i),{$gettext:e}=W(),d=O(()=>[{text:e("Markdown"),value:"Markdown"},{text:e("HTML"),value:"HTML"}]);return(f,r)=>(g(),h(S,{label:f.title,"item-header-class":t(a)},{default:_(()=>[c("div",Et,[l(m,{id:"form_config_bot_token",class:"col-md-6",field:t(i).config.bot_token,label:t(e)("Bot Token")},{description:_(()=>[c("a",Nt,p(t(e)("See the Telegram Documentation for more details.")),1)]),_:1},8,["field","label"]),l(m,{id:"form_config_chat_id",class:"col-md-6",field:t(i).config.chat_id,label:t(e)("Chat ID"),description:t(e)("Unique identifier for the target chat or username of the target channel (in the format @channelusername).")},null,8,["field","label","description"]),l(m,{id:"form_config_api",class:"col-md-6",field:t(i).config.api,label:t(e)("Custom API Base URL"),description:t(e)("Leave blank to use the default Telegram API URL (recommended).")},null,8,["field","label","description"])]),l(F),c("div",Vt,[l(m,{id:"form_config_text",class:"col-md-12",field:t(i).config.text,"input-type":"textarea",label:t(e)("Main Message Content")},null,8,["field","label"]),l(ne,{id:"form_config_parse_mode",class:"col-md-12",field:t(i).config.parse_mode,options:d.value,stacked:"",radio:"",label:t(e)("Message parsing mode")},{description:_(()=>[c("a",jt,p(t(e)("See the Telegram documentation for more details.")),1)]),_:1},8,["field","options","label"])])]),_:1},8,["label","item-header-class"]))}}),zt={class:"row g-3"},Kt=k({__name:"GoogleAnalyticsV4",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{api_secret:{required:b},measurement_id:{required:b}}},{namespace:"station-webhooks"}),a=D(i);return(e,d)=>(g(),h(S,{label:e.title,"item-header-class":t(a)},{default:_(()=>[c("div",zt,[l(m,{id:"form_config_api_secret",class:"col-md-6",field:t(i).config.api_secret,label:e.$gettext("Measurement Protocol API Secret"),description:e.$gettext('This can be generated in the "Events" section for a measurement.')},null,8,["field","label","description"]),l(m,{id:"form_config_measurement_id",class:"col-md-6",field:t(i).config.measurement_id,label:e.$gettext("Measurement ID"),description:e.$gettext('A unique identifier (i.e. "G-A1B2C3D4") for this measurement stream.')},null,8,["field","label","description"])])]),_:1},8,["label","item-header-class"]))}}),Jt={class:"row g-3"},Qt=k({__name:"MatomoAnalytics",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{matomo_url:{required:b},site_id:{required:b}}},{namespace:"station-webhooks"}),a=D(i);return(e,d)=>(g(),h(S,{label:e.title,"item-header-class":t(a)},{default:_(()=>[c("div",Jt,[l(m,{id:"form_config_matomo_url",class:"col-md-12",field:t(i).config.matomo_url,"input-type":"url",label:e.$gettext("Matomo Installation Base URL"),description:e.$gettext("The full base URL of your Matomo installation.")},null,8,["field","label","description"]),l(m,{id:"form_config_site_id",class:"col-md-6",field:t(i).config.site_id,label:e.$gettext("Matomo Site ID"),description:e.$gettext("The numeric site ID for this site.")},null,8,["field","label","description"]),l(m,{id:"form_config_token",class:"col-md-6",field:t(i).config.token,label:e.$gettext("Matomo API Token"),description:e.$gettext("Optionally supply an API token to allow IP address overriding.")},null,8,["field","label","description"])])]),_:1},8,["label","item-header-class"]))}}),Yt={class:"row g-3"},fe=k({__name:"SocialPostFields",props:{form:{required:!0},formModifiers:{}},emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{},{namespace:"station-webhooks"}),a=e=>Le(n.value.triggers,e);return(e,d)=>(g(),C(B,null,[l(F),c("div",Yt,[a("song_changed")?(g(),h(m,{key:0,id:"form_config_message",class:"col-md-12",field:t(i).config.message,"input-type":"textarea",label:e.$gettext("Message Body on Song Change")},null,8,["field","label"])):G("",!0),a("song_changed_live")?(g(),h(m,{key:1,id:"form_config_message_song_changed_live",class:"col-md-12",field:t(i).config.message_song_changed_live,"input-type":"textarea",label:e.$gettext("Message Body on Song Change with Streamer/DJ Connected")},null,8,["field","label"])):G("",!0),a("live_connect")?(g(),h(m,{key:2,id:"form_config_message_live_connect",class:"col-md-12",field:t(i).config.message_live_connect,"input-type":"textarea",label:e.$gettext("Message Body on Streamer/DJ Connect")},null,8,["field","label"])):G("",!0),a("live_disconnect")?(g(),h(m,{key:3,id:"form_config_message_live_disconnect",class:"col-md-12",field:t(i).config.message_live_disconnect,"input-type":"textarea",label:e.$gettext("Message Body on Streamer/DJ Disconnect")},null,8,["field","label"])):G("",!0),a("station_offline")?(g(),h(m,{key:4,id:"form_config_message_station_offline",class:"col-md-12",field:t(i).config.message_station_offline,"input-type":"textarea",label:e.$gettext("Message Body on Station Offline")},null,8,["field","label"])):G("",!0),a("station_online")?(g(),h(m,{key:5,id:"form_config_message_station_online",class:"col-md-12",field:t(i).config.message_station_online,"input-type":"textarea",label:e.$gettext("Message Body on Station Online")},null,8,["field","label"])):G("",!0)])],64))}}),Xt={class:"card-text"},Zt={class:"card-text"},eo={class:"row g-3 mb-3"},to={class:"row g-3 mb-3"},oo=k({__name:"Mastodon",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{instance_url:{required:b},access_token:{required:b},visibility:{required:b}}},{namespace:"station-webhooks"}),a=D(i),{$gettext:e}=W(),d=O(()=>[{text:e("Public"),value:"public"},{text:e("Unlisted"),value:"unlisted"},{text:e("Followers Only"),value:"private"}]);return(f,r)=>(g(),h(S,{label:f.title,"item-header-class":t(a)},{default:_(()=>[l(ae,{id:"mastodon_details"},{label:_(()=>[q(p(t(e)("Mastodon Account Details")),1)]),default:_(()=>[c("p",Xt,p(t(e)("Steps for configuring a Mastodon application:")),1),c("ul",null,[c("li",null,p(t(e)("Visit your Mastodon instance.")),1),c("li",null,p(t(e)('Click the "Preferences" link, then "Development" on the left side menu.')),1),c("li",null,p(t(e)('Click "New Application"')),1),c("li",null,p(t(e)('Enter "AzuraCast" as the application name. You can leave the URL fields unchanged. For "Scopes", only "write:media" and "write:statuses" are required.')),1)]),c("p",Zt,p(t(e)(`Once these steps are completed, enter the "Access Token" from the application's page into the field below.`)),1)]),_:1}),c("div",eo,[l(m,{id:"form_config_instance_url",class:"col-md-6",field:t(i).config.instance_url,label:t(e)("Mastodon Instance URL"),description:t(e)('If your Mastodon username is "@test@example.com", enter "example.com".')},null,8,["field","label","description"]),l(m,{id:"form_config_access_token",class:"col-md-6",field:t(i).config.access_token,label:t(e)("Access Token")},null,8,["field","label"])]),c("div",to,[l(ne,{id:"form_config_visibility",class:"col-md-12",field:t(i).config.visibility,options:d.value,stacked:"",radio:"",label:t(e)("Message Visibility")},null,8,["field","options","label"])]),l(fe,{form:n.value,"onUpdate:form":r[0]||(r[0]=u=>n.value=u)},null,8,["form"])]),_:1},8,["label","item-header-class"]))}}),io={class:"row g-3"},so=k({__name:"RadioDe",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{broadcastsubdomain:{required:b},apikey:{required:b}}},{namespace:"station-webhooks"}),a=D(i);return(e,d)=>(g(),h(S,{label:e.title,"item-header-class":t(a)},{default:_(()=>[c("div",io,[l(m,{id:"form_config_broadcastsubdomain",class:"col-md-12",field:t(i).config.broadcastsubdomain,label:e.$gettext("Radio.de Broadcast Subdomain")},null,8,["field","label"]),l(m,{id:"form_config_apikey",class:"col-md-6",field:t(i).config.apikey,label:e.$gettext("Radio.de API Key")},null,8,["field","label"])])]),_:1},8,["label","item-header-class"]))}}),no={class:"row g-3"},ao=k({__name:"GetMeRadio",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{token:{required:b},station_id:{required:b}}},{namespace:"station-webhooks"}),a=D(i);return(e,d)=>(g(),h(S,{label:e.title,"item-header-class":t(a)},{default:_(()=>[c("div",no,[l(m,{id:"form_config_token",class:"col-md-6",field:t(i).config.token,label:e.$gettext("API Token"),description:e.$gettext("This can be retrieved from the GetMeRadio dashboard.")},null,8,["field","label","description"]),l(m,{id:"form_config_station_id",class:"col-md-6",field:t(i).config.station_id,label:e.$gettext("GetMeRadio Station ID"),description:e.$gettext("This is a 3-5 digit number.")},null,8,["field","label","description"])])]),_:1},8,["label","item-header-class"]))}}),lo={class:"row g-3"},ro=k({__name:"RadioReg",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{webhookurl:{required:b},apikey:{required:b}}},{namespace:"station-webhooks"}),a=D(i);return(e,d)=>(g(),h(S,{label:e.title,"item-header-class":t(a)},{default:_(()=>[c("div",lo,[l(m,{id:"form_config_webhookurl",class:"col-md-12",field:t(i).config.webhookurl,label:e.$gettext("RadioReg Webhook URL"),description:e.$gettext("Found under the settings page for the corresponding RadioReg station.")},null,8,["field","label","description"]),l(m,{id:"form_config_apikey",class:"col-md-6",field:t(i).config.apikey,label:e.$gettext("RadioReg Organization API Key"),description:e.$gettext("An API token is issued on a per-organization basis and are found on the org. settings page.")},null,8,["field","label","description"])])]),_:1},8,["label","item-header-class"]))}}),co={class:"row g-3 mb-3"},mo={href:"https://dev.groupme.com/tutorials/bots",target:"_blank"},fo={class:"row g-3"},uo=k({__name:"GroupMe",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{bot_id:{required:b},text:{required:b}}},{namespace:"station-webhooks"}),a=D(i);return(e,d)=>(g(),h(S,{label:e.title,"item-header-class":t(a)},{default:_(()=>[c("div",co,[l(m,{id:"form_config_bot_id",class:"col-md-6",field:t(i).config.bot_id,label:e.$gettext("Bot ID")},{description:_(()=>[c("a",mo,p(e.$gettext("See the GroupMe Documentation for more details.")),1)]),_:1},8,["field","label"]),l(m,{id:"form_config_api",class:"col-md-6",field:t(i).config.api,label:e.$gettext("Custom API Base URL"),description:e.$gettext("Leave blank to use the default GroupMe API URL (recommended).")},null,8,["field","label","description"])]),l(F),c("div",fo,[l(m,{id:"form_config_text",class:"col-md-12",field:t(i).config.text,"input-type":"textarea",label:e.$gettext("Main Message Content")},null,8,["field","label"])])]),_:1},8,["label","item-header-class"]))}}),go={class:"row g-3 mb-3"},po=k({__name:"Bluesky",props:R({title:{}},{form:{required:!0},formModifiers:{}}),emits:["update:form"],setup(o){const n=T(o,"form"),{r$:i}=A(n,{config:{handle:{required:b},app_password:{required:b}}},{namespace:"station-webhooks"}),a=D(i);return(e,d)=>(g(),h(S,{label:e.title,"item-header-class":t(a)},{default:_(()=>[c("div",go,[l(m,{id:"form_config_username",class:"col-md-6",field:t(i).config.handle,label:e.$gettext("Bluesky Handle"),description:e.$gettext("The username associated with your account.")},null,8,["field","label","description"]),l(m,{id:"form_config_password",class:"col-md-6",field:t(i).config.app_password,label:e.$gettext("App Password"),description:e.$gettext("Create a new App Password for this service, then enter the key here (i.e. 0123-abcd-4567)")},null,8,["field","label","description"])]),l(fe,{form:n.value,"onUpdate:form":d[0]||(d[0]=f=>n.value=f)},null,8,["form"])]),_:1},8,["label","item-header-class"]))}}),_o=()=>{const{$gettext:o}=W(),n=be(null),{record:i,reset:a}=Oe(()=>{const d={name:"",triggers:[],config:{rate_limit:0}},f={message:o("Now playing on %{station}: %{title} by %{artist}! Tune in now: %{url}",{station:"{{ station.name }}",title:"{{ now_playing.song.title }}",artist:"{{ now_playing.song.artist }}",url:"{{ station.public_player_url }}"}),message_song_changed_live:o("Now playing on %{station}: %{title} by %{artist} with your host, %{dj}! Tune in now: %{url}",{station:"{{ station.name }}",title:"{{ now_playing.song.title }}",artist:"{{ now_playing.song.artist }}",dj:"{{ live.streamer_name }}",url:"{{ station.public_player_url }}"}),message_live_connect:o("%{dj} is now live on %{station}! Tune in now: %{url}",{dj:"{{ live.streamer_name }}",station:"{{ station.name }}",url:"{{ station.public_player_url }}"}),message_live_disconnect:o("Thanks for listening to %{station}!",{station:"{{ station.name }}"}),message_station_offline:o("%{station} is going offline for now.",{station:"{{ station.name }}"}),message_station_online:o("%{station} is back online! Tune in now: %{url}",{station:"{{ station.name }}",url:"{{ station.public_player_url }}"})};let r={type:null};switch(n.value){case s.Generic:r={type:s.Generic,config:{webhook_url:"",basic_auth_username:"",basic_auth_password:"",timeout:5}};break;case s.Bluesky:r={type:s.Bluesky,config:{handle:"",app_password:"",...f}};break;case s.Discord:r={type:s.Discord,config:{webhook_url:"",content:o("Now playing on %{station}:",{station:"{{ station.name }}"}),title:"{{ now_playing.song.title }}",description:"{{ now_playing.song.artist }}",url:"{{ station.listen_url }}",author:"{{ live.streamer_name }}",thumbnail:"{{ now_playing.song.art }}",footer:o("Powered by AzuraCast"),color:"#2196F3",include_timestamp:!0}};break;case s.Email:r={type:s.Email,config:{to:"",subject:"",message:""}};break;case s.GetMeRadio:r={type:s.GetMeRadio,config:{token:"",station_id:""}};break;case s.GoogleAnalyticsV4:r={type:s.GoogleAnalyticsV4,config:{api_secret:"",measurement_id:""}};break;case s.GroupMe:r={type:s.GroupMe,config:{bot_id:"",api:"",text:o("Now playing on %{station}: %{title} by %{artist}! Tune in now.",{station:"{{ station.name }}",title:"{{ now_playing.song.title }}",artist:"{{ now_playing.song.artist }}"})}};break;case s.Mastodon:r={type:s.Mastodon,config:{instance_url:"",access_token:"",visibility:"public",...f}};break;case s.MatomoAnalytics:r={type:s.MatomoAnalytics,config:{matomo_url:"",site_id:"",token:""}};break;case s.RadioDe:r={type:s.RadioDe,config:{broadcastsubdomain:"",apikey:""}};break;case s.RadioReg:r={type:s.RadioReg,config:{webhookurl:"",apikey:""}};break;case s.Telegram:r={type:s.Telegram,config:{bot_token:"",chat_id:"",api:"",text:o("Now playing on %{station}: %{title} by %{artist}! Tune in now.",{station:"{{ station.name }}",title:"{{ now_playing.song.title }}",artist:"{{ now_playing.song.artist }}"}),parse_mode:"Markdown"}};break;case s.TuneIn:r={type:s.TuneIn,config:{station_id:"",partner_id:"",partner_key:""}};break}return nt(d,r)});return{type:n,setType:d=>{n.value=d,a()},form:i,resetForm:a}},bo=k({__name:"EditModal",props:{nowPlayingUrl:{},typeDetails:{},triggerDetails:{},createUrl:{}},emits:["relist"],setup(o,{expose:n,emit:i}){const a=o;he("nowPlayingUrl",a.nowPlayingUrl);const e=i,d=se("$modal"),{form:f,resetForm:r,type:u,setType:x}=_o(),{r$:w}=Re("station-webhooks"),I=()=>{r(),w.$reset()},P={[s.Generic]:ie,[s.Email]:Ut,[s.TuneIn]:Ot,[s.RadioDe]:so,[s.RadioReg]:ro,[s.GetMeRadio]:ao,[s.Discord]:Ht,[s.Telegram]:Ft,[s.GroupMe]:uo,[s.Mastodon]:oo,[s.Bluesky]:po,[s.GoogleAnalyticsV4]:Kt,[s.MatomoAnalytics]:Qt},U=O(()=>u.value===null?null:j(a.typeDetails,[u.value,"title"],"")),H=O(()=>u.value===null?ie:j(P,u.value,ie)),{loading:E,error:X,isEditMode:Z,clearContents:z,create:N,edit:ee,doSubmit:te,close:K}=Ge(ye(a,"createUrl"),e,d,I,M=>{M.type&&x(M.type),ke(()=>{f.value=Be(f.value,M)}),w.$reset()},async()=>{const{valid:M}=await w.$validate();return{valid:M,data:f.value}}),oe=()=>{x(null),z()},{$gettext:V}=W(),v=O(()=>Z.value?V("Edit Web Hook"):u.value?V("Add Web Hook"):V("Select Web Hook Type"));return n({create:N,edit:ee,close:K}),(M,y)=>(g(),h(Ue,{ref_key:"$modal",ref:d,loading:t(E),title:v.value,error:t(X),"disable-save-button":t(w).$invalid,onSubmit:t(te),onHidden:oe},{default:_(()=>[t(u)?(g(),h(Te,{key:1},{default:_(()=>[l(Tt,{form:t(f),"onUpdate:form":y[0]||(y[0]=L=>le(f)?f.value=L:null),"trigger-details":M.triggerDetails},null,8,["form","trigger-details"]),(g(),h($e(H.value),{form:t(f),"onUpdate:form":y[1]||(y[1]=L=>le(f)?f.value=L:null),title:U.value},null,40,["form","title"]))]),_:1})):(g(),h(bt,{key:0,"type-details":M.typeDetails,onSelect:t(x)},null,8,["type-details","onSelect"]))]),_:1},8,["loading","title","error","disable-save-button","onSubmit"]))}}),ho={class:"card-text"},yo={class:"typography-subheading"},$o={key:0,class:"badge bg-danger"},ko={class:"btn-group btn-group-sm"},vo=["onClick"],wo=["onClick"],Mo=["onClick"],To=["onClick"],Ao=["onClick"],ki=k({__name:"Webhooks",setup(o){const n=Ye("/webhooks"),i=Xe(),a=Ze(O(()=>`/nowplaying/${i.value}`)),{$gettext:e}=W(),d=[{key:"name",isRowHeader:!0,label:e("Name/Type"),sortable:!0},{key:"triggers",label:e("Triggers"),sortable:!1},{key:"actions",label:e("Actions"),sortable:!1,class:"shrink"}],f=ot(n,et([tt.StationWebhooks])),r=()=>{f.refresh()},u=kt(),x=$t(),w=v=>v.is_enabled?e("Disable"):e("Enable"),I=v=>v.is_enabled?"btn-warning":"btn-success",P=v=>v in u,U=v=>j(u,[v,"title"],""),H=v=>v.map(M=>j(x,[M,"title"],"")),E=se("$editModal"),{doCreate:X,doEdit:Z}=ze(E),{notifySuccess:z}=we(),{axios:N}=Me(),ee=async v=>{const{data:M}=await N.put(v);z(M.message),r()},te=async v=>{await N.post(v),z(e("Webhook duplicated.")),r()},K=se("$logModal"),oe=async v=>{const{data:M}=await N.put(v);K.value?.show(M.logUrl)},{doDelete:V}=Je(e("Delete Web Hook?"),()=>r());return(v,M)=>(g(),C(B,null,[l(Qe,{title:t(e)("Web Hooks")},{info:_(()=>[c("p",ho,p(t(e)("Web hooks let you connect to external web services and broadcast changes to your station to them.")),1)]),actions:_(()=>[l(Ke,{text:t(e)("Add Web Hook"),onClick:t(X)},null,8,["text","onClick"])]),default:_(()=>[l(ge,{id:"station_webhooks",fields:d,provider:t(f)},{"cell(name)":_(({item:y})=>[c("div",yo,p(y.name),1),P(y.type)?(g(),C(B,{key:0},[q(p(U(y.type))+" ",1),y.is_enabled?G("",!0):(g(),C("div",$o,p(t(e)("Disabled")),1))],64)):(g(),C(B,{key:1},[q(p(t(e)("This web hook is no longer supported. Removing it is recommended.")),1)],64))]),"cell(triggers)":_(({item:y})=>[P(y.type)&&y.triggers.length>0?(g(!0),C(B,{key:0},me(H(y.triggers),(L,ue)=>(g(),C("div",{key:y.id+"_"+ue,class:"small"},p(L),1))),128)):(g(),C(B,{key:1},[q("   ")],64))]),"cell(actions)":_(({item:y})=>[c("div",ko,[P(y.type)?(g(),C(B,{key:0},[c("button",{type:"button",class:"btn btn-primary",onClick:L=>t(Z)(y.links.self)},p(t(e)("Edit")),9,vo),c("button",{type:"button",class:ve(["btn",I(y)]),onClick:L=>ee(y.links.toggle)},p(w(y)),11,wo),c("button",{type:"button",class:"btn btn-secondary",onClick:L=>oe(y.links.test)},p(t(e)("Test")),9,Mo),c("button",{type:"button",class:"btn btn-info",onClick:L=>te(y.links.clone)},p(t(e)("Duplicate")),9,To)],64)):G("",!0),c("button",{type:"button",class:"btn btn-danger",onClick:L=>t(V)(y.links.self)},p(t(e)("Delete")),9,Ao)])]),_:1},8,["provider"])]),_:1},8,["title"]),l(Fe,{ref_key:"$logModal",ref:K},null,512),l(bo,{ref_key:"$editModal",ref:E,"create-url":t(n),"type-details":t(u),"trigger-details":t(x),"now-playing-url":t(a),onRelist:r},null,8,["create-url","type-details","trigger-details","now-playing-url"])],64))}});export{ki as default};
