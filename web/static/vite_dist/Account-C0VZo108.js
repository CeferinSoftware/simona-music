import{_ as Z,H as Oe,J as Je,K as Ce,I as Ye,L as je}from"./icons-BAjd3tML.js";import{m as Ge}from"./mergeExisting-B6FvxI3v.js";import{u as st,r as z,e as Qe,m as We,w as Xe,i as Ze}from"./regle-hGsoY2W9.js";import{_ as Vt}from"./ModalForm-D0z4l5nm.js";import{g as it,f as Ee,u as et,R as ut,a3 as tn,a as en}from"./layout-CUzOT8aY.js";import{g as tt,a as nn,Q as Ft}from"./useStationQuery-ClAZEJp_.js";import{u as ct,_ as Ae}from"./useHasModal-Bq3QxExQ.js";import{_ as $e}from"./FormGroupMultiCheck-z3kTFzdV.js";import{_ as Y}from"./FormGroupField-K9S4Sadl.js";import{u as on}from"./ValidationError-DsAp6Fjg.js";import{d as q,q as qt,m as j,o as D,p as rn,u as p,r as H,g as F,e as L,a as _,b as T,h as sn,c as U,t as R,i as xt,f as nt,k as Pe,s as ke,L as Be,M as Se,w as Re,v as Ie,l as Me,F as zt,n as an}from"./vue-BsfewpWM.js";import{a as ln}from"./FormMultiCheck-RiRcopXY.js";import{_ as un}from"./UserInfoPanel-CZjNR-4w.js";import{_ as Te}from"./CardPage-Cth3uewv.js";import{_ as cn}from"./EnabledBadge-BJcmite3.js";import{_ as dn}from"./Loading-CQdAiB8R.js";import{_ as Ne}from"./CopyToClipboardButton-DQd5D5nJ.js";import{_ as fn}from"./FormFieldset-DUBDY7k3.js";import{u as hn}from"./useResettableRef-BwkDrsai.js";import{u as Kt}from"./useConfirmAndDelete-CuQodV6V.js";import{_ as De}from"./DataTable-BhAO7RbG.js";import{I as Le}from"./InvisibleSubmitButton-NGv_v7G8.js";import{_ as gn}from"./FormMarkup-DqBjuQjX.js";import{u as mn}from"./useWebAuthn-Dxtp442E.js";import{u as Ue}from"./useApiItemProvider-DAIhDonu.js";import{_ as pn}from"./DashboardNoSidebar-Cg7D8DtY.js";import"./estoolkit-DCzBkaPJ.js";import"./leaflet-DkUWBo0d.js";import"./zxcvbn-Bgw4VUEj.js";import"./useSlotsExcept-Dp0PSXNw.js";import"./map-Caxea7Kw.js";import"./isArrayLike-DknTMkCU.js";import"./iteratee-DJRL6CbS.js";import"./hlsjs-BVyhFw5s.js";import"./bootstrap.esm-30QIU_ZL.js";import"./vue-router-Cafqdr3I.js";import"./FormGroup-DXDHSoyc.js";import"./InfoCard-D5Q671bF.js";import"./FormCheckbox-Cc7beVle.js";import"./isTypedArray-By1PpNM0.js";import"./some-B0KiPFWm.js";import"./forEach-BFcv9GyE.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./PanelFooter-D_-n9Oyr.js";const yn=q({__name:"TimeRadios",props:{required:{type:Boolean},modelValue:{type:[Boolean,null]},field:{},id:{}},emits:["update:modelValue"],setup(r,{emit:o}){const s=r,n=o,{model:t}=on(s,n),e=qt({get(){const a=t.value;return a===!0?"true":a===!1?"false":""},set(a){a===!0||a==="true"?t.value=!0:a===!1||a==="false"?t.value=!1:t.value=null}}),{$gettext:i}=it(),l=qt(()=>[{text:i("Prefer System Default"),value:""},{text:i("12 Hour"),value:"false"},{text:i("24 Hour"),value:"true"}]);return(a,u)=>(D(),j($e,rn({id:a.id},a.$attrs,{modelValue:e.value,"onUpdate:modelValue":u[0]||(u[0]=f=>e.value=f),options:l.value,stacked:"",radio:"",label:p(i)("Time Display")}),null,16,["id","modelValue","options","label"]))}}),wn={class:"row g-3"},_n={class:"col-md-6"},bn={class:"col-md-6"},vn=q({__name:"EditModal",props:{supportedLocales:{}},emits:["reload"],setup(r,{expose:o,emit:s}){const n=r,t=s,e=tt("/frontend/account/me"),i=H(!0),l=H(null),{r$:a}=st({name:"",email:"",locale:"default",show_24_hour_time:!1},{name:{},email:{required:z,email:Qe},locale:{required:z},show_24_hour_time:{}},{}),u=()=>{a.$reset({toOriginalState:!0}),i.value=!1,l.value=null},f=F("$modal"),{show:c,hide:y}=ct(f),{notifySuccess:h}=Ee(),{axios:v}=et(),P=async()=>{u(),c();try{const{data:d}=await v.get(e.value);a.$reset({toState:Ge(a.$value,d)}),i.value=!1}catch{y()}},N=()=>{P()},{$gettext:w}=it(),k=qt(()=>{const d=ln(n.supportedLocales).value;return d.unshift({text:w("Use Browser Default"),value:"default"}),d}),g=async()=>{const{valid:d,data:I}=await a.$validate();if(d){l.value=null;try{await v({method:"PUT",url:e.value,data:I}),h(),t("reload"),y()}catch(m){l.value=ut(m)}}};return o({open:N}),(d,I)=>(D(),j(Vt,{ref_key:"$modal",ref:f,loading:i.value,title:p(w)("Edit Profile"),error:l.value,"disable-save-button":p(a).$invalid,onSubmit:g,onHidden:u},{default:L(()=>[_("div",wn,[_("div",_n,[T(Y,{id:"form_name",class:"mb-3",tabindex:"1",field:p(a).name,label:p(w)("Name")},null,8,["field","label"]),T(Y,{id:"form_email",class:"mb-3",tabindex:"2",field:p(a).email,label:p(w)("E-mail Address")},null,8,["field","label"]),T(yn,{id:"edit_form_show_24_hour_time",class:"mb-3",tabindex:"3",field:p(a).show_24_hour_time},null,8,["field"])]),_("div",bn,[T($e,{id:"edit_form_locale",tabindex:"4",field:p(a).locale,options:k.value,stacked:"",radio:"",label:p(w)("Language")},null,8,["field","options","label"])])])]),_:1},8,["loading","title","error","disable-save-button"]))}});var X={},mt,jt;function Cn(){return jt||(jt=1,mt=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),mt}var pt={},J={},Gt;function G(){if(Gt)return J;Gt=1;let r;const o=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return J.getSymbolSize=function(n){if(!n)throw new Error('"version" cannot be null or undefined');if(n<1||n>40)throw new Error('"version" should be in range from 1 to 40');return n*4+17},J.getSymbolTotalCodewords=function(n){return o[n]},J.getBCHDigit=function(s){let n=0;for(;s!==0;)n++,s>>>=1;return n},J.setToSJISFunction=function(n){if(typeof n!="function")throw new Error('"toSJISFunc" is not a valid function.');r=n},J.isKanjiModeEnabled=function(){return typeof r<"u"},J.toSJIS=function(n){return r(n)},J}var yt={},Qt;function Ht(){return Qt||(Qt=1,(function(r){r.L={bit:1},r.M={bit:0},r.Q={bit:3},r.H={bit:2};function o(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return r.L;case"m":case"medium":return r.M;case"q":case"quartile":return r.Q;case"h":case"high":return r.H;default:throw new Error("Unknown EC Level: "+s)}}r.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},r.from=function(n,t){if(r.isValid(n))return n;try{return o(n)}catch{return t}}})(yt)),yt}var wt,Wt;function En(){if(Wt)return wt;Wt=1;function r(){this.buffer=[],this.length=0}return r.prototype={get:function(o){const s=Math.floor(o/8);return(this.buffer[s]>>>7-o%8&1)===1},put:function(o,s){for(let n=0;n<s;n++)this.putBit((o>>>s-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(o){const s=Math.floor(this.length/8);this.buffer.length<=s&&this.buffer.push(0),o&&(this.buffer[s]|=128>>>this.length%8),this.length++}},wt=r,wt}var _t,Xt;function An(){if(Xt)return _t;Xt=1;function r(o){if(!o||o<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=o,this.data=new Uint8Array(o*o),this.reservedBit=new Uint8Array(o*o)}return r.prototype.set=function(o,s,n,t){const e=o*this.size+s;this.data[e]=n,t&&(this.reservedBit[e]=!0)},r.prototype.get=function(o,s){return this.data[o*this.size+s]},r.prototype.xor=function(o,s,n){this.data[o*this.size+s]^=n},r.prototype.isReserved=function(o,s){return this.reservedBit[o*this.size+s]},_t=r,_t}var bt={},Zt;function $n(){return Zt||(Zt=1,(function(r){const o=G().getSymbolSize;r.getRowColCoords=function(n){if(n===1)return[];const t=Math.floor(n/7)+2,e=o(n),i=e===145?26:Math.ceil((e-13)/(2*t-2))*2,l=[e-7];for(let a=1;a<t-1;a++)l[a]=l[a-1]-i;return l.push(6),l.reverse()},r.getPositions=function(n){const t=[],e=r.getRowColCoords(n),i=e.length;for(let l=0;l<i;l++)for(let a=0;a<i;a++)l===0&&a===0||l===0&&a===i-1||l===i-1&&a===0||t.push([e[l],e[a]]);return t}})(bt)),bt}var vt={},te;function Pn(){if(te)return vt;te=1;const r=G().getSymbolSize,o=7;return vt.getPositions=function(n){const t=r(n);return[[0,0],[t-o,0],[0,t-o]]},vt}var Ct={},ee;function kn(){return ee||(ee=1,(function(r){r.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const o={N1:3,N2:3,N3:40,N4:10};r.isValid=function(t){return t!=null&&t!==""&&!isNaN(t)&&t>=0&&t<=7},r.from=function(t){return r.isValid(t)?parseInt(t,10):void 0},r.getPenaltyN1=function(t){const e=t.size;let i=0,l=0,a=0,u=null,f=null;for(let c=0;c<e;c++){l=a=0,u=f=null;for(let y=0;y<e;y++){let h=t.get(c,y);h===u?l++:(l>=5&&(i+=o.N1+(l-5)),u=h,l=1),h=t.get(y,c),h===f?a++:(a>=5&&(i+=o.N1+(a-5)),f=h,a=1)}l>=5&&(i+=o.N1+(l-5)),a>=5&&(i+=o.N1+(a-5))}return i},r.getPenaltyN2=function(t){const e=t.size;let i=0;for(let l=0;l<e-1;l++)for(let a=0;a<e-1;a++){const u=t.get(l,a)+t.get(l,a+1)+t.get(l+1,a)+t.get(l+1,a+1);(u===4||u===0)&&i++}return i*o.N2},r.getPenaltyN3=function(t){const e=t.size;let i=0,l=0,a=0;for(let u=0;u<e;u++){l=a=0;for(let f=0;f<e;f++)l=l<<1&2047|t.get(u,f),f>=10&&(l===1488||l===93)&&i++,a=a<<1&2047|t.get(f,u),f>=10&&(a===1488||a===93)&&i++}return i*o.N3},r.getPenaltyN4=function(t){let e=0;const i=t.data.length;for(let a=0;a<i;a++)e+=t.data[a];return Math.abs(Math.ceil(e*100/i/5)-10)*o.N4};function s(n,t,e){switch(n){case r.Patterns.PATTERN000:return(t+e)%2===0;case r.Patterns.PATTERN001:return t%2===0;case r.Patterns.PATTERN010:return e%3===0;case r.Patterns.PATTERN011:return(t+e)%3===0;case r.Patterns.PATTERN100:return(Math.floor(t/2)+Math.floor(e/3))%2===0;case r.Patterns.PATTERN101:return t*e%2+t*e%3===0;case r.Patterns.PATTERN110:return(t*e%2+t*e%3)%2===0;case r.Patterns.PATTERN111:return(t*e%3+(t+e)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}r.applyMask=function(t,e){const i=e.size;for(let l=0;l<i;l++)for(let a=0;a<i;a++)e.isReserved(a,l)||e.xor(a,l,s(t,a,l))},r.getBestMask=function(t,e){const i=Object.keys(r.Patterns).length;let l=0,a=1/0;for(let u=0;u<i;u++){e(u),r.applyMask(u,t);const f=r.getPenaltyN1(t)+r.getPenaltyN2(t)+r.getPenaltyN3(t)+r.getPenaltyN4(t);r.applyMask(u,t),f<a&&(a=f,l=u)}return l}})(Ct)),Ct}var lt={},ne;function Fe(){if(ne)return lt;ne=1;const r=Ht(),o=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],s=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return lt.getBlocksCount=function(t,e){switch(e){case r.L:return o[(t-1)*4+0];case r.M:return o[(t-1)*4+1];case r.Q:return o[(t-1)*4+2];case r.H:return o[(t-1)*4+3];default:return}},lt.getTotalCodewordsCount=function(t,e){switch(e){case r.L:return s[(t-1)*4+0];case r.M:return s[(t-1)*4+1];case r.Q:return s[(t-1)*4+2];case r.H:return s[(t-1)*4+3];default:return}},lt}var Et={},rt={},oe;function Bn(){if(oe)return rt;oe=1;const r=new Uint8Array(512),o=new Uint8Array(256);return(function(){let n=1;for(let t=0;t<255;t++)r[t]=n,o[n]=t,n<<=1,n&256&&(n^=285);for(let t=255;t<512;t++)r[t]=r[t-255]})(),rt.log=function(n){if(n<1)throw new Error("log("+n+")");return o[n]},rt.exp=function(n){return r[n]},rt.mul=function(n,t){return n===0||t===0?0:r[o[n]+o[t]]},rt}var re;function Sn(){return re||(re=1,(function(r){const o=Bn();r.mul=function(n,t){const e=new Uint8Array(n.length+t.length-1);for(let i=0;i<n.length;i++)for(let l=0;l<t.length;l++)e[i+l]^=o.mul(n[i],t[l]);return e},r.mod=function(n,t){let e=new Uint8Array(n);for(;e.length-t.length>=0;){const i=e[0];for(let a=0;a<t.length;a++)e[a]^=o.mul(t[a],i);let l=0;for(;l<e.length&&e[l]===0;)l++;e=e.slice(l)}return e},r.generateECPolynomial=function(n){let t=new Uint8Array([1]);for(let e=0;e<n;e++)t=r.mul(t,new Uint8Array([1,o.exp(e)]));return t}})(Et)),Et}var At,se;function Rn(){if(se)return At;se=1;const r=Sn();function o(s){this.genPoly=void 0,this.degree=s,this.degree&&this.initialize(this.degree)}return o.prototype.initialize=function(n){this.degree=n,this.genPoly=r.generateECPolynomial(this.degree)},o.prototype.encode=function(n){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(n.length+this.degree);t.set(n);const e=r.mod(t,this.genPoly),i=this.degree-e.length;if(i>0){const l=new Uint8Array(this.degree);return l.set(e,i),l}return e},At=o,At}var $t={},Pt={},kt={},ie;function qe(){return ie||(ie=1,kt.isValid=function(o){return!isNaN(o)&&o>=1&&o<=40}),kt}var K={},ae;function Ke(){if(ae)return K;ae=1;const r="[0-9]+",o="[A-Z $%*+\\-./:]+";let s="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";s=s.replace(/u/g,"\\u");const n="(?:(?![A-Z0-9 $%*+\\-./:]|"+s+`)(?:.|[\r
]))+`;K.KANJI=new RegExp(s,"g"),K.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),K.BYTE=new RegExp(n,"g"),K.NUMERIC=new RegExp(r,"g"),K.ALPHANUMERIC=new RegExp(o,"g");const t=new RegExp("^"+s+"$"),e=new RegExp("^"+r+"$"),i=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return K.testKanji=function(a){return t.test(a)},K.testNumeric=function(a){return e.test(a)},K.testAlphanumeric=function(a){return i.test(a)},K}var le;function Q(){return le||(le=1,(function(r){const o=qe(),s=Ke();r.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},r.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},r.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},r.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},r.MIXED={bit:-1},r.getCharCountIndicator=function(e,i){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!o.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?e.ccBits[0]:i<27?e.ccBits[1]:e.ccBits[2]},r.getBestModeForData=function(e){return s.testNumeric(e)?r.NUMERIC:s.testAlphanumeric(e)?r.ALPHANUMERIC:s.testKanji(e)?r.KANJI:r.BYTE},r.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},r.isValid=function(e){return e&&e.bit&&e.ccBits};function n(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return r.NUMERIC;case"alphanumeric":return r.ALPHANUMERIC;case"kanji":return r.KANJI;case"byte":return r.BYTE;default:throw new Error("Unknown mode: "+t)}}r.from=function(e,i){if(r.isValid(e))return e;try{return n(e)}catch{return i}}})(Pt)),Pt}var ue;function In(){return ue||(ue=1,(function(r){const o=G(),s=Fe(),n=Ht(),t=Q(),e=qe(),i=7973,l=o.getBCHDigit(i);function a(y,h,v){for(let P=1;P<=40;P++)if(h<=r.getCapacity(P,v,y))return P}function u(y,h){return t.getCharCountIndicator(y,h)+4}function f(y,h){let v=0;return y.forEach(function(P){const N=u(P.mode,h);v+=N+P.getBitsLength()}),v}function c(y,h){for(let v=1;v<=40;v++)if(f(y,v)<=r.getCapacity(v,h,t.MIXED))return v}r.from=function(h,v){return e.isValid(h)?parseInt(h,10):v},r.getCapacity=function(h,v,P){if(!e.isValid(h))throw new Error("Invalid QR Code version");typeof P>"u"&&(P=t.BYTE);const N=o.getSymbolTotalCodewords(h),w=s.getTotalCodewordsCount(h,v),k=(N-w)*8;if(P===t.MIXED)return k;const g=k-u(P,h);switch(P){case t.NUMERIC:return Math.floor(g/10*3);case t.ALPHANUMERIC:return Math.floor(g/11*2);case t.KANJI:return Math.floor(g/13);case t.BYTE:default:return Math.floor(g/8)}},r.getBestVersionForData=function(h,v){let P;const N=n.from(v,n.M);if(Array.isArray(h)){if(h.length>1)return c(h,N);if(h.length===0)return 1;P=h[0]}else P=h;return a(P.mode,P.getLength(),N)},r.getEncodedBits=function(h){if(!e.isValid(h)||h<7)throw new Error("Invalid QR Code version");let v=h<<12;for(;o.getBCHDigit(v)-l>=0;)v^=i<<o.getBCHDigit(v)-l;return h<<12|v}})($t)),$t}var Bt={},ce;function Mn(){if(ce)return Bt;ce=1;const r=G(),o=1335,s=21522,n=r.getBCHDigit(o);return Bt.getEncodedBits=function(e,i){const l=e.bit<<3|i;let a=l<<10;for(;r.getBCHDigit(a)-n>=0;)a^=o<<r.getBCHDigit(a)-n;return(l<<10|a)^s},Bt}var St={},Rt,de;function Tn(){if(de)return Rt;de=1;const r=Q();function o(s){this.mode=r.NUMERIC,this.data=s.toString()}return o.getBitsLength=function(n){return 10*Math.floor(n/3)+(n%3?n%3*3+1:0)},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(n){let t,e,i;for(t=0;t+3<=this.data.length;t+=3)e=this.data.substr(t,3),i=parseInt(e,10),n.put(i,10);const l=this.data.length-t;l>0&&(e=this.data.substr(t),i=parseInt(e,10),n.put(i,l*3+1))},Rt=o,Rt}var It,fe;function Nn(){if(fe)return It;fe=1;const r=Q(),o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function s(n){this.mode=r.ALPHANUMERIC,this.data=n}return s.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(t){let e;for(e=0;e+2<=this.data.length;e+=2){let i=o.indexOf(this.data[e])*45;i+=o.indexOf(this.data[e+1]),t.put(i,11)}this.data.length%2&&t.put(o.indexOf(this.data[e]),6)},It=s,It}var Mt,he;function Dn(){if(he)return Mt;he=1;const r=Q();function o(s){this.mode=r.BYTE,typeof s=="string"?this.data=new TextEncoder().encode(s):this.data=new Uint8Array(s)}return o.getBitsLength=function(n){return n*8},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(s){for(let n=0,t=this.data.length;n<t;n++)s.put(this.data[n],8)},Mt=o,Mt}var Tt,ge;function Ln(){if(ge)return Tt;ge=1;const r=Q(),o=G();function s(n){this.mode=r.KANJI,this.data=n}return s.getBitsLength=function(t){return t*13},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(n){let t;for(t=0;t<this.data.length;t++){let e=o.toSJIS(this.data[t]);if(e>=33088&&e<=40956)e-=33088;else if(e>=57408&&e<=60351)e-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);e=(e>>>8&255)*192+(e&255),n.put(e,13)}},Tt=s,Tt}var Nt={exports:{}},me;function Un(){return me||(me=1,(function(r){var o={single_source_shortest_paths:function(s,n,t){var e={},i={};i[n]=0;var l=o.PriorityQueue.make();l.push(n,0);for(var a,u,f,c,y,h,v,P,N;!l.empty();){a=l.pop(),u=a.value,c=a.cost,y=s[u]||{};for(f in y)y.hasOwnProperty(f)&&(h=y[f],v=c+h,P=i[f],N=typeof i[f]>"u",(N||P>v)&&(i[f]=v,l.push(f,v),e[f]=u))}if(typeof t<"u"&&typeof i[t]>"u"){var w=["Could not find a path from ",n," to ",t,"."].join("");throw new Error(w)}return e},extract_shortest_path_from_predecessor_list:function(s,n){for(var t=[],e=n;e;)t.push(e),s[e],e=s[e];return t.reverse(),t},find_path:function(s,n,t){var e=o.single_source_shortest_paths(s,n,t);return o.extract_shortest_path_from_predecessor_list(e,t)},PriorityQueue:{make:function(s){var n=o.PriorityQueue,t={},e;s=s||{};for(e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t.queue=[],t.sorter=s.sorter||n.default_sorter,t},default_sorter:function(s,n){return s.cost-n.cost},push:function(s,n){var t={value:s,cost:n};this.queue.push(t),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};r.exports=o})(Nt)),Nt.exports}var pe;function Fn(){return pe||(pe=1,(function(r){const o=Q(),s=Tn(),n=Nn(),t=Dn(),e=Ln(),i=Ke(),l=G(),a=Un();function u(w){return unescape(encodeURIComponent(w)).length}function f(w,k,g){const d=[];let I;for(;(I=w.exec(g))!==null;)d.push({data:I[0],index:I.index,mode:k,length:I[0].length});return d}function c(w){const k=f(i.NUMERIC,o.NUMERIC,w),g=f(i.ALPHANUMERIC,o.ALPHANUMERIC,w);let d,I;return l.isKanjiModeEnabled()?(d=f(i.BYTE,o.BYTE,w),I=f(i.KANJI,o.KANJI,w)):(d=f(i.BYTE_KANJI,o.BYTE,w),I=[]),k.concat(g,d,I).sort(function(C,E){return C.index-E.index}).map(function(C){return{data:C.data,mode:C.mode,length:C.length}})}function y(w,k){switch(k){case o.NUMERIC:return s.getBitsLength(w);case o.ALPHANUMERIC:return n.getBitsLength(w);case o.KANJI:return e.getBitsLength(w);case o.BYTE:return t.getBitsLength(w)}}function h(w){return w.reduce(function(k,g){const d=k.length-1>=0?k[k.length-1]:null;return d&&d.mode===g.mode?(k[k.length-1].data+=g.data,k):(k.push(g),k)},[])}function v(w){const k=[];for(let g=0;g<w.length;g++){const d=w[g];switch(d.mode){case o.NUMERIC:k.push([d,{data:d.data,mode:o.ALPHANUMERIC,length:d.length},{data:d.data,mode:o.BYTE,length:d.length}]);break;case o.ALPHANUMERIC:k.push([d,{data:d.data,mode:o.BYTE,length:d.length}]);break;case o.KANJI:k.push([d,{data:d.data,mode:o.BYTE,length:u(d.data)}]);break;case o.BYTE:k.push([{data:d.data,mode:o.BYTE,length:u(d.data)}])}}return k}function P(w,k){const g={},d={start:{}};let I=["start"];for(let m=0;m<w.length;m++){const C=w[m],E=[];for(let b=0;b<C.length;b++){const S=C[b],A=""+m+b;E.push(A),g[A]={node:S,lastCount:0},d[A]={};for(let B=0;B<I.length;B++){const $=I[B];g[$]&&g[$].node.mode===S.mode?(d[$][A]=y(g[$].lastCount+S.length,S.mode)-y(g[$].lastCount,S.mode),g[$].lastCount+=S.length):(g[$]&&(g[$].lastCount=S.length),d[$][A]=y(S.length,S.mode)+4+o.getCharCountIndicator(S.mode,k))}}I=E}for(let m=0;m<I.length;m++)d[I[m]].end=0;return{map:d,table:g}}function N(w,k){let g;const d=o.getBestModeForData(w);if(g=o.from(k,d),g!==o.BYTE&&g.bit<d.bit)throw new Error('"'+w+'" cannot be encoded with mode '+o.toString(g)+`.
 Suggested mode is: `+o.toString(d));switch(g===o.KANJI&&!l.isKanjiModeEnabled()&&(g=o.BYTE),g){case o.NUMERIC:return new s(w);case o.ALPHANUMERIC:return new n(w);case o.KANJI:return new e(w);case o.BYTE:return new t(w)}}r.fromArray=function(k){return k.reduce(function(g,d){return typeof d=="string"?g.push(N(d,null)):d.data&&g.push(N(d.data,d.mode)),g},[])},r.fromString=function(k,g){const d=c(k,l.isKanjiModeEnabled()),I=v(d),m=P(I,g),C=a.find_path(m.map,"start","end"),E=[];for(let b=1;b<C.length-1;b++)E.push(m.table[C[b]].node);return r.fromArray(h(E))},r.rawSplit=function(k){return r.fromArray(c(k,l.isKanjiModeEnabled()))}})(St)),St}var ye;function qn(){if(ye)return pt;ye=1;const r=G(),o=Ht(),s=En(),n=An(),t=$n(),e=Pn(),i=kn(),l=Fe(),a=Rn(),u=In(),f=Mn(),c=Q(),y=Fn();function h(m,C){const E=m.size,b=e.getPositions(C);for(let S=0;S<b.length;S++){const A=b[S][0],B=b[S][1];for(let $=-1;$<=7;$++)if(!(A+$<=-1||E<=A+$))for(let M=-1;M<=7;M++)B+M<=-1||E<=B+M||($>=0&&$<=6&&(M===0||M===6)||M>=0&&M<=6&&($===0||$===6)||$>=2&&$<=4&&M>=2&&M<=4?m.set(A+$,B+M,!0,!0):m.set(A+$,B+M,!1,!0))}}function v(m){const C=m.size;for(let E=8;E<C-8;E++){const b=E%2===0;m.set(E,6,b,!0),m.set(6,E,b,!0)}}function P(m,C){const E=t.getPositions(C);for(let b=0;b<E.length;b++){const S=E[b][0],A=E[b][1];for(let B=-2;B<=2;B++)for(let $=-2;$<=2;$++)B===-2||B===2||$===-2||$===2||B===0&&$===0?m.set(S+B,A+$,!0,!0):m.set(S+B,A+$,!1,!0)}}function N(m,C){const E=m.size,b=u.getEncodedBits(C);let S,A,B;for(let $=0;$<18;$++)S=Math.floor($/3),A=$%3+E-8-3,B=(b>>$&1)===1,m.set(S,A,B,!0),m.set(A,S,B,!0)}function w(m,C,E){const b=m.size,S=f.getEncodedBits(C,E);let A,B;for(A=0;A<15;A++)B=(S>>A&1)===1,A<6?m.set(A,8,B,!0):A<8?m.set(A+1,8,B,!0):m.set(b-15+A,8,B,!0),A<8?m.set(8,b-A-1,B,!0):A<9?m.set(8,15-A-1+1,B,!0):m.set(8,15-A-1,B,!0);m.set(b-8,8,1,!0)}function k(m,C){const E=m.size;let b=-1,S=E-1,A=7,B=0;for(let $=E-1;$>0;$-=2)for($===6&&$--;;){for(let M=0;M<2;M++)if(!m.isReserved(S,$-M)){let O=!1;B<C.length&&(O=(C[B]>>>A&1)===1),m.set(S,$-M,O),A--,A===-1&&(B++,A=7)}if(S+=b,S<0||E<=S){S-=b,b=-b;break}}}function g(m,C,E){const b=new s;E.forEach(function(M){b.put(M.mode.bit,4),b.put(M.getLength(),c.getCharCountIndicator(M.mode,m)),M.write(b)});const S=r.getSymbolTotalCodewords(m),A=l.getTotalCodewordsCount(m,C),B=(S-A)*8;for(b.getLengthInBits()+4<=B&&b.put(0,4);b.getLengthInBits()%8!==0;)b.putBit(0);const $=(B-b.getLengthInBits())/8;for(let M=0;M<$;M++)b.put(M%2?17:236,8);return d(b,m,C)}function d(m,C,E){const b=r.getSymbolTotalCodewords(C),S=l.getTotalCodewordsCount(C,E),A=b-S,B=l.getBlocksCount(C,E),$=b%B,M=B-$,O=Math.floor(b/B),ot=Math.floor(A/B),xe=ot+1,Ot=O-ot,ze=new a(Ot);let dt=0;const at=new Array(B),Jt=new Array(B);let ft=0;const He=new Uint8Array(m.buffer);for(let W=0;W<B;W++){const gt=W<M?ot:xe;at[W]=He.slice(dt,dt+gt),Jt[W]=ze.encode(at[W]),dt+=gt,ft=Math.max(ft,gt)}const ht=new Uint8Array(b);let Yt=0,V,x;for(V=0;V<ft;V++)for(x=0;x<B;x++)V<at[x].length&&(ht[Yt++]=at[x][V]);for(V=0;V<Ot;V++)for(x=0;x<B;x++)ht[Yt++]=Jt[x][V];return ht}function I(m,C,E,b){let S;if(Array.isArray(m))S=y.fromArray(m);else if(typeof m=="string"){let O=C;if(!O){const ot=y.rawSplit(m);O=u.getBestVersionForData(ot,E)}S=y.fromString(m,O||40)}else throw new Error("Invalid data");const A=u.getBestVersionForData(S,E);if(!A)throw new Error("The amount of data is too big to be stored in a QR Code");if(!C)C=A;else if(C<A)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+A+`.
`);const B=g(C,E,S),$=r.getSymbolSize(C),M=new n($);return h(M,C),v(M),P(M,C),w(M,E,0),C>=7&&N(M,C),k(M,B),isNaN(b)&&(b=i.getBestMask(M,w.bind(null,M,E))),i.applyMask(b,M),w(M,E,b),{modules:M,version:C,errorCorrectionLevel:E,maskPattern:b,segments:S}}return pt.create=function(C,E){if(typeof C>"u"||C==="")throw new Error("No input text");let b=o.M,S,A;return typeof E<"u"&&(b=o.from(E.errorCorrectionLevel,o.M),S=u.from(E.version),A=i.from(E.maskPattern),E.toSJISFunc&&r.setToSJISFunction(E.toSJISFunc)),I(C,S,b,A)},pt}var Dt={},Lt={},we;function Ve(){return we||(we=1,(function(r){function o(s){if(typeof s=="number"&&(s=s.toString()),typeof s!="string")throw new Error("Color should be defined as hex string");let n=s.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+s);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(e){return[e,e]}))),n.length===6&&n.push("F","F");const t=parseInt(n.join(""),16);return{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:t&255,hex:"#"+n.slice(0,6).join("")}}r.getOptions=function(n){n||(n={}),n.color||(n.color={});const t=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,e=n.width&&n.width>=21?n.width:void 0,i=n.scale||4;return{width:e,scale:e?4:i,margin:t,color:{dark:o(n.color.dark||"#000000ff"),light:o(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},r.getScale=function(n,t){return t.width&&t.width>=n+t.margin*2?t.width/(n+t.margin*2):t.scale},r.getImageWidth=function(n,t){const e=r.getScale(n,t);return Math.floor((n+t.margin*2)*e)},r.qrToImageData=function(n,t,e){const i=t.modules.size,l=t.modules.data,a=r.getScale(i,e),u=Math.floor((i+e.margin*2)*a),f=e.margin*a,c=[e.color.light,e.color.dark];for(let y=0;y<u;y++)for(let h=0;h<u;h++){let v=(y*u+h)*4,P=e.color.light;if(y>=f&&h>=f&&y<u-f&&h<u-f){const N=Math.floor((y-f)/a),w=Math.floor((h-f)/a);P=c[l[N*i+w]?1:0]}n[v++]=P.r,n[v++]=P.g,n[v++]=P.b,n[v]=P.a}}})(Lt)),Lt}var _e;function Kn(){return _e||(_e=1,(function(r){const o=Ve();function s(t,e,i){t.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=i,e.width=i,e.style.height=i+"px",e.style.width=i+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}r.render=function(e,i,l){let a=l,u=i;typeof a>"u"&&(!i||!i.getContext)&&(a=i,i=void 0),i||(u=n()),a=o.getOptions(a);const f=o.getImageWidth(e.modules.size,a),c=u.getContext("2d"),y=c.createImageData(f,f);return o.qrToImageData(y.data,e,a),s(c,u,f),c.putImageData(y,0,0),u},r.renderToDataURL=function(e,i,l){let a=l;typeof a>"u"&&(!i||!i.getContext)&&(a=i,i=void 0),a||(a={});const u=r.render(e,i,a),f=a.type||"image/png",c=a.rendererOpts||{};return u.toDataURL(f,c.quality)}})(Dt)),Dt}var Ut={},be;function Vn(){if(be)return Ut;be=1;const r=Ve();function o(t,e){const i=t.a/255,l=e+'="'+t.hex+'"';return i<1?l+" "+e+'-opacity="'+i.toFixed(2).slice(1)+'"':l}function s(t,e,i){let l=t+e;return typeof i<"u"&&(l+=" "+i),l}function n(t,e,i){let l="",a=0,u=!1,f=0;for(let c=0;c<t.length;c++){const y=Math.floor(c%e),h=Math.floor(c/e);!y&&!u&&(u=!0),t[c]?(f++,c>0&&y>0&&t[c-1]||(l+=u?s("M",y+i,.5+h+i):s("m",a,0),a=0,u=!1),y+1<e&&t[c+1]||(l+=s("h",f),f=0)):a++}return l}return Ut.render=function(e,i,l){const a=r.getOptions(i),u=e.modules.size,f=e.modules.data,c=u+a.margin*2,y=a.color.light.a?"<path "+o(a.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",h="<path "+o(a.color.dark,"stroke")+' d="'+n(f,u,a.margin)+'"/>',v='viewBox="0 0 '+c+" "+c+'"',N='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+v+' shape-rendering="crispEdges">'+y+h+`</svg>
`;return typeof l=="function"&&l(null,N),N},Ut}var ve;function xn(){if(ve)return X;ve=1;const r=Cn(),o=qn(),s=Kn(),n=Vn();function t(e,i,l,a,u){const f=[].slice.call(arguments,1),c=f.length,y=typeof f[c-1]=="function";if(!y&&!r())throw new Error("Callback required as last argument");if(y){if(c<2)throw new Error("Too few arguments provided");c===2?(u=l,l=i,i=a=void 0):c===3&&(i.getContext&&typeof u>"u"?(u=a,a=void 0):(u=a,a=l,l=i,i=void 0))}else{if(c<1)throw new Error("Too few arguments provided");return c===1?(l=i,i=a=void 0):c===2&&!i.getContext&&(a=l,l=i,i=void 0),new Promise(function(h,v){try{const P=o.create(l,a);h(e(P,i,a))}catch(P){v(P)}})}try{const h=o.create(l,a);u(null,e(h,i,a))}catch(h){u(h)}}return X.create=o.create,X.toCanvas=t.bind(null,s.render),X.toDataURL=t.bind(null,s.renderToDataURL),X.toString=t.bind(null,function(e,i,l){return n.render(e,l)}),X}var zn=xn();const Hn=q({__name:"QrCode",props:{uri:{}},setup(r){const o=r,s=F("$canvas");return sn(()=>{zn.toCanvas(s.value,o.uri,n=>{n&&console.error(n)})}),(n,t)=>(D(),U("canvas",{ref_key:"$canvas",ref:s},null,512))}}),On={class:"row"},Jn={class:"col-md-7"},Yn={class:"mt-2"},jn={class:"card-text"},Gn={class:"mt-0"},Qn={class:"card-text"},Wn={class:"col-md-5"},Xn={key:0},Zn={id:"totp_uri",class:"d-inline-block text-truncate mt-2",style:{width:"100%"}},to=q({__name:"TwoFactorModal",props:{twoFactorUrl:{}},emits:["relist"],setup(r,{expose:o,emit:s}){const n=r,t=s,e=H(!0),i=H(null),{r$:l}=st({otp:""},{otp:{required:z,minLength:We(6)}},{}),{record:a,reset:u}=hn({secret:null,totp_uri:null,qr_code:null}),f=()=>{u(),l.$reset({toOriginalState:!0}),e.value=!1,i.value=null},c=F("$modal"),{hide:y,show:h}=ct(c),{notifySuccess:v}=Ee(),{axios:P}=et(),N=async()=>{f(),e.value=!0,h();try{const{data:g}=await P.put(n.twoFactorUrl);a.value=g,e.value=!1}catch{y()}},w=()=>{N()},k=async()=>{const{valid:g,data:d}=await l.$validate();if(g){i.value=null;try{await P({method:"PUT",url:n.twoFactorUrl,data:{secret:a.value.secret,otp:d.otp}}),v(),t("relist"),y()}catch(I){i.value=ut(I)}}};return o({open:w}),(g,d)=>(D(),j(Vt,{ref_key:"$modal",ref:c,loading:e.value,title:g.$gettext("Enable Two-Factor Authentication"),error:i.value,"disable-save-button":p(l).$invalid,"no-enforce-focus":"",onSubmit:k,onHidden:f},{"save-button-name":L(()=>[nt(R(g.$gettext("Submit Code")),1)]),default:L(()=>[_("div",On,[_("div",Jn,[_("h5",Yn,R(g.$gettext("Step 1: Scan QR Code")),1),_("p",jn,R(g.$gettext("From your smartphone, scan the code to the right using an authentication app of your choice (FreeOTP, Authy, etc).")),1),_("h5",Gn,R(g.$gettext("Step 2: Verify Generated Code")),1),_("p",Qn,R(g.$gettext("To verify that the code was set up correctly, enter the 6-digit code the app shows you.")),1),T(fn,null,{default:L(()=>[T(Y,{id:"form_otp",field:p(l).otp,autofocus:"",label:g.$gettext("Code from Authenticator App"),description:g.$gettext("Enter the current code provided by your authenticator app to verify that it's working correctly.")},null,8,["field","label","description"])]),_:1})]),_("div",Wn,[p(a).totp_uri?(D(),U("div",Xn,[T(Hn,{uri:p(a).totp_uri},null,8,["uri"]),_("code",Zn,R(p(a).totp_uri),1),T(Ne,{text:p(a).totp_uri},null,8,["text"])])):xt("",!0)])])]),_:1},8,["loading","title","error","disable-save-button"]))}}),eo=q({__name:"ChangePasswordModal",emits:["relist"],setup(r,{expose:o,emit:s}){const n=s,t=tt("/frontend/account/password"),{$gettext:e}=it(),{r$:i}=st({current_password:"",new_password:"",new_password2:""},{current_password:{required:z},new_password:{required:z,isValidPassword:Ze},new_password2:{required:z,passwordsMatch:Xe((h,v)=>v.new_password===h,e("Must match new password."))}},{}),l=H(null),a=()=>{i.$reset({toOriginalState:!0}),l.value=null},u=F("$modal"),f=()=>{a(),u.value?.show()},{axios:c}=et(),y=async()=>{const{valid:h,data:v}=await i.$validate();if(h)try{await c.put(t.value,v)}finally{u.value?.hide(),n("relist")}};return o({open:f}),(h,v)=>(D(),j(Vt,{ref_key:"$modal",ref:u,size:"md",centered:"",title:p(e)("Change Password"),"disable-save-button":p(i).$invalid,onSubmit:y,onHidden:a},{"save-button-name":L(()=>[nt(R(p(e)("Change Password")),1)]),default:L(()=>[T(Y,{id:"form_current_password",field:p(i).current_password,"input-type":"password",autofocus:"",label:p(e)("Current Password"),"input-attrs":{autocomplete:"current-password"},class:"mb-3"},null,8,["field","label"]),T(Y,{id:"form_new_password",field:p(i).new_password,"input-type":"password",label:p(e)("New Password"),"input-attrs":{autocomplete:"new-password"},class:"mb-3"},null,8,["field","label"]),T(Y,{id:"form_confirm_new_password",field:p(i).new_password2,"input-type":"password","input-attrs":{autocomplete:"new-password"},label:p(e)("Confirm New Password")},null,8,["field","label"])]),_:1},8,["title","disable-save-button"]))}}),no={class:"card-text"},oo={key:0,class:"card-text"},ro={key:1,class:"buttons"},so={key:1},io={class:"card-text"},ao=q({__name:"PasskeyModal",emits:["relist"],setup(r,{expose:o,emit:s}){const n=s,t=tt("/frontend/account/webauthn/register"),e=H(null),i=H({name:"",createResponse:null}),{r$:l}=st(i,{name:{required:z},createResponse:{required:z}},{}),a=()=>{l.$reset({toOriginalState:!0}),e.value=null},u=F("$modal"),{show:f,hide:c}=ct(u),y=()=>{a(),f()},{isSupported:h,doRegister:v,cancel:P}=mn(),N=()=>{a(),P(),n("relist")},{axios:w}=et(),k=async()=>{const{data:d}=await w.get(t.value);try{const I=await v(d);l.$value.createResponse=JSON.stringify(I)}catch(I){throw tn(I)&&"name"in I&&I.name==="InvalidStateError"?e.value="Error: Authenticator was probably already registered by user":e.value=String(I),I}},g=async()=>{const{valid:d,data:I}=await l.$validate();if(d){e.value=null;try{const m={name:I.name,createResponse:JSON.parse(I.createResponse)};await w({method:"PUT",url:t.value,data:m}),c()}catch(m){e.value=ut(m)}}};return o({create:y}),(d,I)=>(D(),j(Ae,{id:"api_keys_modal",ref_key:"$modal",ref:u,size:"md",centered:"",title:d.$gettext("Add New Passkey"),"no-enforce-focus":"",onHidden:N},{default:L(()=>[Re(_("div",{class:"alert alert-danger"},R(e.value),513),[[Ie,e.value!=null]]),p(h)?(D(),U("form",{key:0,class:"form vue-form",onSubmit:Me(g,["prevent"])},[T(Y,{id:"form_name",field:p(l).name,autofocus:"",class:"mb-3",label:d.$gettext("Passkey Nickname")},null,8,["field","label"]),T(gn,{id:"form_select_passkey"},{label:L(()=>[nt(R(d.$gettext("Select Passkey")),1)]),default:L(()=>[_("p",no,R(d.$gettext("Click the button below to open your browser window to select a passkey.")),1),i.value.createResponse?(D(),U("p",oo,R(d.$gettext("A passkey has been selected. Submit this form to add it to your account.")),1)):(D(),U("div",ro,[_("button",{type:"button",class:"btn btn-primary",onClick:k},R(d.$gettext("Select Passkey")),1)]))]),_:1}),T(Le)],32)):(D(),U("div",so,[_("p",io,R(d.$gettext("Your browser does not support passkeys. Consider updating your browser to the latest version.")),1)]))]),"modal-footer":L(m=>[Pe(d.$slots,"modal-footer",Be(Se(m)),()=>[_("button",{type:"button",class:"btn btn-secondary",onClick:I[0]||(I[0]=(...C)=>p(c)&&p(c)(...C))},R(d.$gettext("Close")),1),_("button",{type:"submit",class:ke(["btn",p(l).$invalid?"btn-danger":"btn-primary"]),onClick:g},R(d.$gettext("Add New Passkey")),3)])]),_:3},8,["title"]))}}),lo={class:"d-flex align-items-center"},uo={class:"flex-fill"},co=["id"],fo={class:"flex-shrink-0"},ho={key:0,class:"card-body"},go={class:"card-text mt-2"},mo={class:"buttons"},po={class:"card-body"},yo={class:"card-text mt-2"},wo={class:"buttons"},_o={class:"btn-group btn-group-sm"},bo=["onClick"],vo=q({__name:"SecurityPanel",setup(r){const{axios:o}=et(),s=tt("/frontend/account/two-factor"),{data:n,isLoading:t,refetch:e}=nn({queryKey:[Ft.AccountIndex,"two-factor"],queryFn:async({signal:I})=>{const{data:m}=await o.get(s.value,{signal:I});return m},placeholderData:()=>({two_factor_enabled:!1})}),i=()=>{e()},l=F("$changePasswordModal"),a=()=>{l.value?.open()},u=F("$twoFactorModal"),f=()=>{u.value?.open()},{$gettext:c}=it(),{doDelete:y}=Kt(c("Disable two-factor authentication?"),()=>{i()}),h=()=>y(s.value),v=tt("/frontend/account/passkeys"),P=[{key:"name",isRowHeader:!0,label:c("Passkey Nickname"),sortable:!1},{key:"actions",label:c("Actions"),sortable:!1,class:"shrink"}],N=Ue(v,[Ft.AccountPasskeys]),w=()=>{N.refresh()},{doDelete:k}=Kt(c("Delete Passkey?"),()=>w()),g=F("$passkeyModal"),d=()=>{g.value?.create()};return(I,m)=>(D(),U(zt,null,[T(Te,{"header-id":"hdr_security"},{header:L(({id:C})=>[_("div",lo,[_("div",uo,[_("h3",{id:C,class:"card-title"},R(p(c)("Security")),9,co)]),_("div",fo,[_("button",{type:"button",class:"btn btn-dark",onClick:a},[T(Z,{icon:p(Ye)},null,8,["icon"]),_("span",null,R(p(c)("Change Password")),1)])])])]),default:L(()=>[T(dn,{loading:p(t)},{default:L(()=>[p(n)?(D(),U("div",ho,[_("h5",null,[nt(R(p(c)("Two-Factor Authentication"))+" ",1),T(cn,{enabled:p(n).two_factor_enabled},null,8,["enabled"])]),_("p",go,R(p(c)("Two-factor authentication improves the security of your account by requiring a second one-time access code in addition to your password when you log in.")),1),_("div",mo,[p(n).two_factor_enabled?(D(),U("button",{key:0,type:"button",class:"btn btn-danger",onClick:h},[T(Z,{icon:p(Oe)},null,8,["icon"]),_("span",null,R(p(c)("Disable Two-Factor")),1)])):(D(),U("button",{key:1,type:"button",class:"btn btn-success",onClick:f},[T(Z,{icon:p(Je)},null,8,["icon"]),_("span",null,R(p(c)("Enable Two-Factor")),1)]))])])):xt("",!0)]),_:1},8,["loading"]),_("div",po,[_("h5",null,R(p(c)("Passkey Authentication")),1),_("p",yo,R(p(c)("Using a passkey (like Windows Hello, YubiKey, or your smartphone) allows you to securely log in without needing to enter your password or two-factor code.")),1),_("div",wo,[_("button",{type:"button",class:"btn btn-primary",onClick:d},[T(Z,{icon:p(Ce)},null,8,["icon"]),_("span",null,R(p(c)("Add New Passkey")),1)])])]),T(De,{id:"account_passkeys","show-toolbar":!1,fields:P,provider:p(N)},{"cell(actions)":L(C=>[_("div",_o,[_("button",{type:"button",class:"btn btn-danger",onClick:E=>p(k)(C.item.links.self)},R(p(c)("Delete")),9,bo)])]),_:1},8,["provider"])]),_:1}),T(eo,{ref_key:"$changePasswordModal",ref:l},null,512),T(to,{ref_key:"$twoFactorModal",ref:u,"two-factor-url":p(s),onRelist:m[0]||(m[0]=()=>i())},null,8,["two-factor-url"]),T(ao,{ref_key:"$passkeyModal",ref:g,onRelist:m[1]||(m[1]=()=>w())},null,512)],64))}}),Co={class:"card-subtitle"},Eo={class:"card-text"},Ao={class:"card-text"},$o={class:"px-2"},Po={id:"api_key"},ko={class:"buttons pt-2"},Bo={class:"card-text pt-3"},So={class:"card-text"},Ro=q({__name:"ApiKeyNewKey",props:{newKey:{}},setup(r){return(o,s)=>(D(),U(zt,null,[_("h3",Co,R(o.$gettext("New Key Generated")),1),_("p",Eo,[_("b",null,R(o.$gettext("Important: copy the key below before continuing!")),1),nt(" "+R(o.$gettext("You will not be able to retrieve it again.")),1)]),_("p",Ao,R(o.$gettext("Your full API key is below:")),1),_("div",$o,[_("code",Po,R(o.newKey),1),_("div",ko,[T(Ne,{text:o.newKey},null,8,["text"])])]),_("p",Bo,R(o.$gettext('When making API calls, you can pass this value in the "X-API-Key" header to authenticate as yourself.')),1),_("p",So,R(o.$gettext("You can only perform the actions your user account is allowed to perform.")),1)],64))}}),Io={key:1},Mo=q({__name:"ApiKeyModal",props:{createUrl:{}},emits:["relist"],setup(r,{expose:o,emit:s}){const n=r,t=s,e=H(null),i=H(null),{r$:l}=st({comment:""},{comment:{required:z}},{}),a=()=>{l.$reset({toOriginalState:!0}),e.value=null,i.value=null},u=F("$modal"),{show:f,hide:c}=ct(u),y=()=>{a(),f()},h=F("$field"),v=()=>{an(()=>{h.value?.focus()})},{axios:P}=et(),N=async()=>{const{valid:w,data:k}=await l.$validate();if(w){e.value=null;try{const{data:g}=await P.post(n.createUrl,k);i.value=g.key}catch(g){e.value=ut(g)}t("relist")}};return o({create:y}),(w,k)=>(D(),j(Ae,{id:"api_keys_modal",ref_key:"$modal",ref:u,size:"md",centered:"",title:w.$gettext("Add API Key"),"no-enforce-focus":"",onShown:v,onHidden:a},{default:L(()=>[Re(_("div",{class:"alert alert-danger"},R(e.value),513),[[Ie,e.value!=null]]),i.value===null?(D(),U("form",{key:0,class:"form vue-form",onSubmit:Me(N,["prevent"])},[T(Y,{id:"form_comments",ref_key:"$field",ref:h,field:p(l).comment,autofocus:"",label:w.$gettext("API Key Description/Comments")},null,8,["field","label"]),T(Le)],32)):(D(),U("div",Io,[T(Ro,{"new-key":i.value},null,8,["new-key"])]))]),"modal-footer":L(g=>[Pe(w.$slots,"modal-footer",Be(Se(g)),()=>[_("button",{type:"button",class:"btn btn-secondary",onClick:k[0]||(k[0]=(...d)=>p(c)&&p(c)(...d))},R(w.$gettext("Close")),1),i.value===null?(D(),U("button",{key:0,type:"submit",class:ke(["btn",p(l).$invalid?"btn-danger":"btn-primary"]),onClick:N},R(w.$gettext("Create New Key")),3)):xt("",!0)])]),_:3},8,["title"]))}}),To={href:"/api",class:"alert-link",target:"_blank"},No={class:"btn-group btn-group-sm"},Do=["onClick"],Lo=q({__name:"ApiKeysPanel",setup(r){const o=tt("/frontend/account/api-keys"),{$gettext:s}=it(),n=[{key:"comment",isRowHeader:!0,label:s("API Key Description/Comments"),sortable:!1},{key:"actions",label:s("Actions"),sortable:!1,class:"shrink"}],t=Ue(o,[Ft.AdminApiKeys]),e=()=>{t.refresh()},i=F("$apiKeyModal"),l=()=>{i.value?.create()},{doDelete:a}=Kt(s("Delete API Key?"),()=>e());return(u,f)=>(D(),U(zt,null,[T(Te,{"header-id":"hdr_api_keys",title:p(s)("API Keys")},{info:L(()=>[nt(R(p(s)("Use API keys to authenticate with the AzuraCast API using the same permissions as your user account."))+" ",1),_("a",To,R(p(s)("API Documentation")),1)]),actions:L(()=>[_("button",{type:"button",class:"btn btn-primary",onClick:l},[T(Z,{icon:p(Ce)},null,8,["icon"]),_("span",null,R(p(s)("Add API Key")),1)])]),default:L(()=>[T(De,{id:"account_api_keys","show-toolbar":!1,fields:n,provider:p(t)},{"cell(actions)":L(({item:c})=>[_("div",No,[_("button",{type:"button",class:"btn btn-danger",onClick:y=>p(a)(c.links.self)},R(p(s)("Delete")),9,Do)])]),_:1},8,["provider"])]),_:1},8,["title"]),T(Mo,{ref_key:"$apiKeyModal",ref:i,"create-url":p(o),onRelist:f[0]||(f[0]=()=>e())},null,8,["create-url"])],64))}}),Uo={class:"outside-card-header mb-1"},Fo=["aria-label"],qo={class:"row row-of-cards"},Ko={class:"col-sm-12 col-md-6"},Vo={class:"col-sm-12 col-md-6"},Mr=q({__name:"Account",setup(r){const{supportedLocales:o}=en(),s=F("$editModal"),n=()=>{s.value?.open()},t=()=>{location.reload()};return(e,i)=>(D(),j(pn,null,{default:L(()=>[_("h2",Uo,R(e.$gettext("My Account")),1),_("section",{class:"card mb-4",role:"region","aria-label":e.$gettext("Account Details")},[T(un,null,{default:L(()=>[_("button",{type:"button",class:"btn btn-dark",onClick:n},[T(Z,{icon:p(je)},null,8,["icon"]),_("span",null,R(e.$gettext("Edit Profile")),1)])]),_:1})],8,Fo),_("div",qo,[_("div",Ko,[T(vo)]),_("div",Vo,[T(Lo)])]),T(vn,{ref_key:"$editModal",ref:s,"supported-locales":p(o),onReload:t},null,8,["supported-locales"])]),_:1}))}});export{Mr as default};
